<!DOCTYPE html>
<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="en"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="en"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Mission to Mars</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
<meta name="description" content="" />
<meta name="keywords" content="Mars" />
<meta name="author" content="MX" />
<LINK REL="SHORTCUT ICON" HREF="../images/mars.ico"> 
<link rel="stylesheet" type="text/css" href="../css/mars.css" />
<link href="../css/custom-theme/jquery-ui-1.10.2.custom.css" rel="stylesheet">
<link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700,900,100italic,300italic,400italic,700italic,900italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Quicksand:400,700' rel='stylesheet' type='text/css'>

<script type="text/javascript" src="../js/popcorn-complete.js"></script>	
<script type="text/javascript" src="../js/libs/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="../js/libs/jquery-ui-1.10.1.custom.min.js"></script>

<script type="text/javascript" src="../js/libs/three.min.js"></script>

		<script src="../js/libs/Detector.js"></script>
		<script src="../js/libs/stats.min.js"></script>
		<script src="../js/libs/tween.min.js"></script>
		<script src="../js/libs/dat.gui.min.js"></script>
		<script src="../js/libs/underscore.min.js"></script>

		<script src="../js/controls/OrbitControls.js"></script>	
		<script src="../js/loaders/ColladaLoader.js"></script>

        <script src="../js/jat/Constants.js"></script>
        <script src="../js/jat/PathUtil.js"></script>
        <script src="../js/jat/DE405APL.js"></script>
        <script src="../js/jat/DE405Body.js"></script>
        <script src="../js/jat/DE405Plus.js"></script>
        <script src="../js/jat/Lambert.js"></script>
        <script src="../js/jat/LambertException.js"></script>
        <script src="../js/jat/Trajectory.js"></script>
        <script src="../js/jat/Matrix.js"></script>
        <script src="../js/jat/SolarSystemBodies.js"></script>
        <script src="../js/jat/Time.js"></script>
        <script src="../js/jat/TimeUtils.js"></script>
        <script src="../js/jat/TwoBody.js"></script>
        <script src="../js/jat/VectorN.js"></script>
        <script src="../js/jat/ZeroFinder.js"></script>

		<script src="../js/utils.js"></script>
		<script src="../js/ephemeris.js"></script>
		<script src="../js/daycount.js"></script>
		<script src="../js/ruler.js"></script>
		<script src="../js/shaderlist.js"></script>

		<script src="../js/label.js"></script>
		<script src="../js/addlensflare.js"></script>
		<script src="../js/planet.js"></script>
		<script src="../js/orbit.js"></script>
		<script src="../js/sun.js"></script>
		<script src="../js/solarsystem.js"></script>
		<script src="../js/camtweener.js"></script>
		<script src="../js/main.js"></script>
		<script src="../js/stars.js"></script>
		<script src="../js/jat/Time.js"></script>

		<script src="../js/sonic.js"></script>


<script type="text/javascript">
//need a value to maintain global user email to check for during session.
//the following variable and function provide separate backpack window to communicate user email value.
var userBackpackEmail;
function setUserBackpackEmail(emailValue) {
	userBackpackEmail = emailValue;
	console.log("user email set to: ",userBackpackEmail);
}

function solarsystembadgefinish() {
	$("#solarsystembadge").animate({opacity: 0.0}, 200, function() {
    	$("#solarsystembadge").css('pointer-events', 'none');
    });
	$("#solarsystembadgecomplete").animate({opacity: 1.0}, 200, function() {
    	$("#solarsystembadgecomplete").css('pointer-events', 'auto');
    });
}
function rocketbadgefinish() {
	$("#rocketbadge").animate({opacity: 0.0}, 200, function() {
    	$("#rocketbadge").css('pointer-events', 'none');
    });
	$("#rocketbadgecomplete").animate({opacity: 1.0}, 200, function() {
    	$("#rocketbadgecomplete").css('pointer-events', 'auto');
    });
}


var launchPlanetDistance = 0; // greater 140 is too far  
var monthDifference = 0; //6 mo - 13129200000 9 mo - 21078000000
var launchRewindDate; //date to start launch draw sequence, to see initial draw.
var launchDate;
var landingDate;

// ensure the web page (DOM) has loaded
document.addEventListener("DOMContentLoaded", function () {
	//we want to limit orbit animations to stay within our loaded ephemeris range 
	//(we're only loading two NASA ephemeris which gets us from about 2000 to 2040)
	var MAX_EPHEMERIS_DATE = new Date(2039, 10, 1); //backing off to Nov 1st
	var MIN_EPHEMERIS_DATE = new Date(2000, 0, 1); //scooting up to Jan 1st
	
//https://www.youtube.com/watch?v=P4boyXQuUIw - the MSL path
//http://www.youtube.com/watch?v=jEXoMpmfJcM - the MSL launch - a better version
//https://www.youtube.com/watch?v=lKqr3F73bAI - MSL trajectory
			
//blue - 51,111,139 #336f8b
//bluebg - 13,30,38 #0d1e26 70%
//menu/next green - 135,153,72 #7d9948 
//submenu green - 88,107,54 #586b36
//submenu greenbg - 42,51,24 #2a3318 80%
//header greenbg 31,38,18 #1f2612 70%
//isle blue 76,173,197 #4cadc5

	function preloadimages(arr){
		var newimages=[], loadedimages=0
	    var postaction=function(){}
	    var arr=(typeof arr!="object")? [arr] : arr
	    function imageloadpost(){
	        loadedimages++
	        if (loadedimages==arr.length){
	            postaction(newimages) //call postaction and pass in newimages array as parameter
	        }
	    }
	    for (var i=0; i<arr.length; i++){
	        newimages[i]=new Image()
	        newimages[i].src=arr[i]
	        newimages[i].onload=function(){
	            imageloadpost()
	        }
	        newimages[i].onerror=function(){
	            imageloadpost()
	        }
	    }
	    return { //return blank object with done() method
	        done:function(f){
	            postaction=f || postaction //remember user defined callback functions to be called when images load
	        }
	    }

	}

	var canUseButtons = false;
	if(!isGoodBrowser || ! Detector.webgl) {
		loadDE405Plus(function () {
	    	console.log("loadDE405Plus callback");
		    preloadimages(['./images/solarsystem/sunmap.jpg', 
		                   './images/solarsystem/mercurymap.jpg', 
		                   './images/solarsystem/venusmap.jpg', 
		                   './images/solarsystem/earthmap2.jpg',
		                   './images/solarsystem/marsmap.jpg', 
		                   './images/solarsystem/jupitermap.jpg', 
		                   './images/solarsystem/saturnmap.jpg', 
		                   './images/solarsystem/uranusmap.jpg', 
		                   './images/solarsystem/neptunemap.jpg']).done(function(images){
		        //code inside here is run after all images have preloaded
		        //images parameter is an array of image objects corresponding to the preloaded images
		        //images[0] references the 1st image etc
		     
		        console.log("done preloading...");
		    
		        div.removeChild(infinityloader.canvas);
		        $("#loaderdiv").animate({opacity: 0.0}, 500, function() {
		            $("#loaderdiv").css('pointer-events', 'none');
		        });

		        //enable buttons
		        //these are tricky... only give them pointer events if they are visible
		        canUseButtons = true;
		        $("#introduction").animate({opacity: 1.0}, 500, function() {
		        	if($('#menupanel').css('opacity') != 0) {
			            $("#introduction").css('pointer-events', 'auto');
		        	}
		        });
		        $("#navigation").animate({opacity: 1.0}, 500, function() {
		        	if($('#menupanel').css('opacity') != 0) {
			            $("#navigation").css('pointer-events', 'auto');
		        	}
		        });
		        $("#challenge").animate({opacity: 1.0}, 500, function() {
		        	if($('#menupanel').css('opacity') != 0) {
			            $("#challenge").css('pointer-events', 'auto');
		        	}
		        });
		        //this button will deactivate once user hits it (hence not useable when not visible bug)
		        //it therefore does not need the visible treatment seen above
		        $("#beginbutton").animate({opacity: 1.0}, 500, function() {
		            $("#beginbutton").css('pointer-events', 'auto');
		        });
				
		    });
	    });
	} else {
		$("#beginbutton").animate({opacity: 1.0}, 500, function() {
            $("#beginbutton").css('pointer-events', 'auto');
        });
	}
    


	//loader
	var infinityloader = new Sonic({

		width: 160,
		height: 80,

		stepsPerFrame: 2,
		trailLength: .35,
		pointDistance: .01,
		fps: 25,

		fillColor: '#FF7B24',

		setup: function() {
			this._.lineWidth = 3;
		},

		step: function(point, i, f) {

			var progress = point.progress,
				degAngle = 360 * progress,
				angle = Math.PI/180 * degAngle,
				angleB = Math.PI/180 * (degAngle - 180),
				size = i*3;

			this._.fillRect(
				Math.cos(angle) * 35 + (100-size/2),
				Math.sin(angle) * 15 + (50-size/2),
				size * .75,
				size * .75
			);
			
			this._.fillStyle = '#3a84a6';

			this._.fillRect(
				Math.cos(angleB) * 25 + (100-size/2),
				Math.sin(angleB) * 10 + (50-size/2),
				size,
				size
			);

			this._.fillStyle = '#FFF47A';

			this._.beginPath();
			this._.arc(100, 50, 5, 0, 360, 0);
			this._.closePath();
			this._.fill();


		},

		path: [
			['line', 20, 5, 30, 45]
		]
	 
	});
	 
	infinityloader.play();
	var div = document.getElementById("canvastarget"); 
	div.appendChild(infinityloader.canvas);
	
	var drawingDone = function() {
		console.log("drawing done!!!");
	}
 
	$contenttarget = $("#contenttarget");
	// Create a popcorn instance by calling the Youtube player plugin     
	Popcorn.player( "baseplayer" );
	
	var popcornMedia = new Array();
	var popcornSequenceNumber = 1;
	popcornMedia[0] = Popcorn( '#videointro' );
	popcornMedia[1] = Popcorn( '#video' );
	popcornMedia[2] = Popcorn('#SEQ2_VO' );
	popcornMedia[3] = Popcorn('#SEQ3_VOpt1' );
	popcornMedia[4] = Popcorn('#SEQ3_VOpt2' );
	popcornMedia[5] = Popcorn( '#SEQ3_VOpt3' );
	popcornMedia[6] = Popcorn( '#SEQ_3_CAM_1a' );//lesson 1 - click drag
	popcornMedia[7] = Popcorn( '#SEQ_3_CAM_1b' );//call to action
	popcornMedia[8] = Popcorn( '#SEQ_3_CAM_1c' );
	popcornMedia[9] = Popcorn( '#SEQ_3_CAM_2a' );//lesson 2 - zoom
	popcornMedia[10] = Popcorn( '#SEQ_3_CAM_2b' );//call to action
	popcornMedia[11] = Popcorn( '#SEQ_3_CAM_3a' );//lesson 3 - click on planet earth
	popcornMedia[12] = Popcorn( '#SEQ_3_CAM_3b' );//call to action
	popcornMedia[13] = Popcorn( '#SEQ_3_CAM_3c' );//wrong planet clicked
	popcornMedia[14] = Popcorn( '#SEQ_3_CAM_4a' );//lesson 4
	popcornMedia[15] = Popcorn( '#SEQ_3_CAM_4b' );//call to action
	popcornMedia[16] = Popcorn( '#SEQ_3_CAM_4c' );//wrong button clicked
	popcornMedia[17] = Popcorn( '#SEQ_3_CAM_4d' ); //question
	popcornMedia[18] = Popcorn( '#SEQ_3_CAM_5a' ); //call to action
	popcornMedia[19] = Popcorn( '#SEQ_3_CAM_5b' ); //mistake
	popcornMedia[20] = Popcorn( '#SEQ_3_CAM_5c' ); //drag left
	popcornMedia[21] = Popcorn( '#SEQ_3_CAM_5d' ); //call to action
	popcornMedia[22] = Popcorn( '#SEQ_3_CAM_5e' ); //mistake
	popcornMedia[23] = Popcorn( '#SEQ_3_CAM_5f' ); //award badge
	
	popcornMedia[24] = Popcorn( '#SEQ_5_CAM_1a' ); //pick a rocket
	popcornMedia[25] = Popcorn( '#SEQ_5_CAM_1b' ); //try it out
	popcornMedia[26] = Popcorn( '#SEQ_5_CAM_1c' ); //award after user hits run
	popcornMedia[27] = Popcorn( '#SEQ_5_CAM_1d' ); //award after the landing on mars
	
	popcornMedia[28] = Popcorn( '#SEQ_5_CAM_Launch' );
	popcornMedia[29] = Popcorn( '#SEQ_5_sim_fail1' );
	popcornMedia[30] = Popcorn( '#SEQ_5_sim_fail2' );
	popcornMedia[31] = Popcorn( '#SEQ_5_sim_fail3' );
	popcornMedia[32] = Popcorn( '#SEQ_5_sim_fail4' );
	popcornMedia[33] = Popcorn( '#SEQ_6_CAM' );
	popcornMedia[34] = Popcorn( '#SEQ_5_fail1' );
	popcornMedia[35] = Popcorn( '#SEQ_5_fail2' );
	popcornMedia[36] = Popcorn( '#SEQ_5_fail3' );
	popcornMedia[37] = Popcorn( '#SEQ_5_fail4' );
	popcornMedia[38] = Popcorn( '#SEQ_7_cme_success' );

	//not sure if I'll need this baseplayer
	//decided to keep basepop in as a convenient way to initialize the 3D and fire up the first video player.  
	var basepop = Popcorn.baseplayer( "#contenttarget" ); 
	//var popcorn_branch1_video2 = Popcorn.youtube('#videocontenttarget2', 'https://www.youtube.com/watch?v=lKqr3F73bAI' );
	 
	var threedinitialized;
	var initializethreed = function() {
		if(!threedinitialized) {
			threedinitialized = true;
	        init(); //init the 3D background.
	        animate();

	        gui.destroy();  //remove the test GUI (used by Ryan)
	        
	        //set time to slight move
			$("#speedSlider").slider('value',.01);
			
	        //initialize mars/earth ruler to off
			showDistance = false;
	        scene.remove(ruler);
	        //showDistance = true;
	        //scene.add(ruler);
		}
	}
	
	basepop.cue( 1, function() {
		initializethreed();
	});
	
	basepop.cue( 2, function() {
		popcornMedia[popcornSequenceNumber].play();
	});
	
	//we've cut the intro.  
    popcornMedia[1].on( "play", function() {
    	//$("#videointrocontenttarget").animate({opacity: 1.0}, 100, function() {
           	//$("#videointrocontenttarget").css('pointer-events', 'auto');
       	//});

    	$("#backgroundtarget").animate({opacity: 0.0}, 100, function() {
           	$("#backgroundtarget").css('pointer-events', 'none');
       	});
    	
		$("#nextbuttonwrapper").animate({opacity: 1.0}, 200, function() {
        	$("#nextbuttonwrapper").css('pointer-events', 'auto');
    	});
	});
	

    popcornMedia[0].on( "ended", function() {

    	$("#videointrocontenttarget").animate({opacity: 0.0}, 1000, function() {
           	$("#videointrocontenttarget").css('pointer-events', 'none');
    		
        	advancePopcornMedia();
       	});
	});
	
    /*
	popcornMedia[1].footnote({
	    start: .1,
	    end: 22,
	    target: "headerpanel",
	    text: "Introduction"
	});
	popcornMedia[1].footnote({
	    start: 22,
	    target: "headerpanel",
	    text: "Mission to Mars: Setup"
	});
	*/
	popcornMedia[1].footnote({
		start: 0.5,
		end: 8.5,
	    target: "subtitlepanel",
		text: "Mary Beth Wilhelm",
	});
	popcornMedia[1].footnote({
		start: 0.5,
		end: 8.5,
	    target: "subtitlepanelb",
		text: "PhD Student at Georgia Tech",
	});
	popcornMedia[1].cue( 0.5, function() {
		$("#subtitlepanel").animate({opacity: 1.0}, 500, function() {
        	//$("#subtitlepanel").css('pointer-events', 'none');
    	});
		$("#subtitlepanelb").animate({opacity: 1.0}, 500, function() {
        	//$("#subtitlepanel").css('pointer-events', 'none');
    	});
	});
	popcornMedia[1].cue( 8, function() {
		$("#subtitlepanel").animate({opacity: 0.0}, 500, function() {
        	//$("#subtitlepanel").css('pointer-events', 'none');
    	});
		$("#subtitlepanelb").animate({opacity: 0.0}, 500, function() {
        	//$("#subtitlepanel").css('pointer-events', 'none');
    	});
	});
	/*
	popcornMedia[1].cue( .2, function() {
		$("#headerpanel").animate({opacity: 1.0}, 200, function() {
        	//$("#headerpanel").css('pointer-events', 'none');
    	});
	});*/

	//basepop.on( "timeupdate", function() {
		//document.getElementById( "footnotediv1" ).innerHTML = this.currentTime();
	//});
	popcornMedia[1].cue( .1, function() {
		$("#videocontenttarget").animate({width: 720, height: 405,
											top: "50%", left: "50%",
											margin:"-240px 0 0 -335px"}, 1, function() {
           	//code after completion of animation
       	});
		
    	$("#videocontenttarget").animate({opacity: 1.0}, 1000, function() {
           	$("#videocontenttarget").css('pointer-events', 'auto');
       	});

	});
	popcornMedia[1].cue( 22, function() {
		$("#videocontenttarget").animate({width: 360, height: 202,
											top: "10px", left: "10px",
											margin:"-0px 0 0 -0px"}, 1000, function() {
			//code after completion of animation
			//camTweener( { x: 0, y: 700, z: 0 }, { x: 0, y: 0, z: -20 }, 3000 );
		});
	});

	popcornMedia[1].cue( 18.5, function() {
		//removing because it's sort of odd per issue 20069
		/*
		$("#incomingmessage").animate({opacity: 1.0}, 1000, function() {
	       	$("#incomingmessage").css('pointer-events', 'auto');
	   	});
		
		setTimeout(function() {
			$("#incomingmessage").animate({opacity: 0.0}, 1000, function() {
		       	$("#incomingmessage").css('pointer-events', 'none');
		   	});
		}, 15000);
		*/
	});

	popcornMedia[1].on( "ended", function() {
    	$("#videocontenttarget").animate({opacity: 0.0}, 100, function() {
           	$("#videocontenttarget").css('pointer-events', 'none');
       	});
    	
    	advancePopcornMedia();
	});
	
    popcornMedia[2].on( "ended", function() {
    	advancePopcornMedia();
	});
    
    popcornMedia[2].cue( 6.5, function() {
    	Tweener(ssScale, {planetScale:.00001}, 1000);
    	Tweener(ssScale, {sunScale:.000002}, 1000);
    	Tweener(ssScale, {s:.00001}, 1000);
	});
    
    popcornMedia[2].cue( 11, function() {
    	Tweener(ssScale, {s:.000001}, 1000);
	});
    
    popcornMedia[2].cue( 12, function() {
    	Tweener(ssScale, {sunScale:.00001}, 1000);
    	Tweener(ssScale, {planetScale:.001}, 1000);
    	Tweener(ssScale, {s:.000001}, 1000);
	});
   
    popcornMedia[3].cue( 2, function() {
       	//camTweener( { x: 0, y: 800, z: 0 }, { x: 0, y: 0, z: -20 }, 3000 ); //old value, above shot
		camTweener( { x: -400, y: 200, z: 250 }, { x: 0, y: 0, z: -20 }, 1500 );

	});
    
    popcornMedia[3].cue( 6, function() {
		$("#speedSlider").slider('value',.23);
	});

	popcornMedia[3].cue( 10, function() {
		miles = true;
		showDistance = true;
		scene.add(ruler);

	});
	
	popcornMedia[3].cue( 13, function() {
		$("#speedSlider").slider('value',2.0);
	});
	
	popcornMedia[3].cue( 16, function() {
		$("#speedSlider").slider('value',.23);
	});
	popcornMedia[3].cue( 22, function() {
		showDistance = false;
		scene.remove(ruler);
	});
	
	
    popcornMedia[3].on( "ended", function() {
    	//zzz
    	//wait to advance until we've reached a date that is close to curiosity launch date
    	//advancePopcornMedia();
    	
		showDistance = false;
		scene.remove(ruler);

		//$("#speedSlider").slider('value',2.0);
		//$("#speedtimemessage").animate({opacity: 1.0}, 200, function() {
        //	$("#speedtimemessage").css('pointer-events', 'auto');
    	//});
		
		setTimeout(function() {
			//camTweener( { x: -400, y: 200, z: 300 }, { x: 0, y: 0, z: -20 }, 1500 );
			//remove message
			//$("#speedtimemessage").animate({opacity: 0.0}, 1000, function() {
	        //	$("#speedtimemessage").css('pointer-events', 'none');
	    	//});
			
			//slow down time
			$("#speedSlider").slider('value',.23);
			
			//start next popcorn segment (talks about curiosity here)
			advancePopcornMedia();
			
		},1);
			
		
	});
    
    
	popcornMedia[4].cue( 1, function() {
		showDistance = false;
		scene.remove(ruler);
	});
	
	//three ponit camera move to show off curiosity launch
	popcornMedia[4].cue( 3, function() {
		camTweener( { x: -111, y: 55, z: -316 }, { x: 0, y: 0, z: -20 }, 1500 );
	});
	
	popcornMedia[4].cue( 8, function() {
		camTweener( { x: -585, y: 362, z: 88 }, { x: 0, y: 0, z: -20 }, 6000 );
	});
	
	popcornMedia[4].cue( 14, function() {
		camTweener( { x: -232, y: 49, z: 291 }, { x: 0, y: 0, z: -20 }, 6000 );
	});
	
    popcornMedia[4].on( "ended", function() {
    	advancePopcornMedia();
	});
    popcornMedia[5].on( "ended", function() {
		
		camTweener( { x: 0, y: 100, z: 500 }, { x: 0, y: 0, z: -20 }, 1500 );
		setTimeout(function(){advancePopcornMedia()},2000);

		//erase 3d drawings if necessary
		clear3DDrawings();
	});
    
    popcornMedia[6].cue( .1, function() {
		$("#helpbuttonwrapper").animate({opacity: 1.0}, 200, function() {
        	$("#helpbuttonwrapper").css('pointer-events', 'auto');
    	});
	});
	popcornMedia[6].cue( .5, function() {
		$("#replaybuttonwrapper").animate({opacity: 1.0}, 200, function() {
        	$("#replaybuttonwrapper").css('pointer-events', 'auto');
    	});
	});

    popcornMedia[6].cue( 1.0, function() {
    	$("#threedcontrols").animate({opacity: 1.0}, 200, function() {
        	$("#threedcontrols").css('pointer-events', 'auto');
    	});
	});
    

    popcornMedia[6].cue( 3, function() {

    	ss[3].label.show();
    	ss[4].label.show();
	});
    
    popcornMedia[17].cue( 6, function() {
    	ss[3].label.show();
    	ss[4].label.show();
	});

    //setup vars to walk through mouse 3D lesson
    var cancelCallToAction=false;
    var listenToMouseMovements=false;
    var listenToMouseWheel=false;
    var userLessonNumber=0;
    var lessonOpen=false;
    
    //var userMouseAction=[false,false,false,false];
    var mousePosX, mousePosY;
    var callToActionTimeout = new Array();

    popcornMedia[6].on( "ended", function() {
    	//the click/drag test
        listenToMouseMovements=true;
        //userMouseAction[userLessonNumber]=true;
        lessonOpen=true;
        cancelCallToAction=false;
        callToActionTimeout[userLessonNumber] = setTimeout(function(){callToActionUser()},10000);
	});
    popcornMedia[9].on( "ended", function() {
        //the scroll mouse test
        listenToMouseWheel=true;
        //userMouseAction[userLessonNumber]=true;
        lessonOpen=true;
        cancelCallToAction=false;
        callToActionTimeout[userLessonNumber] = setTimeout(function(){callToActionUser()},10000);
	});
    popcornMedia[11].on( "ended", function() {
        //the planet click test (user to click planet earth)
        //userMouseAction[userLessonNumber]=true;
        lessonOpen=true;
        cancelCallToAction=false;
        callToActionTimeout[userLessonNumber] = setTimeout(function(){callToActionUser()},10000);
        
	});
    popcornMedia[14].on( "ended", function() {
        //the button click test (user to click mars button)
        //userMouseAction[userLessonNumber]=true;
        lessonOpen=true;
        cancelCallToAction=false;
        callToActionTimeout[userLessonNumber] = setTimeout(function(){callToActionUser()},10000);
	});

    popcornMedia[17].on( "ended", function() {
        //lesson 5 drag right
        lessonOpen=true;
        cancelCallToAction=false;
        callToActionTimeout[userLessonNumber] = setTimeout(function(){callToActionUser()},10000);
	});

    popcornMedia[20].on( "ended", function() {
        //lesson 6 drag left
        lessonOpen=true;
        cancelCallToAction=false;
        callToActionTimeout[userLessonNumber] = setTimeout(function(){callToActionUser()},10000);
	});
    
    popcornMedia[23].cue( 8, function() {
    	$("#solarsystembadge").animate({opacity: 1.0}, 200, function() {
        	$("#solarsystembadge").css('pointer-events', 'auto');
        });
	});
    
    popcornMedia[24].cue( 39, function() {
		
        $("#selectmissionrocket").animate({opacity: 1.0}, 1000, function() {
        	$("#selectmissionrocket").css('pointer-events', 'auto');
    	});
        $("#launchcontrols").animate({opacity: 0.0}, 1000, function() {
        	$("#launchcontrols").css('pointer-events', 'none');
    	});
	});
    
    popcornMedia[28].cue( 2, function() {
    	//if this audio plays, that means we're ready to launch.
    	//disable test controls
		/*
        $("#runbutton").animate({opacity: 0.0}, 200, function() {
        	$("#runbutton").css('pointer-events', 'none');
    	});
    	$("#rocketbutton").animate({opacity: 0.0}, 200, function() {
        	$("#rocketbutton").css('pointer-events', 'none');
    	});
    	$("#landingdatepicker").css('pointer-events', 'none');
    	$("#launchdatepicker").css('pointer-events', 'none');
    	*/
    	//show launch control
        $("#launchcommitdiv").animate({opacity: 1.0}, 200, function() {
        	$("#launchcommitdiv").css('pointer-events', 'auto');
    	});
    	
	});
    
    popcornMedia[33].cue( 2, function() {
      	//award rocket badge
    	$("#rocketbadge").animate({opacity: 1.0}, 200, function() {
        	$("#rocketbadge").css('pointer-events', 'auto');
        });
    	
	});
    
    
    $(document).on('mouseup', function(e) {
    	if(camera.position) console.log("x:" + camera.position.x + "y:" + camera.position.y + "z:" + camera.position.z);
        
        if(!listenToMouseMovements) return;
        //console.log("got me a mouseup: " + userMouseAction[userLessonNumber]);
        if(lessonOpen) {
        	//get event
        	if (!e) var e = window.event;
        	var clickedElement = (e.target || e.srcElement);
        	//check to make sure that we're clicking the 3d canvas object (the only one)
        	if(clickedElement!="[object HTMLCanvasElement]") return;
        	//check to see if the user moved the mouse.
        	var newMousePosX, newMousePosY;
        	
        	if (e.pageX || e.pageY) 	{
        		newMousePosX = e.pageX;
        		newMousePosY = e.pageY;
        	}
        	else if (e.clientX || e.clientY) 	{
        		newMousePosX = e.clientX + document.body.scrollLeft
        			+ document.documentElement.scrollLeft;
        		newMousePosY = e.clientY + document.body.scrollTop
        			+ document.documentElement.scrollTop;
        	}

        	//console.log("x: " + newMousePosX + "   y: " + newMousePosY);
        	if(mousePosX!=newMousePosX || mousePosY!=newMousePosY ) {
        		advanceUser();
        	} else {
    			jumpPopcornMedia(8);
        	}
        }
    });
    

	document.addEventListener( 'keyup', onSpaceBarKeyUp, false );
	
	function onSpaceBarKeyUp ( event ) {
		
		if (event.keyCode == 32) { //just looking for spacebar on this mission.
			if($('#playbuttonwrapper').css('opacity') != 0) {
				$("#playtoggle").click();
			}
		}
	};
    
    $(document).on('mousedown', function(e) {
		$("#menupanel").animate({opacity: 0.0}, 200, function() { $("#menupanel").css('pointer-events', 'none'); });
		$("#threedhelppopup").animate({opacity: 0.0}, 200, function() { $("#threedhelppopup").css('pointer-events', 'none'); });
		$("#helppopup").animate({opacity: 0.0}, 200, function() { $("#helppopup").css('pointer-events', 'none'); });
		$("#launchhelppopup").animate({opacity: 0.0}, 200, function() { $("#launchhelppopup").css('pointer-events', 'none'); });
		$("#aboutpopup").animate({opacity: 0.0}, 200, function() { $("#aboutpopup").css('pointer-events', 'none'); });
		$("#baddatespopup").animate({opacity: 0.0}, 200, function() { $("#baddatespopup").css('pointer-events', 'none'); });
		
		//$("#browserpopup").animate({opacity: 0.0}, 200, function() { $("#browserpopup").css('pointer-events', 'none'); });
		
		//planet clicking
    	if(projector) {
        	var vector = new THREE.Vector3( mouse.x, mouse.y, 1 );
        	projector.unprojectVector( vector, camera );

        	var raycaster = new THREE.Raycaster( camera.position, vector.sub( camera.position ).normalize() );
        	intersects = raycaster.intersectObjects( solarSystem.children );

        	if ( intersects.length > 0 ) {

        		// if ( CLICKED != intersects[ 0 ].object ) {

        			CLICKED = intersects[ 0 ].object;

        			if( clickMove ){
        				var posCLICKED = new THREE.Vector3();
        				posCLICKED.getPositionFromMatrix( CLICKED.matrixWorld );

        				var zScale = 250;
        				lookAtCLICKED = { x: posCLICKED.x + 50, y: posCLICKED.y + 50, z: posCLICKED.z + zScale };

        				var camCLICKED = new camPosition( lookAtCLICKED, posCLICKED, 1000 );
        				camCLICKED.tween();

        				console.log( CLICKED.name + " x: " + posCLICKED.x + " y: " + posCLICKED.y + " z: " + posCLICKED.z );

    					console.log("userLessonNumber: " + userLessonNumber);
    					console.log("lessonOpen: " + lessonOpen);
        				
        				if(CLICKED.name=="Earth" && lessonOpen && userLessonNumber==2) {
        					//planet earth clicked, time to move on to next lesson
							audioLock=false;
        					advanceUser();
        				} else if(CLICKED.name!="Earth" && lessonOpen && userLessonNumber==2) {
							//if wrong planet clicked
							jumpPopcornMedia(13);
							
							if(audioLock==false) {
								setTimeout(function(){
									audioLock=false;
								},5000);
							}
							audioLock=true;
        				}
        			}
        			
        		// }
        	} 
    	}
    	
    	//lesson listening
    	if(!listenToMouseMovements) return;
    	cancelCallToAction=true;
    	
    	//record mouse down possition
    	if (!e) var e = window.event;
    	//check to make sure that we're clicking the 3d canvas object (the only one)
    	var clickedElement = (e.target || e.srcElement);
    	if(clickedElement!="[object HTMLCanvasElement]") return;
    	
    	if (e.pageX || e.pageY) 	{
    		mousePosX = e.pageX;
    		mousePosY = e.pageY;
    	}
    	else if (e.clientX || e.clientY) 	{
    		mousePosX = e.clientX + document.body.scrollLeft
    			+ document.documentElement.scrollLeft;
    		mousePosY = e.clientY + document.body.scrollTop
    			+ document.documentElement.scrollTop;
    	}
    	
    });
  
	//Firefox has no implemented $(document).on('mousewheel', function) so we call mousywheely(e) for XBrowser support
    var mousewheelevt=(/Firefox/i.test(navigator.userAgent))? "DOMMouseScroll" : "mousewheel" //FF doesn't recognize mousewheel as of FF3.x
    
   	if (document.attachEvent) //if IE (and Opera depending on user setting)
   	    document.attachEvent("on"+mousewheelevt, mousywheely)
   	else if (document.addEventListener) //WC3 browsers
   	    document.addEventListener(mousewheelevt, mousywheely, false)
    	
    function mousywheely(e){
    	if(!listenToMouseWheel) return;
    	var evt=window.event || e //equalize event object
        var delta=evt.detail? evt.detail*(-120) : evt.wheelDelta //check for detail first so Opera uses that instead of wheelDelta
        console.log("mousewheel delta: " + delta);
        if(delta>0 || delta<0) { //the user zoomed in
        	listenToMouseWheel=false;
        	setTimeout(function(){advanceUser()},1000);
        }
    }
    
    var advanceUser = function () {
    	console.log("advancing user from: " + userLessonNumber);
		listenToMouseMovements=false;
		cancelCallToAction=false;
        lessonOpen=false;
		clearTimeout(callToActionTimeout[userLessonNumber]);
		
		switch(userLessonNumber)
    	{
    	case 0:
			jumpPopcornMedia(9);
    	  break;
    	case 1:
			jumpPopcornMedia(11);
    	  break;
    	case 2:
			jumpPopcornMedia(14);
    	  break;
    	case 3:
			jumpPopcornMedia(17);
	    	break;
    	case 4:
			jumpPopcornMedia(20);
	    	break;
    	case 5:
			jumpPopcornMedia(23);
	    	break;
    	  break;
    	default:
    	  //no default audio
    	}
		
    	userLessonNumber++; //update to next lesson
		
    }
    
    var replayUser = function () {

		lessonOpen=false;
    	resetLesson();
		
		camTweener( { x: 0, y: 100, z: 500 }, { x: 0, y: 0, z: -20 }, 1500 );
		
		jumpPopcornMedia(6);
		
    }
    
    var resetLesson = function () {
        clearTimeout(callToActionTimeout[userLessonNumber]);
    	
    	cancelCallToAction=true;
        listenToMouseMovements=false;
        listenToMouseWheel=false;
        userLessonNumber=0;
        lessonOpen=false;
        firstTimeRocketSelect=true;
        //for(var i=0;i<userMouseAction.length;i++) {
        //	userMouseAction[i]=false;
        //}
    }
    
    var callToActionUser = function () {
    	console.log("call to action: ", cancelCallToAction);
    	if(cancelCallToAction) return;
    	
    	switch(userLessonNumber)
    	{
    	case 0:
			jumpPopcornMedia(7);
    	  break;
    	case 1:
			jumpPopcornMedia(10);
    	  break;
    	case 2:
			jumpPopcornMedia(12);
    	  break;
    	case 3:
			jumpPopcornMedia(15);
	    	break;
    	case 4:
			jumpPopcornMedia(18);
	    	break;
    	case 5:
			jumpPopcornMedia(21);
    	  break;
    	default:
    	  //no default audio
    	}
    }

    //user has to select mars button
    var checkForFourthCameraLesson = function () {
    	if(lessonOpen && userLessonNumber==3) {
    		jumpPopcornMedia(16);

    		if(audioLock==false) {
				setTimeout(function(){
					audioLock=false;
				},5000);
			}
			audioLock=true;
    	}
    }
    
    var finishFourthCameraLesson = function () {
    	if(lessonOpen && userLessonNumber==3) {
    		clearTimeout(callToActionTimeout[userLessonNumber]);
    		audioLock=false;
            lessonOpen=true;
    		//jumpPopcornMedia(17);
    		setTimeout(function(){advanceUser();},1000);
    		
    		
            $("#launchcontrols").animate({opacity: 1.0}, 200, function() {
            	$("#launchcontrols").css('pointer-events', 'auto');
        	});
    	}
    }
    
    var advancePopcornMedia = function () {
		popcornSequenceNumber++;
    	if(popcornSequenceNumber<popcornMedia.length) {
    		popcornMedia[popcornSequenceNumber].play(0);
        	
            showTransmissionMessage();
    	}
    }
    
    //a way to skip around (needed for Next button and Menu buttons)
    var audioLock = false;
    var jumpPopcornMedia = function (sequenceNum, beginningOffset) {
		if(popcornSequenceNumber>=popcornMedia.length || audioLock)return;
		popcornSequenceNumber=sequenceNum;
		//clear div targets
    	//hideeverything();
		
		//stop all other media
		for(var i=0;i<popcornMedia.length;i++) {
			popcornMedia[i].pause();
		}
		
		//jump to desired media
		if(popcornSequenceNumber<=1 && !threedinitialized) {
			basepop.play(0);
		} else {
			if(beginningOffset) {
				popcornMedia[popcornSequenceNumber].play(beginningOffset);
			} else {
				popcornMedia[popcornSequenceNumber].play(0);
			}
		}
		//show pause toggle
		$("#playtoggle").attr("class", "pause");
        showTransmissionMessage();
    }
    
  	var showTransmissionMessage = function() {
  		if(popcornSequenceNumber<6) return;
  		$("#transmissionmessage").animate({opacity: 1.0}, 300, function() { $("#transmissionmessage").css('pointer-events', 'auto'); });
  	  	setTimeout(function() {
  	  		$("#transmissionmessage").animate({opacity: 0.0}, 300, function() { $("#transmissionmessage").css('pointer-events', 'none'); });
  	  	},4000);
  	}
    
    var clear3DDrawings = function() {

		if(trajectory) {
			solarSystem.remove( trajectory.line );
			trajectory=null;
		}
		
        //initialize mars/earth ruler to off
		showDistance = false;
        scene.remove(ruler);
    	
    }
    
	var openMenuPanel = function() {
		$("#menupanel").animate({opacity: 1.0}, 200, function() {
        	$("#menupanel").css('pointer-events', 'auto');
    	});
		if(canUseButtons) {
            $("#introduction").css('pointer-events', 'auto');
            $("#navigation").css('pointer-events', 'auto');
            $("#challenge").css('pointer-events', 'auto');
		}
	}
	var closeMenuPanel = function() {
		$("#menupanel").animate({opacity: 0.0}, 200, function() {
        	$("#menupanel").css('pointer-events', 'none');
    	});
        $("#introduction").css('pointer-events', 'none');
        $("#navigation").css('pointer-events', 'none');
        $("#challenge").css('pointer-events', 'none');
	}
	
	var hideeverything = function() {
		//$("#startmenupanel").animate({opacity: 0.0}, 1, function() { $("#startmenupanel").css('pointer-events', 'none'); });
		//$("#menupanel").animate({opacity: 0.0}, 1, function() { $("#menupanel").css('pointer-events', 'none'); });
		closeMenuPanel();
		$("#videocontenttarget").animate({opacity: 0.0}, 1, function() { $("#videocontenttarget").css('pointer-events', 'none'); });
		$("#videointrocontenttarget").animate({opacity: 0.0}, 1, function() { $("#videointrocontenttarget").css('pointer-events', 'none'); });
		
		$("#aboutpopup").animate({opacity: 0.0}, 1, function() { $("#aboutpopup").css('pointer-events', 'none'); });
		$("#helppopup").animate({opacity: 0.0}, 1, function() { $("#helppopup").css('pointer-events', 'none'); });
		$("#threedhelppopup").animate({opacity: 0.0}, 1, function() { $("#threedhelppopup").css('pointer-events', 'none'); });
		$("#launchhelppopup").animate({opacity: 0.0}, 1, function() { $("#launchhelppopup").css('pointer-events', 'none'); });
		//$("#browserpopup").animate({opacity: 0.0}, 1, function() { $("#browserpopup").css('pointer-events', 'none'); });
		
		$("#incomingmessage").animate({opacity: 0.0}, 1, function() { $("#incomingmessage").css('pointer-events', 'none'); });
		$("#transmissionmessage").animate({opacity: 0.0}, 1, function() { $("#transmissionmessage").css('pointer-events', 'none'); });
		$("#cmemessage").animate({opacity: 0.0}, 1, function() { $("#cmemessage").css('pointer-events', 'none'); });

		$("#selectmissionrocket").animate({opacity: 0.0}, 1, function() { $("#selectmissionrocket").css('pointer-events', 'none'); });
		$("#launchcontrols").animate({opacity: 0.0}, 1, function() { $("#launchcontrols").css('pointer-events', 'none'); });
		
		$("#nextbuttonwrapper").animate({opacity: 0.0}, 1, function() { $("#nextbuttonwrapper").css('pointer-events', 'none'); });
		$("#helpbuttonwrapper").animate({opacity: 0.0}, 1, function() { $("#helpbuttonwrapper").css('pointer-events', 'none'); });
		$("#replaybuttonwrapper").animate({opacity: 0.0}, 1, function() { $("#replaybuttonwrapper").css('pointer-events', 'none'); });
		

		$("#solarsystembadge").animate({opacity: 0.0}, 1, function() { $("#solarsystembadge").css('pointer-events', 'none'); });
		$("#solarsystembadgecomplete").animate({opacity: 0.0}, 1, function() { $("#solarsystembadgecomplete").css('pointer-events', 'none'); });
		
		$("#rocketbadge").animate({opacity: 0.0}, 1, function() { $("#rocketbadge").css('pointer-events', 'none'); });
		$("#rocketbadgecomplete").animate({opacity: 0.0}, 1, function() { $("#rocketbadgecomplete").css('pointer-events', 'none'); });
		
		$("#subtitlepanel").animate({opacity: 0.0}, 1, function() {});
		$("#subtitlepanelb").animate({opacity: 0.0}, 1, function() {});
		
		$("#speedtimemessage").animate({opacity: 0.0}, 1, function() { $("#speedtimemessage").css('pointer-events', 'none'); });
		$("#quicklaunchpopup").animate({opacity: 0.0}, 1, function() { $("#quicklaunchpopup").css('pointer-events', 'none'); });
		
	}
	
	//xxx unit test for menus
	//$("#landingdatepicker").css('background-color', '#ff0000');
	//$("#scientisthelppopup").animate({opacity: 1.0}, 1, function() { $("#scientisthelppopup").css('pointer-events', 'auto'); });
	//$("#launchcontrols").animate({opacity: 1.0}, 1, function() { $("#launchcontrols").css('pointer-events', 'auto'); });
	//$("#launchdiv").animate({opacity: 1.0}, 1, function() { $("#launchdiv").css('pointer-events', 'auto'); });
	//$("#launchcommitdiv").animate({opacity: 1.0}, 1, function() { $("#launchcommitdiv").css('pointer-events', 'auto'); });
	//$("#launchcommitbutton").animate({opacity: 1.0}, 1, function() { $("#launchcommitbutton").css('pointer-events', 'auto'); });
	
    popcornMedia[17].cue( 3, function() {
       	camTweener( { x: 0, y: 1100, z: 0 }, { x: 0, y: 0, z: -20 }, 3000 );
	});
    
    
    //pop the mission complete
    var popSolarSystemBadgeWindow = function() {
    	//first we should check to see if the user email has been stored
    	//if(userBackpackEmail) {}
    	
    	//then pop the appropriate window
    	var winWidth = 800;
    	var winHeight = 800;
    	badgeWindow = popupwindow("../badge-it-gadget-lite/process-badges/badge_solar_system.html",
    			"Solar System Badge",winWidth, winHeight);
    }
    var popRocketBadgeWindow = function() {
    	//first we should check to see if the user email has been stored
    	//if(userBackpackEmail) {}
    	
    	//then pop the appropriate window
    	var winWidth = 800;
    	var winHeight = 800;
    	badgeWindow = popupwindow("../badge-it-gadget-lite/process-badges/badge_mission_to_mars.html",
    			"Rocket Badge",winWidth, winHeight);
    }
    
    //generic popup window opening function
    var solarsystembadgeuploadbutton = document.getElementById('solarsystembadgeuploadbutton');
    solarsystembadgeuploadbutton.onclick = function() {
    	popSolarSystemBadgeWindow();
    };
    
    /*var openThreeDHelp = document.getElementById('openThreeDHelp');
    openThreeDHelp.onclick = function() {
		$("#helppopup").animate({opacity: 0.0}, 200, function() {
        	$("#helppopup").css('pointer-events', 'none');
			$("#threedhelppopup").animate({opacity: 1.0}, 200, function() {
            	$("#threedhelppopup").css('pointer-events', 'auto');
        	});
    	});
    };
    
    var openLaunchHelp = document.getElementById('openLaunchHelp');
    openLaunchHelp.onclick = function() {
		$("#helppopup").animate({opacity: 0.0}, 200, function() {
        	$("#helppopup").css('pointer-events', 'none');
			$("#launchhelppopup").animate({opacity: 1.0}, 200, function() {
            	$("#launchhelppopup").css('pointer-events', 'auto');
        	});
    	});
    };*/
    
    var rocketbadgeuploadbutton = document.getElementById('rocketbadgeuploadbutton');
    rocketbadgeuploadbutton.onclick = function() {
    	popRocketBadgeWindow();
    };
    
    function popupwindow(url, title, w, h) {
    	  var left = (screen.width/2)-(w/2);
    	  var top = (screen.height/2)-(h/2);
    	  return window.open(url, title, "titlebar=no,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,copyhistory=no,width="+w+", height="+h+", top="+top+", left="+left);
    }
    
    var firstTimeRocketSelect = true;
    var selectmissioncontinue = document.getElementById('selectmissioncontinuebutton');
    selectmissioncontinue.style.cursor = 'pointer';
    selectmissioncontinue.onclick = function() {
		//set the date to 2036 prior to simulation run.
		var jumpToDate = new Date(2036,0,1).Date2Julian();
		timer.JD = jumpToDate;
		$("#speedSlider").slider('value',.01);
		
    	$("#selectmissionrocket").animate({opacity: 0.0}, 200, function() {
        	$("#selectmissionrocket").css('pointer-events', 'none');

            $("#launchcontrols").animate({opacity: 1.0}, 200, function() {
            	$("#launchcontrols").css('pointer-events', 'auto');
                $("#launchdiv").animate({opacity: 1.0}, 200, function() {
                	$("#launchdiv").css('pointer-events', 'auto');
            	});

    			$("#launchcommitdiv").animate({opacity: 0.5}, 200, function() {
                	$("#launchcommitdiv").css('pointer-events', 'none');
            	});
        	});
            if(firstTimeRocketSelect) {

                jumpPopcornMedia(26);
                firstTimeRocketSelect=false;
            }
        });
    };

    var solarsystembadgeskipbutton = document.getElementById('solarsystembadgeskipbutton');
    solarsystembadgeskipbutton.onclick = function() {
    	$("#solarsystembadge").animate({opacity: 0.0}, 200, function() {
        	$("#solarsystembadge").css('pointer-events', 'none');
        });
    	
    	setTimeout(function(){jumpPopcornMedia(24)},2000);
    };


    var solarsystembadgecompletereplaybutton = document.getElementById('solarsystembadgecompletereplaybutton');
    solarsystembadgecompletereplaybutton.onclick = function() {
    	//this will take you back to the 3D navigation lesson.
    	$("#navigation").click();
    };
    

    var solarsystembadgecompletecontinuebutton = document.getElementById('solarsystembadgecompletecontinuebutton');
    solarsystembadgecompletecontinuebutton.onclick = function() {
    	$("#solarsystembadgecomplete").animate({opacity: 0.0}, 200, function() {
        	$("#solarsystembadgecomplete").css('pointer-events', 'none');
        });
    	$("#solarsystembadgeskipbutton").click();
    };
    

    var rocketbadgeskipbutton = document.getElementById('rocketbadgeskipbutton');
    rocketbadgeskipbutton.onclick = function() {
    	$("#rocketbadge").animate({opacity: 0.0}, 200, function() {
        	$("#rocketbadge").css('pointer-events', 'none');
        });
    	

    	$("#rocketbadgecomplete").animate({opacity: 1.0}, 200, function() {
        	$("#rocketbadgecomplete").css('pointer-events', 'auto');
        });
    	
    };


    var rocketbadgecompletereplaybutton = document.getElementById('rocketbadgecompletereplaybutton');
    rocketbadgecompletereplaybutton.onclick = function() {
    	//this will take you back to the 3D navigation lesson.
    	$("#challenge").click();
    };
    

    var rocketbadgecompletecontinuebutton = document.getElementById('rocketbadgecompletecontinuebutton');
    rocketbadgecompletecontinuebutton.onclick = function() {
    	window.open ('indexRover.html','_self',false);
    };
    
    var rocketbadgecompletereplaybutton = document.getElementById('rocketbadgecompletereplaybutton');
    rocketbadgecompletereplaybutton.onclick = function() {
    	$("#rocketbadgecomplete").animate({opacity: 0.0}, 200, function() {
        	$("#rocketbadgecomplete").css('pointer-events', 'none');
        });

    	$("#challenge").click();
    };
    
    var rocketbadgecompleteremixbutton = document.getElementById('rocketbadgecompleteremixbutton');
    rocketbadgecompleteremixbutton.onclick = function() {
    	window.open ('remix_mars_mission.html','_new',false);
    };
    

    
    var closeAllSubMenus = function() {
    	$("#aboutpopup").animate({opacity: 0.0}, 200, function() {$("#aboutpopup").css('pointer-events', 'none');});
    	$("#helppopup").animate({opacity: 0.0}, 200, function() {$("#helppopup").css('pointer-events', 'none');});
    	$("#threedhelppopup").animate({opacity: 0.0}, 200, function() {$("#threedhelppopup").css('pointer-events', 'none');});
    	$("#launchhelppopup").animate({opacity: 0.0}, 200, function() {$("#launchhelppopup").css('pointer-events', 'none');});
    	//$("#browserpopup").animate({opacity: 0.0}, 200, function() {$("#browserpopup").css('pointer-events', 'none');});
    	$("#incomingmessage").animate({opacity: 0.0}, 200, function() {$("#incomingmessage").css('pointer-events', 'none');});
    	$("#cmemessage").animate({opacity: 0.0}, 200, function() {$("#cmemessage").css('pointer-events', 'none');});
		$("#transmissionmessage").animate({opacity: 0.0}, 1, function() { $("#transmissionmessage").css('pointer-events', 'none'); });

		$("#quicklaunchpopup").animate({opacity: 0.0}, 1, function() { $("#quicklaunchpopup").css('pointer-events', 'none'); });
    }
    
    var rocketbutton = document.getElementById('rocketbutton');
    rocketbutton.style.cursor = 'pointer';
    rocketbutton.onclick = function() {
		//clear 3d lines
		clear3DDrawings();
		//clear touchdown timer
		//clearInterval(checktouchdown);

		var jumpToDate = new Date(2036,0,1).Date2Julian();
		timer.JD = jumpToDate;
		$("#speedSlider").slider('value',.01);
		
    	$("#launchcontrols").animate({opacity: 0.0}, 200, function() {
        	$("#launchcontrols").css('pointer-events', 'none');
        	$("#selectmissionrocket").animate({opacity: 1.0}, 200, function() {
            	$("#selectmissionrocket").css('pointer-events', 'auto');
            });
        });

		$("#quicklaunchpopup").animate({opacity: 0.0}, 1, function() { $("#quicklaunchpopup").css('pointer-events', 'none'); });
    };
    
    
    var quicksetlaunchbutton = document.getElementById('quicksetlaunchbutton');
    quicksetlaunchbutton.style.cursor = 'pointer';
    quicksetlaunchbutton.onclick = function() {
		launchPlanetDistance = ruler.getDistance();
		document.getElementById( "launchdatepicker" ).value = document.getElementById( "orbitdate" ).value;
		launchDate = new Date(Date.parse(document.getElementById( "orbitdate" ).value));
		if(landingDate)monthDifference = landingDate - launchDate;
		launchRewindDate = new Date(Date.parse(document.getElementById( "orbitdate" ).value));
		launchRewindDate.setDate(launchRewindDate.getDate()-5);
		$("#quicklaunchpopup").animate({opacity: 0.0}, 1, function() { $("#quicklaunchpopup").css('pointer-events', 'none'); });
    };
    
    var quicksetlandbutton = document.getElementById('quicksetlandbutton');
    quicksetlandbutton.style.cursor = 'pointer';
    quicksetlandbutton.onclick = function() {
		document.getElementById( "landingdatepicker" ).value = document.getElementById( "orbitdate" ).value;
		landingDate = new Date(Date.parse(document.getElementById( "orbitdate" ).value));
		if(launchDate)monthDifference = landingDate - launchDate;
		clear3DDrawings();
		$("#quicklaunchpopup").animate({opacity: 0.0}, 1, function() { $("#quicklaunchpopup").css('pointer-events', 'none'); });
    };

    

    /*
    var scientistclosebutton = document.getElementById('scientistclosebutton');
    scientistclosebutton.style.cursor = 'pointer';
    scientistclosebutton.onclick = function() {
		$("#scientisthelppopup").animate({opacity: 0.0}, 1, function() { $("#scientisthelppopup").css('pointer-events', 'none'); });
    };
    
    var scientisttrybutton = document.getElementById('scientisttrybutton');
    scientisttrybutton.style.cursor = 'pointer';
    scientisttrybutton.onclick = function() {
    	document.getElementById( "landingdatepicker" ).value = "";
		landingDate = null;
		$("#landingdatepicker").css('background-color', '#ff0000');
		//document.getElementById( "landingdatepicker" ).value = document.getElementById( "orbitdate" ).value;
		//landingDate = new Date(Date.parse(document.getElementById( "orbitdate" ).value));
		//if(launchDate)monthDifference = landingDate - launchDate;
		var tryDate = "10/01/2037";
		launchDate = new Date(Date.parse(tryDate));
		document.getElementById( "launchdatepicker" ).value = tryDate;
		launchRewindDate = new Date(Date.parse(tryDate));
		launchRewindDate.setDate(launchRewindDate.getDate()-5);
		var jumpToDate = new Date(Date.parse(tryDate)).Date2Julian();
		timer.JD = jumpToDate;
		clear3DDrawings();
		$("#scientisthelppopup").animate({opacity: 0.0}, 1, function() { $("#scientisthelppopup").css('pointer-events', 'none'); });
    };
    */
    
    var orbitdate = document.getElementById('orbitdate');
    orbitdate.style.cursor = 'pointer';
    orbitdate.onclick = function() {
    	$("#quicklaunchpopup").animate({opacity: 1.0}, 1, function() { $("#quicklaunchpopup").css('pointer-events', 'auto'); });
    };
    
    

	var savedSliderVal;
	var previousSliderVal;
    var minusbutton = document.getElementById('minusbutton');
    minusbutton.style.cursor = 'pointer';
    minusbutton.onclick = function() {
    	var newVal = savedSliderVal;
    	if(savedSliderVal <= 2) {
    		newVal=1.5;
    	}
    	if(savedSliderVal <= 1.5) {
    		newVal=1;
    	}
    	if(savedSliderVal <= 1) {
    		newVal=0.5;
    	}
    	if(savedSliderVal <= 0.5) {
    		newVal=0.02;
    	}
    	if(savedSliderVal <= 0.02) {
    		newVal=0;
    	}
    	if(savedSliderVal <= 0) {
    		newVal=-0.02;
    	} 
    	if(savedSliderVal <= -0.02) {
    		newVal=-0.5;
    	}
    	if(savedSliderVal <= -0.5) {
    		newVal=-1;
    	}
    	if(savedSliderVal <= -1) {
    		newVal= -1.5;
    	}
    	if(savedSliderVal <= -1.5) {
    		newVal=-2;
    	}
    	
    	savedSliderVal=newVal;
		$("#speedSlider").slider('value',newVal);
    };
    
    var plusbutton = document.getElementById('plusbutton');
    plusbutton.style.cursor = 'pointer';
    plusbutton.onclick = function() {
    	var newVal = savedSliderVal;
    	if(savedSliderVal >= -2) {
    		newVal=-1.5;
    	} 
    	if(savedSliderVal >= -1.5) {
    		newVal=-1;
    	}
    	if(savedSliderVal >= -1) {
    		newVal= -0.5;
    	}
    	if(savedSliderVal >= -0.5) {
    		newVal=-0.02;
    	}
    	if(savedSliderVal >= -0.02) {
    		newVal=0;
    	}
    	if(savedSliderVal >= 0) {
    		newVal=0.02;
    	} 
    	if(savedSliderVal >= 0.02) {
    		newVal=0.5;
    	} 
    	if(savedSliderVal >= .5) {
    		newVal=1;
    	}
    	if(savedSliderVal >= 1) {
    		newVal=1.5;
    	}
    	if(savedSliderVal >= 1.5) {
    		newVal=2;
    	}
    	savedSliderVal=newVal;
		$("#speedSlider").slider('value',newVal);
    };
    
    //selectmissionrocket div
    var rocketChoice = 0;
    var rocket1div = document.getElementById('rocket1div');
    rocket1div.style.cursor = 'pointer';
    rocket1div.onclick = function() {
   		//$("#rocket1div").css('outline', '4px solid rgba(200,200,200,1.0');
   		//document.getElementById('rocket1div').style.outline = '1px solid rgba(200,200,200,1.0';
   		document.getElementById("rocket1").src="./images/rocket_falcon_heavy_s.png";
   		document.getElementById("rocket2").src="./images/rocket_delta_iv_heavy_n.png";
   		document.getElementById("rocket3").src="./images/rocket_nasa_sls_n.png";
   		rocketChoice=0;
   		document.getElementById("rocketselect").src="./images/icon_rocket_falcon_heavy.png";
   		document.getElementById("rocketbuttontext").innerHTML="Falcon Heavy";
    };
    var rocket2div = document.getElementById('rocket2div');
    rocket2div.style.cursor = 'pointer';
    rocket2div.onclick = function() {
   		document.getElementById('rocket2div').style.outline = '1px solid rgba(200,200,200,1.0';
   		document.getElementById("rocket1").src="./images/rocket_falcon_heavy_n.png";
   		document.getElementById("rocket2").src="./images/rocket_delta_iv_heavy_s.png";
   		document.getElementById("rocket3").src="./images/rocket_nasa_sls_n.png";
   		rocketChoice=1;
   		document.getElementById("rocketselect").src="./images/icon_rocket_delta_iv_heavy.png";
   		document.getElementById("rocketbuttontext").innerHTML="Delta IV Heavy";
    };
    var rocket3div = document.getElementById('rocket3div');
    rocket3div.style.cursor = 'pointer';
    rocket3div.onclick = function() {
   		document.getElementById('rocket3div').style.outline = '1px solid rgba(200,200,200,1.0';
   		document.getElementById("rocket1").src="./images/rocket_falcon_heavy_n.png";
   		document.getElementById("rocket2").src="./images/rocket_delta_iv_heavy_n.png";
   		document.getElementById("rocket3").src="./images/rocket_nasa_sls_s.png";
   		rocketChoice=2;
   		document.getElementById("rocketselect").src="./images/icon_rocket_nasa_sls.png";
   		document.getElementById("rocketbuttontext").innerHTML="Nasa<br>SLS";
   		
    };
    
    
    $("#rocket1").hover(function() {
    	$("#rocket1details").animate({opacity: 1.0}, 200, function() {
        	$("#rocket1details").css('pointer-events', 'auto');
        });
    }, function() {
    	$("#rocket1details").animate({opacity: 0.0}, 200, function() {
        	$("#rocket1details").css('pointer-events', 'none');
        });
    });
    
    $("#rocket2").hover(function() {
    	$("#rocket2details").animate({opacity: 1.0}, 200, function() {
        	$("#rocket2details").css('pointer-events', 'auto');
        });
    }, function() {
    	$("#rocket2details").animate({opacity: 0.0}, 200, function() {
        	$("#rocket2details").css('pointer-events', 'none');
        });
    });
    
    $("#rocket3").hover(function() {
    	$("#rocket3details").animate({opacity: 1.0}, 200, function() {
        	$("#rocket3details").css('pointer-events', 'auto');
        });
    }, function() {
    	$("#rocket3details").animate({opacity: 0.0}, 200, function() {
        	$("#rocket3details").css('pointer-events', 'none');
        });
    });
   

	//$('#checkboxrocket1').prop('checked', true);
    
    
    $(document).ready(function() {
    	//jQuery style button handling... may change this to avoid jQuery CSS injection.
    	
        $('#playtoggle').bind("click", function() {
          if ($(this).attr("class") == "play") {
             $(this).attr("class", "pause");
 			popcornMedia[popcornSequenceNumber].play();
 			//basepop.play();
 			$("#speedSlider").slider('value',previousSliderVal);
          } else {
             $(this).attr("class", "play");
 			popcornMedia[popcornSequenceNumber].pause();
 			//basepop.pause();
 			previousSliderVal = savedSliderVal;
 			$("#speedSlider").slider('value',0);
          }
        });
        
        
        /*$( "#slider" ).slider( { 
			animate: true,
			range: "min",
			value: 50,
			min: 10,
			max: 100,
			step: 1,

		});*/

		$( "#replaybutton" )
			.button()
			.click(function( event ) {
			replayUser();
		    cancelCallToAction=true;
		    //callToActionTimeout[userLessonNumber] = setTimeout(function(){callToActionUser()},10000);

		});
		
		$( "#scientistclosebutton" )
			.button()
			.click(function( event ) {
	
				$("#scientisthelppopup").animate({opacity: 0.0}, 1, function() { $("#scientisthelppopup").css('pointer-events', 'none'); });
	
		});
		
		$( "#scientisttrybutton" )
			.button()
			.click(function( event ) {

				document.getElementById( "landingdatepicker" ).value = "";
				landingDate = null;
				$("#launchdatepicker").css('background-color', '#rgba(74,128,74,1.0)');
				setTimeout(function(){
					$("#landingdatepicker").css('background-color', 'rgba(128,74,74,1.0)');
				},500);
				setTimeout(function(){
					$("#landingdatepicker").css('background-color', 'rgba(51,111,139,1.0)');
				},1000);
				setTimeout(function(){
					$("#landingdatepicker").css('background-color', 'rgba(128,74,74,1.0)');
				},1500);
				setTimeout(function(){
					$("#landingdatepicker").css('background-color', 'rgba(51,111,139,1.0)');
				},2000);
				setTimeout(function(){
					$("#landingdatepicker").css('background-color', 'rgba(128,74,74,1.0)');
				},2500);
				setTimeout(function(){
					$("#landingdatepicker").css('background-color', 'rgba(128,74,74,1.0)');
					$("#landingdatepicker").css('background-color', 'rgba(51,111,139,1.0)');
					$("#launchdatepicker").css('background-color', 'rgba(51,111,139,1.0)');
				},2500);

				$("#landingdatepicker").datepicker("show");

				//document.getElementById( "landingdatepicker" ).value = document.getElementById( "orbitdate" ).value;
				//landingDate = new Date(Date.parse(document.getElementById( "orbitdate" ).value));
				//if(launchDate)monthDifference = landingDate - launchDate;
				var tryDate = "10/01/2037";
				launchDate = new Date(Date.parse(tryDate));
				document.getElementById( "launchdatepicker" ).value = tryDate;
				launchRewindDate = new Date(Date.parse(tryDate));
				launchRewindDate.setDate(launchRewindDate.getDate()-5);
				var jumpToDate = new Date(Date.parse(tryDate)).Date2Julian();
				timer.JD = jumpToDate;
				clear3DDrawings();
				$("#scientisthelppopup").animate({opacity: 0.0}, 1, function() { $("#scientisthelppopup").css('pointer-events', 'none'); });

	
		});
		
		$( "#threedhomebutton" )
			.button()
			.click(function( event ) {

		       	//camTweener( { x: 100, y: 400, z: 250 }, { x: 0, y: 0, z: -20 }, 1500 );
		       	camTweener( { x: -400, y: 400, z: 500 }, { x: 0, y: 0, z: -20 }, 3000 );

				checkForFourthCameraLesson();
		       	/*
				camNextPosition	= {
						x: -100, 
						y: 400, 
						z: -250 
					};

					camNextTarget = {
						x: 0,
						y: 0,
						z: 0
					};

					TWEEN.removeAll();
					camTweener( camNextPosition, camNextTarget, 1500 );
					checkForFourthCameraLesson();
					*/
		});	

		$( "#threedcam2button" )
			.button()
			.click(function( event ) {

				camNextPosition	= {
					x: 0, 
					y: 1000, 
					z: 5000 
				};

				camNextTarget = {
					x: 0,
					y: 0,
					z: 0
				};

				//TWEEN.removeAll();
				camTweener( { x: 0, y: 1100, z: 0 }, { x: 0, y: 0, z: -20 }, 1500 );
				//checkForFourthCameraLesson();
		});

		$( "#threedearthbutton" )
			.button()
			.click(function( event ) {

				var posFromMatrix = new THREE.Vector3();
				posFromMatrix.getPositionFromMatrix( ss[3].matrixWorld );
				camTweener( { x: 50, y: 50, z: 250 }, posFromMatrix, 1500 );
				checkForFourthCameraLesson();
				
		});

		$( "#threedmarsbutton" )
			.button()
			.click(function( event ) {
				
				var posFromMatrix = new THREE.Vector3();
				posFromMatrix.getPositionFromMatrix( ss[4].matrixWorld );
				camTweener( { x: 75, y: 50, z: 300 }, posFromMatrix, 1500 );
				
				finishFourthCameraLesson();
		});
		
		$( "#speedSlider" ).slider( {
			animate: true,
			range: "min",
			value: .23,
			min: -2,
			max: 2,
			step: .010,
			change: function() {
				var newSliderVal = $( "#speedSlider" ).slider( "option", "value" );
				
				if(lessonOpen) {

					if(userLessonNumber==4) {
						if(newSliderVal>0) {
							audioLock=false;
							advanceUser();
						} else {
							jumpPopcornMedia(19);
							if(audioLock==false) {
								setTimeout(function(){
									audioLock=false;
								},5000);
							}
							audioLock=true;
						}
					} else if(userLessonNumber==5) {
						if(newSliderVal<0) {
							audioLock=false;
							advanceUser();
						} else {
							jumpPopcornMedia(22);
							if(audioLock==false) {
								setTimeout(function(){
									audioLock=false;
								},5000);
							}
							audioLock=true;
						}
					}
				}
				
				savedSliderVal = newSliderVal;
				if(savedSliderVal==0) {
					//if 0, stop immediately
					Tweener(timer, {multiplier:savedSliderVal}, 1);
				} else {
					Tweener(timer, {multiplier:savedSliderVal}, 300);
				}
			}
		});

		$( "#menubutton" )
			.button()
			.click(function( event ) {
	  			$("#quicklaunchpopup").animate({opacity: 0.0}, 1, function() { $("#quicklaunchpopup").css('pointer-events', 'none'); });
    			
				if($('#menupanel').css('opacity') != 0) {
	            	closeMenuPanel();
	        	} else {
	        		openMenuPanel();
	        	}
		});
		
		
		$( "#nextbutton" )
			.button()
			.click(function( event ) { 
	  			$("#quicklaunchpopup").animate({opacity: 0.0}, 1, function() { $("#quicklaunchpopup").css('pointer-events', 'none'); });
    			
				if(popcornSequenceNumber<5) {
					jumpToThreeDNavigation();
				} else if(popcornSequenceNumber<17) {
					jumpToChallenge();
				}
		});
		
		$( "#ignorebutton" )
			.button()
			.click(function( event ) {
				closeAllSubMenus();
		});
		
		$( "#relaycmebutton" )
			.button()
			.click(function( event ) {
				setTimeout(function() {
					jumpPopcornMedia(38);
				}, 1000);
		});
		
		
		
		$( "#answerbutton" )
			.button()
			.click(function( event ) {
				jumpToChallenge();
		});
		
		var jumpToIntroduction = function() {
			//hide everything
			hideeverything();
			$("#startmenupanel").animate({opacity: 0.0}, 1, function() { $("#startmenupanel").css('pointer-events', 'none'); });
			//reset launch controls
			$("#launchcontrols").animate({opacity: 0.0}, 200, function() {
            	$("#launchcontrols").css('pointer-events', 'none');
                
        	});
			$("#launchdiv").animate({opacity: 0.0}, 200, function() {
            	$("#launchdiv").css('pointer-events', 'none');
        	});
	        $("#launchcommitdiv").animate({opacity: 0.0}, 200, function() {
	        	$("#launchcommitdiv").css('pointer-events', 'none');
	    	});
	        if(threedinitialized) {
				camTweener( { x: 10, y: 30, z: 90 }, { x: 0, y: 0, z: 0 }, 1500 );
	        }
			//shift 3d model
			initializethreed();
			//set scale
	    	Tweener(ssScale, {sunScale:.00001}, 1);
	    	Tweener(ssScale, {planetScale:.001}, 1);
	    	Tweener(ssScale, {s:.000001}, 1);
			//clear 3d lines
			clear3DDrawings();
			//reinitialize curiosity launch drawing
			clearInterval(checktouchdown);
			clearInterval(checklaunchtouchdown);
			departure_time = new Time( { Yr:2011, Mon:11, D:26, Hr:1, Mn:1, S:1 } );
			arrival_time = new Time( { Yr:2012, Mon:8, D:6, Hr:1, Mn:1, S:1 } );
			trajectory = null;
	    	trajectory = new Trajectory();
			trajectory.init( departure_time, arrival_time, function () {
			    console.log("heard the done drawing callback");
			    $("#speedSlider").slider('value',.23);
			});
			//reset mouse tracking lesson
			resetLesson();
			//remove the ruler
			showDistance = false;
			scene.remove(ruler);
			//hide planet labels
			ss[3].label.hide();
			ss[4].label.hide();
			
			$("#playbuttonwrapper").animate({opacity: 1.0}, 200, function() {
            	$("#playbuttonwrapper").css('pointer-events', 'auto');
        	});

			//var jumpToDate = new Date(2003,4,6).Date2Julian();//a bit later than launch button
			var jumpToDate = new Date(2009,10,1).Date2Julian();//a bit later than launch button
			timer.JD = jumpToDate;
			$("#speedSlider").slider('value',.01);
			
			jumpPopcornMedia(1);
			
		}
		
		var jumpToThreeDNavigation = function() {
			//hide everything
			hideeverything();
			$("#startmenupanel").animate({opacity: 0.0}, 1, function() { $("#startmenupanel").css('pointer-events', 'none'); });
			
			//hide background
	    	$("#backgroundtarget").animate({opacity: 0.0}, 100, function() {
	           	$("#backgroundtarget").css('pointer-events', 'none');
	       	});
			//reset launch controls
			$("#launchcontrols").animate({opacity: 0.0}, 200, function() {
            	$("#launchcontrols").css('pointer-events', 'none');
                
        	});
			$("#launchdiv").animate({opacity: 0.0}, 200, function() {
            	$("#launchdiv").css('pointer-events', 'none');
        	});
	        $("#launchcommitdiv").animate({opacity: 0.0}, 200, function() {
	        	$("#launchcommitdiv").css('pointer-events', 'none');
	    	});
	    	//initialize 3d if you need to
			initializethreed();
			//clear 3d lines
			clear3DDrawings();
			//reset mouse tracking lesson
			resetLesson();
			//clear touchdown timer
			clearInterval(checktouchdown);
			clearInterval(checklaunchtouchdown);
			//remove the ruler
			showDistance = false;
			scene.remove(ruler);
			//show planet labels
			ss[3].label.show();
			ss[4].label.show();
			
			setTimeout(function(){
				//shift 3d model
				camTweener( { x: 0, y: 100, z: 500 }, { x: 0, y: 0, z: -20 }, 1500 );

		    	$("#backgroundtarget").animate({opacity: 0.0}, 100, function() {
		           	$("#backgroundtarget").css('pointer-events', 'none');
		       	});
		    	
				$("#nextbuttonwrapper").animate({opacity: 1.0}, 200, function() {
		        	$("#nextbuttonwrapper").css('pointer-events', 'auto');
		    	});

				$("#playbuttonwrapper").animate({opacity: 1.0}, 200, function() {
	            	$("#playbuttonwrapper").css('pointer-events', 'auto');
	        	});
			},1000);
			
			var jumpToDate = new Date().Date2Julian();
			timer.JD = jumpToDate;
			$("#speedSlider").slider('value',.02);
			
			jumpPopcornMedia(6);
		}
		
		var jumpToChallenge = function () {
			//hide everything
			hideeverything();
			$("#startmenupanel").animate({opacity: 0.0}, 1, function() { $("#startmenupanel").css('pointer-events', 'none'); });
			//hide backgorund target
	    	$("#backgroundtarget").animate({opacity: 0.0}, 100, function() {
	           	$("#backgroundtarget").css('pointer-events', 'none');
	       	});
			//reset launch controls
			$("#launchcontrols").animate({opacity: 0.0}, 200, function() {
            	$("#launchcontrols").css('pointer-events', 'none');
                
        	});
			$("#launchdiv").animate({opacity: 0.0}, 200, function() {
            	$("#launchdiv").css('pointer-events', 'none');
        	});
	        $("#launchcommitdiv").animate({opacity: 0.0}, 200, function() {
	        	$("#launchcommitdiv").css('pointer-events', 'none');
	    	});
	    	//initialize 3d if you need to
			initializethreed();
			//clear 3d lines
			clear3DDrawings();
			//reset mouse tracking lesson
			resetLesson();
			//clear touchdown timer
			clearInterval(checktouchdown);
			clearInterval(checklaunchtouchdown);
			//remove the ruler
			showDistance = false;
			scene.remove(ruler);
			//show planet labels
			ss[3].label.show();
			ss[4].label.show();
			//show stuff needed
			setTimeout(function(){
				//shift 3d model
				camTweener( { x: 0, y: 1100, z: 0 }, { x: 0, y: 0, z: -20 }, 3000 );
				//$("#selectmissionrocket").animate({opacity: 1.0}, 200, function() {
	            //	$("#selectmissionrocket").css('pointer-events', 'auto');
	        	//});
		        
				$("#helpbuttonwrapper").animate({opacity: 1.0}, 200, function() { 
					$("#helpbuttonwrapper").css('pointer-events', 'auto'); 
				});
				$("#threedcontrols").animate({opacity: 1.0}, 200, function() {
	            	$("#threedcontrols").css('pointer-events', 'auto');
	        	});
				$("#playbuttonwrapper").animate({opacity: 1.0}, 200, function() {
	            	$("#playbuttonwrapper").css('pointer-events', 'auto');
	        	});
				
			},2000);
			
			var jumpToDate = new Date(2036,0,1).Date2Julian();
			timer.JD = jumpToDate;
			$("#speedSlider").slider('value',.01);
			
			jumpPopcornMedia(24,6);
		}
		$( "#threedhelpbutton" )
			.button()
			.click(function( event ) {
	  			$("#quicklaunchpopup").animate({opacity: 0.0}, 1, function() { $("#quicklaunchpopup").css('pointer-events', 'none'); });
				if(popcornSequenceNumber>=24) {
					$("#launchhelppopup").animate({opacity: 1.0}, 200, function() {
	                	$("#launchhelppopup").css('pointer-events', 'auto');
	            	});
				} else {
					$("#threedhelppopup").animate({opacity: 1.0}, 200, function() {
	                	$("#threedhelppopup").css('pointer-events', 'auto');
	            	});
				}
		});
		
		$( "#introduction" )
			.button()
			.click(function( event ) {
				if(!isGoodBrowser || ! Detector.webgl) {
					$("#startmenupanel").animate({opacity: 0.0}, 200, function() {
					  	$("#startmenupanel").css('pointer-events', 'none');
					});
					$("#browserpopup").animate({opacity: 1.0}, 200, function() {
					  	$("#browserpopup").css('pointer-events', 'auto');
					});
				 } else {
						jumpToIntroduction();
				 }
		});
		
		$( "#navigation" )
			.button()
			.click(function( event ) {
				if(!isGoodBrowser || ! Detector.webgl) {
					$("#startmenupanel").animate({opacity: 0.0}, 200, function() {
					  	$("#startmenupanel").css('pointer-events', 'none');
					});
					$("#browserpopup").animate({opacity: 1.0}, 200, function() {
					  	$("#browserpopup").css('pointer-events', 'auto');
					});
				 } else {
						jumpToThreeDNavigation();
				 }
		});
		
		$( "#challenge" )
			.button()
			.click(function( event ) {
				if(!isGoodBrowser || ! Detector.webgl) {
					$("#startmenupanel").animate({opacity: 0.0}, 200, function() {
					  	$("#startmenupanel").css('pointer-events', 'none');
					});
					$("#browserpopup").animate({opacity: 1.0}, 200, function() {
					  	$("#browserpopup").css('pointer-events', 'auto');
					});
				 } else {
						jumpToChallenge();
				 }
		});
		
		$( "#about" )
			.button()
			.click(function( event ) {
		    	closeAllSubMenus();
				$("#aboutpopup").animate({opacity: 1.0}, 200, function() {
                	$("#aboutpopup").css('pointer-events', 'auto');
            	});
		});
		
		$( "#help" )
			.button()
			.click(function( event ) {
		    	closeAllSubMenus();
				$("#helppopup").animate({opacity: 1.0}, 200, function() {
                	$("#helppopup").css('pointer-events', 'auto');
            	});
		});
		
		$( "#beginbutton" )
			.button()
			.click(function( event ) {

				$("#startmenupanel").animate({opacity: 0.0}, 200, function() {
                	$("#startmenupanel").css('pointer-events', 'none');
            	});
				$("#beginbutton").css('pointer-events', 'none');

				if(!isGoodBrowser || ! Detector.webgl) {
					$("#browserpopup").animate({opacity: 1.0}, 200, function() {
					  	$("#browserpopup").css('pointer-events', 'auto');
					});
				 } else {
					basepop.play( 0 );
					$("#playbuttonwrapper").animate({opacity: 1.0}, 200, function() {
	                	$("#playbuttonwrapper").css('pointer-events', 'auto');
	            	});
	                	
				 }
		});
		

		
		var rocketDeltas = new Array(22.3, 21.1, 25.2);
		var checktouchdown;
		var checklaunchtouchdown;
		$( "#runbutton" )
			.button()
			.click(function( event ) {
				$("#quicklaunchpopup").animate({opacity: 0.0}, 1, function() { $("#quicklaunchpopup").css('pointer-events', 'none'); });
				if(!launchDate || !landingDate) {
					document.getElementById("baddatesheadertext").innerHTML="INVALID DATES";
			   		document.getElementById("baddatestext").innerHTML="Make sure dates are entered and the launch date is before the land date.";
					$("#baddatespopup").animate({opacity: 1.0}, 200, function() {
	                	$("#baddatespopup").css('pointer-events', 'auto');
	            	});
				} else if (landingDate<launchDate) {
					document.getElementById("baddatesheadertext").innerHTML="INVALID DATES";
			   		document.getElementById("baddatestext").innerHTML="Make sure dates are entered and the launch date is before the land date.";
					$("#baddatespopup").animate({opacity: 1.0}, 200, function() {
	                	$("#baddatespopup").css('pointer-events', 'auto');
	            	});
				} else if (landingDate>launchDate) {
					//erase line if necessary
					clear3DDrawings();
					
	    			var jumpToDate = new Date(launchRewindDate).Date2Julian();
	    			timer.JD = jumpToDate;
					
					var departure_time = new Time( dateToTime(launchDate) );
					var arrival_time = new Time( dateToTime(landingDate) );
					
			    	//var aDate = new Number(timer.JD).Julian2Date();
			    	//var jd = new Number(departure_time.jd_tt()).Julian2Date();
			    	
			    	try {
				    	trajectory = null;
				    	trajectory = new Trajectory();

						trajectory.init( departure_time, arrival_time, function () {
						    console.log("slow down insano speed");
						    $("#speedSlider").slider('value',.13);
						    //the callback doesn't alway work, so we're going with Ryan's touchdown method below
				
						  	//safety if touchdown is missed.
						    setTimeout(function() {
						    	if(!touchdown(trajectory)) {
								    console.log("touchdown safety catch called: " + touchdown(trajectory));
								    if(checktouchdown)clearInterval(checktouchdown);
									if(checklaunchtouchdown)clearInterval(checklaunchtouchdown);
									playTrajectoryAudio();
						    	}
							},200);
						});		

						//since the callback doesn't always work.  lets try this method 
						//kick off the check interval function after a timeout delay of just over 1 second.
						setTimeout(function() {
							checktouchdown = setInterval(function () {
							    if(touchdown(trajectory)) {
								    console.log("got touchdown: " + touchdown(trajectory));
								    if(checktouchdown)clearInterval(checktouchdown);
									if(checklaunchtouchdown)clearInterval(checklaunchtouchdown);
							    	playTrajectoryAudio();
							    }
							},500);
						},1200);
						
						
						setDeltaV(trajectory.totalDeltaV);

						$("#speedSlider").slider('value',1.5);
			    	} catch(err) {
			    	  	console.log("got me an exception: " + err.message);
						document.getElementById("baddatesheadertext").innerHTML="LAMBERT’S PROBLEM ERROR";
				   		document.getElementById("baddatestext").innerHTML="Transfer is not possible with these dates. Try other launch and land dates.";
				   		//document.getElementById("baddatestext").innerHTML="Error: [" + err.message + "]<br> Please enter new dates other than these.";
						$("#baddatespopup").animate({opacity: 1.0}, 200, function() {
		                	$("#baddatespopup").css('pointer-events', 'auto');
		            	});
			    	}			
					
				}
		});
		
		$( "#launchcommitbutton" )
			.button()
			.click(function( event ) {
				$("#quicklaunchpopup").animate({opacity: 0.0}, 1, function() { $("#quicklaunchpopup").css('pointer-events', 'none'); });
				if(!launchDate || !landingDate) {
			   		document.getElementById("baddatestext").innerHTML="You have entered incorrect dates.  Please ensure that you have entered two dates and your launch date is before your landing date.";
					$("#baddatespopup").animate({opacity: 1.0}, 200, function() {
	                	$("#baddatespopup").css('pointer-events', 'auto');
	            	});
				} else if (landingDate<launchDate) {
			   		document.getElementById("baddatestext").innerHTML="You have entered incorrect dates.  Please ensure that you have entered two dates and your launch date is before your landing date.";
					$("#baddatespopup").animate({opacity: 1.0}, 200, function() {
	                	$("#baddatespopup").css('pointer-events', 'auto');
	            	});
				} else if (landingDate>launchDate) {
	
					//$("#launchcontrols").animate({opacity: 0.0}, 200, function() {
	                	//$("#launchcontrols").css('pointer-events', 'none');
	            	//});
					
					$("#launchdiv").animate({opacity: 0.0}, 200, function() {
	                	$("#launchdiv").css('pointer-events', 'none');
	            	});
					
					$("#launchcommitdiv").animate({opacity: 0.0}, 200, function() {
	                	$("#launchcommitdiv").css('pointer-events', 'none');
	            	});
					
	
					clear3DDrawings();
					
	    			var jumpToDate = new Date(launchRewindDate).Date2Julian();
	    			timer.JD = jumpToDate;
					
					var departure_time = new Time( dateToTime(launchDate) );
					var arrival_time = new Time( dateToTime(landingDate) );
					
			    	//var aDate = new Number(timer.JD).Julian2Date();
			    	//var jd = new Number(departure_time.jd_tt()).Julian2Date();
					
					try {
						trajectory = null;
				    	trajectory = new Trajectory();
						trajectory.init( departure_time, arrival_time, function () {
							//once drawing is done for launch, then we're done with the second lesson
						    console.log("slow down insano speed");
						    $("#speedSlider").slider('value',.13);
						    
							//safety if touchdown is missed.
						    setTimeout(function() {
						    	if(!touchdown(trajectory)) {
								    console.log("touchdown safety catch called");
								    if(checktouchdown)clearInterval(checktouchdown);
									if(checklaunchtouchdown)clearInterval(checklaunchtouchdown);
							    	playFullLaunchAudio();
						    	}
							},200);
						    
						});
						
						
						setTimeout(function() {
							checklaunchtouchdown = setInterval(function () {
							    if(touchdown(trajectory)) {
								    console.log("got a touchdown");
								    if(checktouchdown)clearInterval(checktouchdown);
									if(checklaunchtouchdown)clearInterval(checklaunchtouchdown);
							    	playFullLaunchAudio();
							    }
							},500);
						},1200);
						
						
						//show a CME 4 seconds in
						setTimeout(function() {
							$("#cmemessage").animate({opacity: 1.0}, 200, function() {
						    	$("#cmemessage").css('pointer-events', 'auto');
						    });
							
							//hide CME message after another 4 seconds
							setTimeout(function() {

								$("#cmemessage").animate({opacity: 0.0}, 200, function() {
							    	$("#cmemessage").css('pointer-events', 'none');
							    });
								
							},4000);
							
							
						},4000);
						
						setDeltaV(trajectory.totalDeltaV);
		
						$("#speedSlider").slider('value',.12);
			    	} catch(err) {
				   		document.getElementById("baddatestext").innerHTML="Error: [" + err.message + "]<br> Please enter new dates other than these.";
						$("#baddatespopup").animate({opacity: 1.0}, 200, function() {
		                	$("#baddatespopup").css('pointer-events', 'auto');
		            	});
			    	}
				}
		});

		//set text field to rocket launch deltaV for user to see.
		var setDeltaV = function (dNum) {
			document.getElementById( "deltavtext" ).value = dNum.toFixed(2);
		}
		
		var runAttemptCount=0;
		
		var playTrajectoryAudio = function() {
			console.log("playTrajectoryAudio");
			runAttemptCount++;
			console.log("rocketChoice: " + rocketChoice);
			console.log("launchPlanetDistance: " + launchPlanetDistance);
			console.log("monthDifference: " + monthDifference);
			var MaxPlanetDistance = 160;
			var MinTravelDifference = 13129200000;
			var MaxTravelDifference = 21078000000;
			var isBadTravelTime = (monthDifference<13129200000 || monthDifference>MaxTravelDifference);
			var deltaVDif;
			switch(rocketChoice)
	    	{
	    	case 0:
	    		//check to see if deltaV is under minimum for this rocket
	    		deltaVDif = rocketDeltas[rocketChoice] - trajectory.totalDeltaV;
				console.log("deltaVDif: " + deltaVDif);
				
				//var launchPlanetDistance = 0; // greater 140 is too far  
				//var monthDifference = 0; //6 mo - 13129200000 9 mo - 21078000000
				if(deltaVDif<=0 && runAttemptCount>=3) {
					//show the scientist help
					runAttemptCount=0;
					$("#scientisthelppopup").animate({opacity: 1.0}, 200, function() { $("#scientisthelppopup").css('pointer-events', 'auto'); });
				}
				
				if(deltaVDif>=0) {
					jumpPopcornMedia(28); //landed
				} else if(launchPlanetDistance>MaxPlanetDistance && !isBadTravelTime) {
					jumpPopcornMedia(29); //move launch date closer distance
				} else if(launchPlanetDistance<MaxPlanetDistance && isBadTravelTime) {
					jumpPopcornMedia(30); //make sure launch dates 6-9 months
				} else if(launchPlanetDistance>MaxPlanetDistance && isBadTravelTime) {
					jumpPopcornMedia(31); //move launch date closer distance AND make sure launch dates 6-9 months
				} else {
					jumpPopcornMedia(32); //Very close, tweak
				}
	    	  break;
	    	case 1:
	    		deltaVDif = rocketDeltas[rocketChoice] - trajectory.totalDeltaV;
				console.log("deltaVDif: " + deltaVDif);
				
				if(deltaVDif<=0 && runAttemptCount>=3) {
					//show the scientist help
					runAttemptCount=0;
					$("#scientisthelppopup").animate({opacity: 1.0}, 200, function() { $("#scientisthelppopup").css('pointer-events', 'auto'); });
				}
				
				if(deltaVDif>=0) {
					jumpPopcornMedia(28); //landed
				} else if(launchPlanetDistance>MaxPlanetDistance && !isBadTravelTime) {
					jumpPopcornMedia(29); //move launch date closer distance
				} else if(launchPlanetDistance<MaxPlanetDistance && isBadTravelTime) {
					jumpPopcornMedia(30); //make sure launch dates 6-9 months
				} else if(launchPlanetDistance>MaxPlanetDistance && isBadTravelTime) {
					jumpPopcornMedia(31); //move launch date closer distance AND make sure launch dates 6-9 months
				} else {
					jumpPopcornMedia(32); //Very close, tweak
				}
	    	  break;
	    	case 2:
	    		deltaVDif = rocketDeltas[rocketChoice] - trajectory.totalDeltaV;
				console.log("deltaVDif: " + deltaVDif);
				
				if(deltaVDif<=0 && runAttemptCount>=3) {
					//show the scientist help
					runAttemptCount=0;
					$("#scientisthelppopup").animate({opacity: 1.0}, 200, function() { $("#scientisthelppopup").css('pointer-events', 'auto'); });
				}
				
				if(deltaVDif>=0) {
					jumpPopcornMedia(28); //landed
				} else if(launchPlanetDistance>MaxPlanetDistance && !isBadTravelTime) {
					jumpPopcornMedia(29); //move launch date closer distance
				} else if(launchPlanetDistance<MaxPlanetDistance && isBadTravelTime) {
					jumpPopcornMedia(30); //make sure launch dates 6-9 months
				} else if(launchPlanetDistance>MaxPlanetDistance && isBadTravelTime) {
					jumpPopcornMedia(31); //move launch date closer distance AND make sure launch dates 6-9 months
				} else {
					jumpPopcornMedia(32); //Very close, tweak
				}
	    	  break;
	    	default:
	    		jumpPopcornMedia(32); //Very close, tweak
		    	break;
	    	}
		}
		
		var playFullLaunchAudio = function() {
			console.log("playFullLaunchAudio");
			console.log("rocketChoice: " + rocketChoice);
			var deltaVDif;
			switch(rocketChoice)
	    	{
	    	case 0:
	    		//check to see if deltaV is under minimum for this rocket
	    		deltaVDif = rocketDeltas[rocketChoice] - trajectory.totalDeltaV;
				console.log("deltaVDif: " + deltaVDif);
				
				if(deltaVDif>=0) {
					jumpPopcornMedia(33); //landed
				} else if(deltaVDif>=-4.8) {
					jumpPopcornMedia(34); //bad
					showLaunchControls();
				} else if(deltaVDif>=-6.3) {
					jumpPopcornMedia(35); //worse
					showLaunchControls();
				} else if(deltaVDif>=-7.0) {
					jumpPopcornMedia(36); //even worse
					showLaunchControls();
				} else {
					jumpPopcornMedia(37); //just aweful
					showLaunchControls();
				}
	    	  break;
	    	case 1:
	    		deltaVDif = rocketDeltas[rocketChoice] - trajectory.totalDeltaV;
				console.log("deltaVDif: " + deltaVDif);
				
				if(deltaVDif>=0) {
					jumpPopcornMedia(33); //landed
				} else if(deltaVDif>=-4.8) {
					jumpPopcornMedia(34); //bad
					showLaunchControls();
				} else if(deltaVDif>=-6.3) {
					jumpPopcornMedia(35); //worse
					showLaunchControls();
				} else if(deltaVDif>=-7.0) {
					jumpPopcornMedia(36); //even worse
					showLaunchControls();
				} else {
					jumpPopcornMedia(37); //just aweful
					showLaunchControls();
				}
	    	  break;
	    	case 2:
	    		deltaVDif = rocketDeltas[rocketChoice] - trajectory.totalDeltaV;
				console.log("deltaVDif: " + deltaVDif);
				
				if(deltaVDif>=0) {
					jumpPopcornMedia(33); //landed
				} else if(deltaVDif>=-4.8) {
					jumpPopcornMedia(34); //bad
					showLaunchControls();
				} else if(deltaVDif>=-6.3) {
					jumpPopcornMedia(35); //worse
					showLaunchControls();
				} else if(deltaVDif>=-7.0) {
					jumpPopcornMedia(36); //even worse
					showLaunchControls();
				} else {
					jumpPopcornMedia(37); //just aweful
					showLaunchControls();
				}
	    	  break;
	    	default:
	    		jumpPopcornMedia(37); //just aweful
				showLaunchControls();
		    	break;
	    	}
		}
		
		var showLaunchControls = function() {
			$("#launchcontrols").animate({opacity: 1.0}, 200, function() {
            	$("#launchcontrols").css('pointer-events', 'auto');
        	});
			
			$("#launchdiv").animate({opacity: 1.0}, 200, function() {
            	$("#launchdiv").css('pointer-events', 'auto');
        	});
			
			$("#launchcommitdiv").animate({opacity: 1.0}, 200, function() {
            	$("#launchcommitdiv").css('pointer-events', 'auto');
        	});
		}
		
		//we've got simple date formatting needs, so this will be sufficient for our project.
		var dateFormatter = function(aDate) {
			//no idea why date is 1 day off.
			aDate.setDate(aDate.getDate()+1);
			
			var mm = aDate.getMonth() + 1;
			if(mm<10)mm = "0" + mm;
		    var dd = aDate.getDate();
			if(dd<10)dd = "0" + dd;
		    var yyyy = aDate.getFullYear();
		    var formattedDate = mm + '/' + dd + '/' + yyyy;
		    return formattedDate;
		};
		
		//change a date to a time object (helps for Time initializer)
		var dateToTime = function(aDate) {
			return aLaunchTime = {
					Yr: aDate.getFullYear(),
					Mon: aDate.getMonth()+1,
					D: aDate.getDate(),
					Hr: 1,
					Mn: 1,
					S: 1
					};
		};
		
		$(function() {
		    $( "#launchdatepicker" ).datepicker({
		      changeMonth: true,
		      changeYear: true,
		      minDate: new Date(2036, 0, 1),
		      maxDate: new Date(2039, 11, 5),
		      onSelect: function(dateText, inst) { 
		  			$("#quicklaunchpopup").animate({opacity: 0.0}, 1, function() { $("#quicklaunchpopup").css('pointer-events', 'none'); });
		    	  	launchPlanetDistance = ruler.getDistance();
	    			launchDate = new Date(Date.parse(dateText));
	    			monthDifference = landingDate - launchDate;
	    			launchRewindDate = new Date(Date.parse(dateText));
	    			launchRewindDate.setDate(launchRewindDate.getDate()-5);
	    			if(timer) {
	    				$("#speedSlider").slider('value',0);
		    			var jumpToDate = new Date(Date.parse(dateText)).Date2Julian();
		    			timer.JD = jumpToDate;
	    			}
	    			clear3DDrawings();
	    			//console.log("jumpToDate: " +  dateFormatter(jumpToDate));
	    		}
		    });
		});
		
		$(function() {
		    $( "#landingdatepicker" ).datepicker({
		      changeMonth: true,
		      changeYear: true,
		      minDate: new Date(2036, 0, 1),
		      maxDate: new Date(2039, 11, 5),
		      onSelect: function(dateText, inst) { 
		  			$("#quicklaunchpopup").animate({opacity: 0.0}, 1, function() { $("#quicklaunchpopup").css('pointer-events', 'none'); });
	    			landingDate = new Date(Date.parse(dateText));
	    			monthDifference = landingDate - launchDate;
	    			if(timer) {
		    			$("#speedSlider").slider('value',0);
		    			var jumpToDate = new Date(Date.parse(dateText)).Date2Julian();
		    			timer.JD = jumpToDate;
	    			}
	    			clear3DDrawings();
	    			//console.log("jumpToDate: " +  dateFormatter(jumpToDate));
	    		}
		    });
		});
		
		//this timer queries the timer object (orbit timer) to figure out what the date is 
		//and then sets the datepicker element every 100 ms.
		setInterval(function() { 
			if(timer) {
				var aDate = new Number(timer.JD).Julian2Date();
				document.getElementById( "orbitdate" ).value = dateFormatter(aDate);
				document.getElementById( "speeddate" ).innerHTML = dateFormatter(aDate);
				
				//put the breaks on the orbit if we get close to the min and max dates of the ephemeris
				if(aDate>MAX_EPHEMERIS_DATE) {
					//set slider to 0
					$("#speedSlider").slider('value',0);
					var setbackdate = new Date(MAX_EPHEMERIS_DATE);
					setbackdate.setDate(setbackdate.getDate() - 5);
					
					timer.JD = new Date(setbackdate).Date2Julian();
				}
				if(aDate<MIN_EPHEMERIS_DATE) {
					//set slider to 0
					$("#speedSlider").slider('value',0);
					var setbackdate = new Date(MIN_EPHEMERIS_DATE);
					setbackdate.setDate(setbackdate.getDate() + 5);
					
					timer.JD = new Date(setbackdate).Date2Julian();
				}
			}
		}, 100);
		
		
		
      });
    
    
	//from main.js
	if ( ! Detector.webgl ) Detector.addGetWebGLMessage();
	 
	navigator.sayswho= (function(){
	    var N= navigator.appName, ua= navigator.userAgent, tem;
	    var M= ua.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);
	    if(M && (tem= ua.match(/version\/([\.\d]+)/i))!= null) M[2]= tem[1];
	    M= M? [M[1], M[2]]: [N, navigator.appVersion, '-?'];
	
	    return M;
	})();
	 
	//console.log("navigator.sayswho: " + navigator.sayswho[0]);
	var isGoodBrowser = (navigator.sayswho[0]=="Chrome");
	if(!isGoodBrowser) isGoodBrowser = (navigator.sayswho[0]=="Firefox");
	
	$("#startmenupanel").animate({opacity: 1.0}, 200, function() {
	  	$("#startmenupanel").css('pointer-events', 'auto');
	});
	
	if(!isGoodBrowser || ! Detector.webgl) {
		div.removeChild(infinityloader.canvas);
	    $("#loaderdiv").animate({opacity: 0.0}, 500, function() {
	        $("#loaderdiv").css('pointer-events', 'none');
	    });
	    
		$("#beginbutton").animate({opacity: 1.0}, 500, function() {
            $("#beginbutton").css('pointer-events', 'auto');
        });
	} else {
		loader.options.convertUpAxis = true;
		loader.load( './models/galaxy.dae', function ( collada ) {
		
			dae = collada.scene;
			dae.scale.x = dae.scale.y = dae.scale.z = 60000;
			dae.updateMatrix();
		
		} );
		
		loadShaders( shaderList, function (e) {
			shaderList = e;
			postShadersLoaded();
		});
	}


	//$( '#loadtext' ).show();
	//setLoadMessage("Loading the Solar System");
	
	
	
	var postShadersLoaded = function () {
	        //init();
	        //animate();
			$("#loadtext").hide();
	};
      
}, false);

</script>
	</head>
	<body>
		
		<!-- <div id="loaderdiv" style="z-index:20;background-color:#FFFFFF;width:100px;height:100px;opacity:1.0;"></div> -->
		
		<div id="startmenupanel" class="startmenupanel">
			<h1>Mission to Mars</h1>
			<div class="textstyle1">
			Welcome to Slayton's Isle Station - the communication gateway to Mars!  Explore our place in the cosmos, fire 
			off the world's newest rockets, and remote-pilot planetary rovers from NASA's frontier science outpost.
			</div>
			<button id="beginbutton" class="beginbutton" style="opacity: 0.2;pointer-events:none;width:150px;">LAUNCH</button>
			<br>
			<div id="loaderdiv" style="z-index:10;opacity:1.0;pointer-events:auto; width:100%">
				<div id="loaderpanel" class="loadercontenttarget" style="z-index:11;">
					<font style="color:#3a84a6;">Loading the Solar System</font>
					<div id="canvastarget" style="position:absolute;left:-130px;top:-22px"></div>
				</div>
			</div>
			<br>
			<br>
			<br>
			<div class="textstyle2">
			This project is a collaboration between the U.S. Department of Energy, the Mozilla Foundation, and MX.</div>
			<br>
			<img src="./images/tri_logo.png" style="align: center;">
			<br><font style="color: rgba(42,51,24,0.2);">Version:0.9.25</font>
		</div>
		
		<div id="topbar" class="topbar">
		
			<div id="topbarleft" class="topbarleft">
				<div id="headerpanel" class="headerpanel"></div>
			</div>
			<div id="topbarmiddle" class="topbarmiddle">
			</div>
			
			<div id="topbarright" class="topbarright">
			
				<button id="menubutton" class="menubutton">MENU</button>
				<div id="menupanel" class="menupanel">
					<button id="introduction" class="menupanelbutton" style="opacity: 0.2;pointer-events:none;">introduction</button>
					<br>
					<button id="navigation" class="menupanelbutton" style="opacity: 0.2;pointer-events:none;">3d navigation</button>
					<br>
					<button id="challenge" class="menupanelbutton" style="opacity: 0.2;pointer-events:none;">Slayton's Isle</button>
					<br>
					<button id="about" class="menupanelbutton">about</button>
					<br>
					<button id="help" class="menupanelbutton">help</button>
				</div>
			</div>
		</div>	
		<!-- main content area for video, images, 3D, etc... -->
		<div id="contenttarget" class="contenttarget">
		</div>
		<div id="backgroundtarget" class="backgroundtarget">
		</div>
		
		<div id="imagecontenttarget" class="imagecontenttarget">
		</div>
		
		<div id="videointrocontenttarget" class="videointrocontenttarget">
			<video height="100%" width="100%" id="videointro" style="background: #000;" preload="auto">
         		<source src="video/moku_unit1_intro 4_AV.mp4" type="video/mp4">
         		<source src="video/moku_unit1_intro 4_AV.webm" type="video/webm">
         		Please upgrade your browser to view video
       		</video>
		</div>
		
		<div id="videocontenttarget" class="videocontenttarget">
			<video height="100%" width="100%" id="video" style="background: #000;" preload="auto">
         		<source src="video/SEQ1_OCVO_v05_rev_2.mp4" type="video/mp4">
         		<source src="video/SEQ1_OCVO_v05_rev_2.webm" type="video/webm">
         		Please upgrade your browser to view video
       		</video>
       		<div id="subtitlepanel" class="subtitlepanel"></div>
       		<div id="subtitlepanelb" class="subtitlepanelb"></div>
       		<div id=chyronwrapper" class="chyronwrapper"><div id=chyron" class="chyron">Archival Footage 2013</div></div>
		</div>
		
		<div id="bottombar" class="bottombar">
			<div id="bottombarleft" class="bottombarleft">
				<div id="helpbuttonwrapper" class="helpbuttonwrapper" style="opacity: 0.0;pointer-events:none">
					<button id="threedhelpbutton" class="squarebluebutton">HELP</button>
				</div>
				<div id="replaybuttonwrapper" class="replaybuttonwrapper" style="opacity: 0.0;pointer-events:none">
					<button id="replaybutton" class="squarebluebutton">REPLAY</button>
				</div>
			</div>
			<div id="bottombarmiddle" class="bottombarmiddle" style="vertical-align: bottom;align:center">
				<div id="threedcontrols" class="threedcontrols">
					<button id="threedhomebutton" class="squarebluebutton">Home</button>
					<button id="threedcam2button" class="squarebluebutton">Top</button>
					<button id="threedearthbutton" class="squarebluebutton">Earth</button>
					<button id="threedmarsbutton" class="squarebluebutton">Mars</button>
				</div>
			</div>
			
			<div id="bottombarright" class="bottombarright">
			
				<div id="nextbuttonwrapper" class="nextbuttonwrapper" style="opacity: 0.0;pointer-events:none">
					<div id="playbuttonwrapper" class="playbuttonwrapper" style="opacity: 0.0;pointer-events:none">
						<div id="playtoggle" class="pause"></div>
					</div>
					<button id="nextbutton" class="nextbutton">SKIP</button>
				</div>
			</div>
		</div>
		
		<div style="display:none">
			<span id="label_template" class="label">
				<span class="name">
				</span>
			</span>
		</div>
		<div id="loadtext" style="z-index: 6;"></div>
		
		<div id="solarsystembadge" class="modalmask">
			<div id="backpacklogindiv" class="badgecontenttarget">
				<h1>Solar System Navigation Success!</h1>
				<br><br>
				<div style="text-align: center;width:100%">
					<table style="position: absolute; width: 90%;margin:0;padding:0; float:middle;left:8%" >
						<tr >
							<td align="left" valign="top">
								<font style="font-weight:300;">
								Congratulations for completing the solar system 3D interface orientation and earning
								the "Solar System" badge!
								<br><br>
								Upload the badge to save it and share it.  Learn more about the 
								<a href="http://openbadges.org/" target="_blank">Open Badges</a> project.
								</font>
								<br>
								<br>
							</td>
							<td align="right" rowspan="2" valign="top"><img src="../badge-it-gadget-lite/digital-badges/images/moku_badge_solar_system.png" style="width:220px;height:220px"> </td>
							
						</tr>
						<tr>
							<td align="center" valign="top">
								<button id="solarsystembadgeuploadbutton" type="submit" class="squarebigbluebutton">Upload Badge</button>
							</td>
						</tr>
					</table>
				</div>
					
				<br><br><br><br><br><br><br><br><br><br><br><br>
					<div style="float:left;">
						&nbsp;&nbsp;&nbsp;&nbsp;<button id="solarsystembadgeskipbutton" class="squarebluebutton">Skip</button>
					</div>
			</div>
		</div>
		
		<div id="solarsystembadgecomplete" class="modalmask">
			<div id="backpacklogindiv" class="badgecontenttarget">
				<h1>Solar System Navigation Success!</h1>
				<br><br>
				<div style="text-align: center;width:100%">
					<table style="position: absolute; width: 90%;margin:0;padding:0; float:middle;left:8%" >
						<tr >
							<td align="left" valign="top">
								<font style="font-weight:300;">
								There is still plenty more to do!
								<br> 
								<br>
								Select "Continue" to advance to the next mission.  Learn to launch a rocket from Earth
								to Mars. 
								<br>&nbsp;
								<br>&nbsp;
								<br>&nbsp;
								</font>
							
							</td>
							<td align="right" rowspan="2" valign="top"><img src="../badge-it-gadget-lite/digital-badges/images/moku_badge_solar_system.png" style="width:220px;height:220px"> </td>
						</tr>
						<tr>
							<td align="center" valign="top">
								<button id="solarsystembadgecompletecontinuebutton" type="submit" class="squarebigbluebutton">Continue</button>
							</td>
						</tr>
					</table>
				</div>
					
				<br><br><br><br><br><br><br><br><br><br><br><br>
					<div style="float:left;">
						<button id="solarsystembadgecompletereplaybutton" class="squarebluebutton">Replay Mission</button>
						<button id="solarsystembadgecompletereremixbutton" class="squarebluebutton">Remix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</button>
					</div>
			</div>
		</div>
		
		<div id="rocketbadge" class="modalmask">
			<div id="backpacklogindiv" class="badgecontenttarget">
				<h1>Mission Success!</h1>
				<br><br>
				<div style="text-align: center;width:100%">
					<table style="position: absolute; width: 90%;margin:0;padding:0; float:middle;left:8%" >
						<tr >
							<td align="left" valign="top">
								<font style="font-weight:300;">
								Congratulations for completing the Mars transfer mission and earning the 
								"Mission to Mars" badge!
								<br><br>
								Upload the badge to save it and share it.  Learn more about the 
								<a href="http://openbadges.org/" target="_blank">Open Badges</a> project.
								</font>
								<br>
								<br>
							</td>
							<td align="right" rowspan="2" valign="top"><img src="../badge-it-gadget-lite/digital-badges/images/moku_badge_mission_to_mars.png" style="width:220px;height:220px"> </td>
						</tr>
						<tr>
							<td align="center" valign="top">
								<button id="rocketbadgeuploadbutton" type="submit" class="squarebigbluebutton">Upload Badge</button>
							</td>
						</tr>
					</table>
				</div>
					
				<br><br><br><br><br><br><br><br><br><br><br><br>
					<div style="float:left;">
						<button id="rocketbadgeskipbutton" class="squarebluebutton">Skip</button>
					</div>
			</div>
		</div>
		
		<div id="rocketbadgecomplete" class="modalmask">
			<div id="backpacklogindiv" class="badgecontenttarget">
				<h1>Mission to Mars</h1>
				<br><br>
				<div style="text-align: center;width:100%">
					<table style="position: absolute; width: 90%;margin:0;padding:0; float:middle;left:8%" >
						<tr >
							<td align="left" valign="top" style="margin:0;padding-right:3px;">
								<font style="font-weight:300;">
								Nice work!  If you have not already completed the Mission to Mars experience, select 
								"Continue" to expolore the solar system and send a spacecraft to Mars.
								<br> 
								<br>
								Select "Remix" to edit this experience and make it your own.
								<br>&nbsp;
								<br>&nbsp;
								</font>
							
							</td>
							<td align="right" rowspan="2" valign="top"><img src="./images/moku_unit2_icon.jpg" style="border:1px solid rgba(200,200,200,1.0);"> </td>
						</tr>
						<tr>
							<td align="center" valign="top">
								<button id="rocketbadgecompletecontinuebutton" type="submit" class="squarebigbluebutton">Continue</button>
							</td>
						</tr>
					</table>
				</div>
					
				<br><br><br><br><br><br><br><br><br><br><br><br>
					<div style="float:left;">
						<button id="rocketbadgecompletereplaybutton" class="squarebluebutton" style="margin-left:40px;">Replay Mission</button>
						<button id="rocketbadgecompleteremixbutton" class="squarebluebutton">Remix&nbsp;&nbsp;&nbsp;&nbsp;<img src="./images/icon_remix.png" style="position:relative;vertical-align:middle;width:17px;height:17px;opacity:0.8;">&nbsp;</button>
					</div>
			</div>
		</div>
		
		<div id="aboutpopup" class="aboutpopup">
			<h1 style="text-align: center;">About</h1>
			<a href="#" target="_self">Mission to Mars</a>
			<br>
			<a href="./indexRover.html" target="_self">Mars Rover Remote Pilot</a>
			<br><br>
			These experinces were built with <a href="http://popcornjs.org/" target="_blank">Popcorn.js</a> and
			<a href="http://threejs.org/" target="_blank">Three.js</a>. All 3D models are available in 
			<a href="http://threejs.org/" target="_blank">Kuda</a>.  Complete the missions to earn badges as a part
			of the <a href="http://openbadges.org/" target="_blank">Open Badges</a> project. 
			<a href="#" target="_self">Remix</a> the experiences to create your own interactive story.
			<br><br>
			This project is a collaboration between the 
			<a href="http://http://energy.gov/" target="_blank">U.S. Department of Energy</a>, 
			the <a href="http://www.mozilla.org/foundation/" target="_blank">Mozilla Foundation</a>, and 
			<a href="http://mx-mx.com/" target="_blank">MX</a>.
		</div>
		<div id="helppopup" class="helppopup">
			<h1 style="text-align: center;">Help</h1>
			<br>You are on an astronaut stationed on Slaton's Isle, an Aten asteroid in the inner solar system.
			Colonists on Mars have an emergency and need your help.  The Capsule Communicator CAPCOM) on Earth
			is requesting your help because you are closer to Mars and able to respond quickly.  
			Follow the instrunctions from CAPCOM and use the 3D models to complete your missions.
			<br><br>
			<img src="./images/help_asteroid.jpg" style="border:1px solid rgba(200,200,200,1.0);width:100%">
			<br><br>
			<table style="width:100%;margin:0;padding:0;">
				<tr>
					<td style="padding-right:30px;vertical-align:top;">
						<font style="font-size: 22px;font-weight: 400;">Help & Replay</font>
						<br> If you get stuck, select 'Help' in the lower left of the screen to get more 
						information.  Select 'Replay' to hear the latest message from CAPCOM again.
					</td>
					<td style="vertical-align:top;">
						<font style="font-size: 22px;font-weight: 400;">Camera Angle</font>
						<br>If you are having trouble navigating around the 3D environment, 
						select one of the camera angle buttons along the bottom of the screen.
					</td>
				</tr>
			</table>
		</div>
		<div id="threedhelppopup" class="threedhelppopup">
			<h1 style="text-align: center;">Solar System Controls</h1>
			<br>
			<font style="font-size: 22px;font-weight: 400;">Move</font>
			<br>Click and drag to move the camera.
			<br><br>
			<font style="font-size: 22px;font-weight: 400;">Zoom</font>
			<br>Scroll up and down with a mouse scroll wheel or a trackpad to zoom in and out.
			<br><br>
			<font style="font-size: 22px;font-weight: 400;">Camera View</font>
			<br>Select any planet or a camera view button to change the camera focus.
			<br><br>
			<font style="font-size: 22px;font-weight: 400;">Orbit Speed</font>
			<br>Move the slider left or right to change the planet orbit speeds.
			<br><br>
		</div>
		
		<div id="quicklaunchpopup" class="quicklaunchpopup">
			<button id="quicksetlaunchbutton" class="squarebluebutton" style="width:175px;margin-left:12px;margin-top:3px;margin-bottom:8px;">Set Launch Date</button>
			<br>
			<button id="quicksetlandbutton" class="squarebluebutton" style="width:175px;margin-left:12px;">Set Land Date</button>
		</div>
		
		<div id="launchhelppopup" class="launchhelppopup">
			<h1>Mars Transfer</h1>
			<table style="width:100%;margin:0px;padding:0px;align:center;">
				<tr>
					<td style="vertical-align:top;padding-right:10px;">
						Select a rocket, launch date, and landing date to get a spacecraft to Mars.
						Make sure the delta-v of the selected rocket is greater than the delta-v required
						to complete the Mars transfer.
						<br><br>
						<font style="font-size: 22px;font-weight: 400;">Delta-V (ΔV)</font>
						<br>
						Delta-V (change in velocity) determines the amount of effort needed to change orbits.
						<br><br>
						<font style="font-size: 22px;font-weight: 400;">Rockets</font>
						<br>
						Each rocket has a specific delta-v based on it's weight and fuel capacity.
					</td>
					
					<td style="vertical-align:top;">
						<font style="font-size: 22px;font-weight: 400;">Launch & Land Dates</font>
						<br>
						Fuel efficient Mars transfers generally launch when Earth is slightly behind 
						Mars and take between six and nine months.
						<br><br>
						<img src="./images/help_mission.jpg" style="border:1px solid rgba(200,200,200,1.0);"></td>
				</tr>
			</table>
		</div>
		
		<div id="scientisthelppopup" class="scientisthelppopup">
			<h1>CapCom Alert!</h1>
			<table style="width:100%;margin:0px;padding:0px;align:center;">
				<tr>
					<td style="vertical-align:top;padding-right:10px;">
						Our backup simulation team has suggested to try a launch date of October 2037. 
						Please try and run the simulation using that launch date and a 6 month later landing date.
						<br><br>
						That should get us there within a Delta V of under 13.
						<br><br>
						
					</td>
					
					<td style="vertical-align:top;">
						<img src="./images/help_scientists.png" style="border:1px solid rgba(200,200,200,1.0);">
						<br>
						Backup Sim Unit Ph. D. Hitchens and Ar. St. Phys. Dr. Frowd.
						<br><br>
					</td>
				</tr>
			</table>
			<table style="width:100%;margin:0px;padding:0px;align:center;">
				<tr>
					<td style="vertical-align:top;padding-right:10px;">
						
						<button id="scientisttrybutton" class="squarebluebutton" style="width:105px;margin-left:12px;">Try It!</button>
					</td>
					
					<td style="vertical-align:top;">
						
						<button id="scientistclosebutton" class="squarebluebutton" style="width:105px;margin-left:12px;">Close</button>
					</td>
					<td style="vertical-align:top;width:280px;">
						&nbsp;
					</td>
				</tr>
			</table>
		</div>
		
		<div id="browserpopup" class="browserpopup">
			<h1>Mission to Mars</h1>
			<div class="greensquarediv">
			This experience requires WebGL and is best viewed in <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a> 
			or <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> on a newer machine.  
			Either your graphics card or your browser does not support WebGL. 
			View a <a href="http://www.khronos.org/webgl/wiki_1_15/index.php/Getting_a_WebGL_Implementation" target="_blank">list</a> of compatible browsers.
			</div>
			<br>
			
			<br>
			<br>
			<div class="textstyle2">
			This project is a collaboration between the U.S. Department of Energy, the Mozilla Foundation, and MX.</div>
			<br>
			<img src="./images/tri_logo.png" style="align: center;">
			<br>
		</div>
		
		<div id="incomingmessage" class="capcommessagediv">
			<table style="width: 100%;margin:2;padding:0;" >
				<tr >
					<td width="50px" rowspan="2" align="left" valign="middle"><img src="./images/icon_satellite.png" style="width:45px;height:45px;"></td>
					
					<td align="left">...Incoming Transmission</td>
				</tr>
				<tr>
					<td align="left">
						<button id="answerbutton" class="roundedbluebutton">Answer</button>
						<button id="ignorebutton" class="roundedbluebutton">Ignore</button>
					</td>
				</tr>
			</table>
		</div>
		
		<div id="transmissionmessage" class="capcommessagediv">
			<table style="width: 100%;margin:2;padding:0;" >
				<tr >
					<td width="50px" rowspan="2" align="left" valign="middle"><img src="./images/icon_satellite.png" style="width:45px;height:45px;"></td>
					<td align="left">Current Transmission:</td>
				</tr>
				<tr>
					<td align="left" style="font-weight:400;"> Nasa - Capcom </td>
				</tr>
			</table>
		</div>
		
		<div id="cmemessage" class="capcommessagereddiv">
			<table style="width: 100%;margin:2;padding:0;" >
				<tr >
					<td width="50px" rowspan="2" align="left" valign="middle"><img src="./images/icon_alert.png" style="width:49px;height:44px;"></td>
					
					<td align="center">CME Detected</td>
				</tr>
				<tr>
					<td align="center">
						<button id="relaycmebutton" class="roundedredbutton">Relay to Spacecraft</button>
					</td>
				</tr>
			</table>
		</div>
		
		<div id="speedtimemessage" class="resultsdiv">
			<table style="width: 100%;margin:2;padding:0;" >
				<tr>
					<td width="70px" rowspan="4" align="left" valign="top"><img src="./images/icon_hourglass.png" ></td>
					<td align="left" colspan="2">Fast Forward</td>
				</tr>
				<tr>
					<td align="left" style="font-weight:400;" colspan="2">Curiosity Launch</td>
				</tr>
				<tr>
					<td align="left" style="font-weight:300;" colspan="2"> 
						<br>
						Speeding up time just before the launch of Curiosity. 
						<br>
						<br>
						<br>
					</td>
				</tr>
				<tr>
					<td align="left" style="font-weight:300;color:rgba(196,216,168,1.0);"> 
						Simulation Date:
					</td>
					<td align="left" style="font-weight:300;color:rgba(196,216,168,1.0);">
						<div id="speeddate">&nbsp;</div>
					</td>
				</tr>
			</table>
		</div>
		
		<div id="baddatespopup" class="baddatespopup">
			<table style="width: 100%;margin:0;padding:0;" >
				<tr >
					<td width="50px" rowspan="2" align="left" valign="middle" style="padding-right:8px;"><img src="./images/icon_alert.png" style="width:49px;height:44px;"></td>
					
					<td align="left">
						<div id="baddatesheadertext" style="font-size:16px;font-weight:400;text-transform: uppercase;">
						</div>
					</td>
				</tr>
				<tr>
					<td align="left">
						<div id="baddatestext" style="font-size:16px;font-weight:300;">
						
						</div>
					</td>
				</tr>
			</table>
		</div>
		
		<div id="selectmissionrocket" class="selectitemdiv">
			<div style="font-weight:bold;font-size:20px;margin:0px 0px 10px 0px;">Select Mission Rocket</div>
			<div style="display:inline;width:900px;height:500px;">
				<div id="rocket1div" class="selectitemdetaildiv">
					<table style="width: 100%;height: 100%;margin:0;padding:0;">
						<tr>
							<td width="70%" align="left" valign="top">
								Falcon Heavy
								<br><br>
								<font style="font-family: 'Lato', sans-serif;font-size:14px;line-height:16px;font-weight:300;">
								Small. Lightweight. 
								<br> 
								Private! The vanguard of the for-profit rocket!
								<br> <br> 
								Pro: Selling shares now!
								<br> <br> 
								Con: No safety net
								<br> <br> <br>  
								ΔV: 22.3 km/s
								<br> <br>
								Max Fuel: 100,000 LBS
								<br> <br>
								Max Payload: 20,000 LBS
								</font>
							</td>
							<td width="30%" align="center" valign="bottom"><img id="rocket1" src="./images/rocket_falcon_heavy_s.png"></td>
						</tr>
					</table>
				</div>
				<div id="rocket2div" class="selectitemdetaildiv">
					<table style="width: 100%;height: 100%;margin:0;padding:0;">
						<tr>
							<td width="70%" align="left" valign="top">
								Delta IV Heavy
								<br><br>
								<font style="font-family: 'Lato', sans-serif;font-size:14px;line-height:16px;font-weight:300;">
								The premium choice in rockets. Old faithful.
								<br> <br> <br>
								Pro: Stable
								<br> <br> 
								Con: Not exciting
								<br> <br> <br> 
								ΔV: 21.1 km/s
								<br> <br>
								Max Fuel: 100,000 LBS
								<br> <br>
								Max Payload: 20,000 LBS
								</font>
							</td>
							<td width="30%" align="center" valign="bottom"><img id="rocket2" src="./images/rocket_delta_iv_heavy_n.png"></td>
						</tr>
					</table>
				</div>
				<div id="rocket3div" class="selectitemdetaildiv">
					<table style="width: 100%;height: 100%;margin:0;padding:0;">
						<tr>
							<td width="70%" align="left" valign="top">
								NASA SLS
								<br><br>
								<font style="font-family: 'Lato', sans-serif;font-size:14px;line-height:16px;font-weight:300;">
								The big dog. If you gotta send something to space, this is your rocket.
								<br> <br> 
								Pro: It’s HUGE!
								<br> <br> 
								Con: It ain’t cheap..
								<br> <br> <br> 
								ΔV: 25.2 km/s
								<br> <br>
								Max Fuel: 100,000 LBS
								<br> <br>
								Max Payload: 20,000 LBS
								</font>
							</td>
							<td width="30%" align="center" valign="bottom"><img id="rocket3" src="./images/rocket_nasa_sls_n.png"></td>
						</tr>
					</table>
				</div>
			</div>
			
			<div style="font-weight:bold;font-size:30px;">
				<button id="selectmissioncontinuebutton" class="squarebluebutton" style="margin-top:10px;">Continue</button>
			</div>
		</div>
		
		<div id="launchcontrols" class="launchcontrols">
			
			<div id="datediv" class="datediv" >
				<table style="width:100%;height:100%;margin:0;padding:0;" >
					<tr>
						<td align="center" valign="bottom" height="30px">Orbit Speed</td>
						<td align="center" valign="bottom">Current Date</td>
					</tr>
					<tr>
						<td align="center" valign="bottom" height="54px" style="width:140px;">
							<table style="width:100%;height:37px;margin-bottom:5px;padding:3px;background:rgba(18,40,51,1.0);" >
								<tr>
									<td align="center" valign="middle"><button id="minusbutton" class="squarelittlebluebutton">-</button></td>
									<td align="center" valign="middle" style="width:110px;"><div id="speedSlider" class="speedSlider"></div></td>
									<td align="center" valign="middle"><button id="plusbutton" class="squarelittlebluebutton">+</button></td>
								</tr>
							</table>
							
						</td>
						<td align="center" valign="bottom">
							<input type="text" id="orbitdate" class="currentdatetext" readonly/>
						</td>
					</tr>
				</table>
			</div>
			
			<div id="launchdiv" class="launchdiv" >
				<table style="width:600px;height:100%;margin:0;padding:0;">
					<tr>
						<td align="center" valign="bottom" height="30px">ΔV</td>
						<td align="center" valign="bottom" height="30px">Rocket</td>
						<td align="center" valign="bottom" rowspan="2" style="padding:0px 5px 0px 0px" height="90px">
				 			<img id="rocketselect" src="./images/icon_rocket_falcon_heavy.png" style="padding:0px 0px 0px 0px">
						</td>
						<td align="center" valign="bottom">Launch Date</td>
						<td align="center" valign="bottom">Land Date</td>
						<td align="center" valign="bottom"><font style="color:#fff;">Run</font></td>
					</tr>
					<tr>
						<td align="center" valign="bottom">
				 			<input type="text" id="deltavtext" class="plaintext" value="0" readonly/>
						</td>
						<td align="center" valign="bottom">
				 			<button id="rocketbutton" class="playnoborderbutton" style="padding:2px 9px;border: 0px solid rgba(51,111,139,0.0);">
								<table style="width:60px;height:100%;margin:0;padding:0;">
									<tr>
										<td id="rocketbuttontext">Delta IV Heavy</td>
									</tr>
								</table>
							</button>
						</td>
						<td align="center" valign="bottom">
				 			<input type="text" id="launchdatepicker" class="datepicker"/>
						</td>
						<td align="center" valign="bottom">
				 			<input type="text" id="landingdatepicker" class="datepicker"/>
						</td>
						<td align="center" valign="bottom">
				 			<button id="runbutton" class="playbutton" style="padding:0px 0px !important">
								<table style="width:100%;height:100%;margin:0;padding:0;">
									<tr>
										<td><img src="./images/playwhite.png" style="width:90%;height:90%;"></td>
									</tr>
								</table>
							</button>
						</td>
					</tr>
				</table>
			</div>
			
			<div id="launchcommitdiv" class="launchcommitdiv" >
				<table style="width:100px;height:100%;margin:0;padding:0;">
					<tr>
						<td align="center" valign="bottom" height="30px"><font style="color:#fff;">Mission</font></td>
					</tr>
					<tr>
						<td align="center" valign="bottom" height="54px" style="width:140px;">
				 			<button id="launchcommitbutton" class="playbutton" style="padding:0px 9px;">
								<table style="width:100%;height:100%;margin:0;padding:0;">
									<tr>
										<td>Launch<br>Commit</td>
									</tr>
								</table>
							</button>
						</td> 
					</tr>
				</table>
			</div>
			
		</div>
		
		
		
		<audio id="SEQ2_VO">
			<source src="audio/SEQ2_VO.mp3"></source>
			<source src="audio/SEQ2_VO.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id="SEQ3_VOpt1">
			<source src="audio/SEQ3_VOpt1.mp3"></source>
			<source src="audio/SEQ3_VOpt1.oggvorbis.ogg"></source>
			
		</audio>
		
		<audio id="SEQ3_VOpt2">
			<source src="audio/SEQ3_VOpt2.mp3"></source>
			<source src="audio/SEQ3_VOpt2.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id="SEQ3_VOpt3">
			<source src="audio/SEQ3_VOpt3.mp3"></source>
			<source src="audio/SEQ3_VOpt3.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id=SEQ_3_CAM_1a>
			<source src="audio/SEQ_3_CAM_1a.mp3"></source>
			<source src="audio/SEQ_3_CAM_1a.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id="SEQ_3_CAM_1b">
			<source src="audio/SEQ_3_CAM_1b.mp3"></source>
			<source src="audio/SEQ_3_CAM_1b.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id="SEQ_3_CAM_1c">
			<source src="audio/SEQ_3_CAM_1c.mp3"></source>
			<source src="audio/SEQ_3_CAM_1c.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id="SEQ_3_CAM_2a">
			<source src="audio/SEQ_3_CAM_2a.mp3"></source>
			<source src="audio/SEQ_3_CAM_2a.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id="SEQ_3_CAM_2b">
			<source src="audio/SEQ_3_CAM_2b.mp3"></source>
			<source src="audio/SEQ_3_CAM_2b.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id="SEQ_3_CAM_3a">
			<source src="audio/SEQ_3_CAM_3a.mp3"></source>
			<source src="audio/SEQ_3_CAM_3a.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_3b">
			<source src="audio/SEQ_3_CAM_3b.mp3"></source>
			<source src="audio/SEQ_3_CAM_3b.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_3c">
			<source src="audio/SEQ_3_CAM_3c.mp3"></source>
			<source src="audio/SEQ_3_CAM_3c.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_4a">
			<source src="audio/SEQ_3_CAM_4a.mp3"></source>
			<source src="audio/SEQ_3_CAM_4a.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_4b">
			<source src="audio/SEQ_3_CAM_4b.mp3"></source>
			<source src="audio/SEQ_3_CAM_4b.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_4c">
			<source src="audio/SEQ_3_CAM_4c.mp3"></source>
			<source src="audio/SEQ_3_CAM_4c.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_4d">
			<source src="audio/SEQ_3_CAM_4d.mp3"></source>
			<source src="audio/SEQ_3_CAM_4d.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_5a">
			<source src="audio/SEQ_3_CAM_5a.mp3"></source>
			<source src="audio/SEQ_3_CAM_5a.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_5b">
			<source src="audio/SEQ_3_CAM_5b.mp3"></source>
			<source src="audio/SEQ_3_CAM_5b.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_5c">
			<source src="audio/SEQ_3_CAM_5c.mp3"></source>
			<source src="audio/SEQ_3_CAM_5c.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_5d">
			<source src="audio/SEQ_3_CAM_5d.mp3"></source>
			<source src="audio/SEQ_3_CAM_5d.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_5e">
			<source src="audio/SEQ_3_CAM_5e.mp3"></source>
			<source src="audio/SEQ_3_CAM_5e.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_5f">
			<source src="audio/SEQ_3_CAM_5f.mp3"></source>
			<source src="audio/SEQ_3_CAM_5f.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_CAM_1a">
			<source src="audio/SEQ_5_CAM_1a.mp3"></source>
			<source src="audio/SEQ_5_CAM_1a.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_CAM_1b">
			<source src="audio/SEQ_5_CAM_1b.mp3"></source>
			<source src="audio/SEQ_5_CAM_1b.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_CAM_1c">
			<source src="audio/SEQ_5_CAM_1c.mp3"></source>
			<source src="audio/SEQ_5_CAM_1c.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_CAM_1d">
			<source src="audio/SEQ_5_CAM_1d.mp3"></source>
			<source src="audio/SEQ_5_CAM_1d.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_CAM_Launch">
			<source src="audio/SEQ_5_CAM_Launch.mp3"></source>
			<source src="audio/SEQ_5_CAM_Launch.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_sim_fail1">
			<source src="audio/SEQ_5_sim_fail1.mp3"></source>
			<source src="audio/SEQ_5_sim_fail1.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_sim_fail2">
			<source src="audio/SEQ_5_sim_fail2.mp3"></source>
			<source src="audio/SEQ_5_sim_fail2.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_sim_fail3">
			<source src="audio/SEQ_5_sim_fail3.mp3"></source>
			<source src="audio/SEQ_5_sim_fail3.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_sim_fail4">
			<source src="audio/SEQ_5_sim_fail4.mp3"></source>
			<source src="audio/SEQ_5_sim_fail4.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_fail1">
			<source src="audio/SEQ_5_fail1.mp3"></source>
			<source src="audio/SEQ_5_fail1.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_fail2">
			<source src="audio/SEQ_5_fail2.mp3"></source>
			<source src="audio/SEQ_5_fail2.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_fail3">
			<source src="audio/SEQ_5_fail3.mp3"></source>
			<source src="audio/SEQ_5_fail3.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_fail4">
			<source src="audio/SEQ_5_fail4.mp3"></source>
			<source src="audio/SEQ_5_fail4.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_6_CAM">
			<source src="audio/SEQ_6_CAM.mp3"></source>
			<source src="audio/SEQ_6_CAM.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_7_cme_success">
			<source src="audio/SEQ_7_cme_success.mp3"></source>
			<source src="audio/SEQ_7_cme_success.oggvorbis.ogg"></source>
		</audio> 
		
	</body>
</html>
