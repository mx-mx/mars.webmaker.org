<!DOCTYPE html>
<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="en"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="en"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>DOE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
<meta name="description" content="" />
<meta name="keywords" content="Mars" />
<meta name="author" content="MX" />
<LINK REL="SHORTCUT ICON" HREF="images/mars.ico"> 
<link rel="stylesheet" type="text/css" href="css/mars.css" />
<link href="css/custom-theme/jquery-ui-1.10.2.custom.css" rel="stylesheet">
<link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700,900,100italic,300italic,400italic,700italic,900italic' rel='stylesheet' type='text/css'>

<script type="text/javascript" src="./js/popcorn-complete.js"></script>	
<script type="text/javascript" src="./js/libs/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="./js/libs/jquery-ui-1.10.1.custom.min.js"></script>

<script type="text/javascript" src="./js/libs/three.min.js"></script>

		<script src="./js/libs/Detector.js"></script>
		<script src="./js/libs/stats.min.js"></script>
		<script src="./js/libs/tween.min.js"></script>
		<script src="./js/libs/dat.gui.min.js"></script>
		<script src="./js/libs/underscore.min.js"></script>

		<script src="./js/controls/OrbitControls.js"></script>	
		<script src="./js/loaders/ColladaLoader.js"></script>

		
        <script src="js/jat/Constants.js"></script>
        <script src="js/jat/PathUtil.js"></script>
        <script src="js/jat/DE405APL.js"></script>
        <script src="js/jat/DE405Body.js"></script>
        <script src="js/jat/DE405Plus.js"></script>
        <script src="js/jat/Lambert.js"></script>
        <script src="js/jat/LambertException.js"></script>
        <script src="js/jat/MarsOdyssey.js"></script>
        <script src="js/jat/Matrix.js"></script>
        <script src="js/jat/SolarSystemBodies.js"></script>
        <script src="js/jat/Time.js"></script>
        <script src="js/jat/TimeUtils.js"></script>
        <script src="js/jat/TwoBody.js"></script>
        <script src="js/jat/VectorN.js"></script>
        <script src="js/jat/ZeroFinder.js"></script>

		<script src="./js/utils.js"></script>
		<script src="./js/ephemeris.js"></script>
		<script src="./js/daycount.js"></script>
		<script src="./js/ruler.js"></script>
		<script src="./js/shaderlist.js"></script>

		<script src="./js/label.js"></script>
		<script src="./js/lensflare.js"></script>
		<script src="./js/planet.js"></script>
		<script src="./js/orbit.js"></script>
		<script src="./js/sun.js"></script>
		<script src="./js/solarsystem.js"></script>
		<script src="./js/camtweener.js"></script>
		<script src="./js/main.js"></script>
		<script src="./js/stars.js"></script>
		<script src="./js/jat/Time.js"></script>

		<script src="./js/addlensflare.js"></script>
		
		<script src="./js/sonic.js"></script>


<script type="text/javascript">
//need a value to maintain global user email to check for during session.
//the following variable and function provide separate backpack window to communicate user email value.
var userBackpackEmail;
function setUserBackpackEmail(emailValue) {
	userBackpackEmail = emailValue;
	console.log("user email set to: ",userBackpackEmail);
}

function solarsystembadgefinish() {
	$("#solarsystembadge").animate({opacity: 0.0}, 200, function() {
    	$("#solarsystembadge").css('pointer-events', 'none');
    });
	$("#solarsystembadgecomplete").animate({opacity: 1.0}, 200, function() {
    	$("#solarsystembadgecomplete").css('pointer-events', 'auto');
    });
}



// ensure the web page (DOM) has loaded
document.addEventListener("DOMContentLoaded", function () {
//https://www.youtube.com/watch?v=P4boyXQuUIw - the MSL path
//http://www.youtube.com/watch?v=jEXoMpmfJcM - the MSL launch - a better version
//https://www.youtube.com/watch?v=lKqr3F73bAI - MSL trajectory
			
//blue - 58,132,166 #3a84a6
//bluebg - 13,30,38 #0d1e26 70%
//menu/next green - 135,153,72 #7d9948 
//submenu green - 88,107,54 #586b36
//submenu greenbg - 42,51,24 #2a3318 80%
//header greenbg 31,38,18 #1f2612 70%
//isle blue 76,173,197 #4cadc5

	function preloadimages(arr){
		var newimages=[], loadedimages=0
	    var postaction=function(){}
	    var arr=(typeof arr!="object")? [arr] : arr
	    function imageloadpost(){
	        loadedimages++
	        if (loadedimages==arr.length){
	            postaction(newimages) //call postaction and pass in newimages array as parameter
	        }
	    }
	    for (var i=0; i<arr.length; i++){
	        newimages[i]=new Image()
	        newimages[i].src=arr[i]
	        newimages[i].onload=function(){
	            imageloadpost()
	        }
	        newimages[i].onerror=function(){
	            imageloadpost()
	        }
	    }
	    return { //return blank object with done() method
	        done:function(f){
	            postaction=f || postaction //remember user defined callback functions to be called when images load
	        }
	    }

	}


    loadDE405Plus(function () {
    	console.log("loadDE405Plus callback");
	    preloadimages(['./images/solarsystem/sunmap.jpg', 
	                   './images/solarsystem/mercurymap.jpg', 
	                   './images/solarsystem/venusmap.jpg', 
	                   './images/solarsystem/earthmap2.jpg',
	                   './images/solarsystem/marsmap.jpg', 
	                   './images/solarsystem/jupitermap.jpg', 
	                   './images/solarsystem/saturnmap.jpg', 
	                   './images/solarsystem/uranusmap.jpg', 
	                   './images/solarsystem/neptunemap.jpg']).done(function(images){
	        //code inside here is run after all images have preloaded
	        //images parameter is an array of image objects corresponding to the preloaded images
	        //images[0] references the 1st image etc
	     
	        console.log("done preloading...");
	    
	        div.removeChild(infinityloader.canvas);
	        $("#loaderdiv").animate({opacity: 0.0}, 500, function() {
	            $("#loaderdiv").css('pointer-events', 'none');
	        });
	    });
    });


	//loader
	var infinityloader = new Sonic({

		width: 160,
		height: 80,

		stepsPerFrame: 2,
		trailLength: .35,
		pointDistance: .01,
		fps: 25,

		fillColor: '#FF7B24',

		setup: function() {
			this._.lineWidth = 3;
		},

		step: function(point, i, f) {

			var progress = point.progress,
				degAngle = 360 * progress,
				angle = Math.PI/180 * degAngle,
				angleB = Math.PI/180 * (degAngle - 180),
				size = i*3;

			this._.fillRect(
				Math.cos(angle) * 35 + (100-size/2),
				Math.sin(angle) * 15 + (50-size/2),
				size * .75,
				size * .75
			);
			
			this._.fillStyle = '#3a84a6';

			this._.fillRect(
				Math.cos(angleB) * 25 + (100-size/2),
				Math.sin(angleB) * 10 + (50-size/2),
				size,
				size
			);

			this._.fillStyle = '#FFF47A';

			this._.beginPath();
			this._.arc(100, 50, 5, 0, 360, 0);
			this._.closePath();
			this._.fill();


		},

		path: [
			['line', 20, 5, 30, 45]
		]
	 
	});
	 
	infinityloader.play();
	var div = document.getElementById("canvastarget"); 
	div.appendChild(infinityloader.canvas);
	
	var drawingDone = function() {
		console.log("drawing done!!!");
	}
 
	$contenttarget = $("#contenttarget");
	// Create a popcorn instance by calling the Youtube player plugin     
	Popcorn.player( "baseplayer" );
	
	var popcornMedia = new Array();
	var popcornSequenceNumber = 0;
	popcornMedia[0] = Popcorn( '#videointro' );
	popcornMedia[1] = Popcorn( '#video' );
	popcornMedia[2] = Popcorn('#SEQ2_VO' );
	popcornMedia[3] = Popcorn('#SEQ3_VOpt1' );
	popcornMedia[4] = Popcorn('#SEQ3_VOpt2' );
	popcornMedia[5] = Popcorn( '#SEQ3_VOpt3' );
	popcornMedia[6] = Popcorn( '#SEQ_3_CAM_1a' );//lesson 1 - click drag
	popcornMedia[7] = Popcorn( '#SEQ_3_CAM_1b' );//call to action
	popcornMedia[8] = Popcorn( '#SEQ_3_CAM_1c' );
	popcornMedia[9] = Popcorn( '#SEQ_3_CAM_2a' );//lesson 2 - zoom
	popcornMedia[10] = Popcorn( '#SEQ_3_CAM_2b' );//call to action
	popcornMedia[11] = Popcorn( '#SEQ_3_CAM_3a' );//lesson 3 - click on planet earth
	popcornMedia[12] = Popcorn( '#SEQ_3_CAM_3b' );//call to action
	popcornMedia[13] = Popcorn( '#SEQ_3_CAM_3c' );//mistake
	popcornMedia[14] = Popcorn( '#SEQ_3_CAM_4a' );//lesson 4
	popcornMedia[15] = Popcorn( '#SEQ_3_CAM_4b' );//call to action
	popcornMedia[16] = Popcorn( '#SEQ_3_CAM_4c' );
	popcornMedia[17] = Popcorn( '#SEQ_3_CAM_4d' ); //question
	popcornMedia[18] = Popcorn( '#SEQ_3_CAM_5a' ); //call to action
	popcornMedia[19] = Popcorn( '#SEQ_3_CAM_5b' ); //mistake
	popcornMedia[20] = Popcorn( '#SEQ_3_CAM_5c' ); //drag left
	popcornMedia[21] = Popcorn( '#SEQ_3_CAM_5d' ); //call to action
	popcornMedia[22] = Popcorn( '#SEQ_3_CAM_5e' ); //mistake
	popcornMedia[23] = Popcorn( '#SEQ_3_CAM_5f' ); //award badge
	
	popcornMedia[24] = Popcorn( '#SEQ_5_CAM_1a' ); //pick a rocket
	popcornMedia[25] = Popcorn( '#SEQ_5_CAM_1b' ); //try it out
	popcornMedia[26] = Popcorn( '#SEQ_5_CAM_1c' ); //award after user hits run
	popcornMedia[27] = Popcorn( '#SEQ_5_CAM_1d' ); //award after the landing on mars
	
	popcornMedia[28] = Popcorn( '#ROCKET_SUCCESS' );
	popcornMedia[29] = Popcorn( '#ROCKET_FAIL1' );
	popcornMedia[30] = Popcorn( '#ROCKET_FAIL2' );
	popcornMedia[31] = Popcorn( '#ROCKET_FAIL3' );
	popcornMedia[32] = Popcorn( '#ROCKET_FAIL4' );

	//not sure if I'll need this baseplayer
	//decided to keep basepop in as a convenient way to initialize the 3D and fire up the first video player.  
	var basepop = Popcorn.baseplayer( "#contenttarget" ); 
	//var popcorn_branch1_video2 = Popcorn.youtube('#videocontenttarget2', 'https://www.youtube.com/watch?v=lKqr3F73bAI' );
	 
	var threedinitialized;
	var initializethreed = function() {
		if(!threedinitialized) {
			threedinitialized = true;
	        init(); //init the 3D background.
	        animate();

	        gui.destroy();  //remove the test GUI (used by Ryan)
	        
	        //set time to slight move
			$("#speedSlider").slider('value',.01);
			
	        //initialize mars/earth ruler to off
			showDistance = false;
	        scene.remove(ruler);
		}
	}
	
	basepop.cue( 1, function() {
		initializethreed();
	});
	
	basepop.cue( 2, function() {
		popcornMedia[popcornSequenceNumber].play();
	});
	
    popcornMedia[0].on( "play", function() {
    	$("#videointrocontenttarget").animate({opacity: 1.0}, 100, function() {
           	$("#videointrocontenttarget").css('pointer-events', 'auto');
       	});

    	$("#backgroundtarget").animate({opacity: 0.0}, 100, function() {
           	$("#backgroundtarget").css('pointer-events', 'none');
       	});
    	
		$("#nextbuttonwrapper").animate({opacity: 1.0}, 200, function() {
        	$("#nextbuttonwrapper").css('pointer-events', 'auto');
    	});
	});
	

    popcornMedia[0].on( "ended", function() {

    	$("#videointrocontenttarget").animate({opacity: 0.0}, 1000, function() {
           	$("#videointrocontenttarget").css('pointer-events', 'none');
    		
        	advancePopcornMedia();
       	});
	});
	
	popcornMedia[1].footnote({
	    start: .1,
	    end: 22,
	    target: "headerpanel",
	    text: "Introduction"
	});
	popcornMedia[1].footnote({
	    start: 22,
	    target: "headerpanel",
	    text: "Mission to Mars: Setup"
	});
	popcornMedia[1].footnote({
		start: 1,
		end: 8.5,
	    target: "subtitlepanel",
		text: "Mary Beth Vilhelm<br><font style=\"font-size:14px;\">Mars Colony 1 Astronaut & Senior Geologist</font>",
	});
	popcornMedia[1].cue( 1, function() {
		$("#subtitlepanel").animate({opacity: 1.0}, 500, function() {
        	//$("#subtitlepanel").css('pointer-events', 'none');
    	});
	});
	popcornMedia[1].cue( 8, function() {
		$("#subtitlepanel").animate({opacity: 0.0}, 500, function() {
        	//$("#subtitlepanel").css('pointer-events', 'none');
    	});
	});
	popcornMedia[1].cue( 3, function() {
		$("#headerpanel").animate({opacity: 1.0}, 100, function() {
        	//$("#headerpanel").css('pointer-events', 'none');
    	});
	});

	//basepop.on( "timeupdate", function() {
		//document.getElementById( "footnotediv1" ).innerHTML = this.currentTime();
	//});
	popcornMedia[1].on( "play", function() {
		$("#videocontenttarget").animate({width: 720, height: 405,
											top: "50%", left: "50%",
											margin:"-240px 0 0 -335px"}, 1, function() {
           	//code after completion of animation
       	});
		
    	$("#videocontenttarget").animate({opacity: 1.0}, 1000, function() {
           	$("#videocontenttarget").css('pointer-events', 'auto');
       	});

	});
	popcornMedia[1].cue( 8.5, function() {
		$("#videocontenttarget").animate({width: 360, height: 202,
											top: "10%", left: "2%",
											margin:"-0px 0 0 -0px"}, 1000, function() {
			//code after completion of animation
			//camTweener( { x: 0, y: 700, z: 0 }, { x: 0, y: 0, z: -20 }, 3000 );
		});
	});

	popcornMedia[1].cue( 18.5, function() {
		$("#incomingmessage").animate({opacity: 1.0}, 1000, function() {
	       	$("#incomingmessage").css('pointer-events', 'auto');
	   	});
		
		setTimeout(function() {
			$("#incomingmessage").animate({opacity: 0.0}, 1000, function() {
		       	$("#incomingmessage").css('pointer-events', 'none');
		   	});
		}, 15000);
	});

	popcornMedia[1].on( "ended", function() {
    	$("#videocontenttarget").animate({opacity: 0.0}, 100, function() {
           	$("#videocontenttarget").css('pointer-events', 'none');
       	});
    	
    	advancePopcornMedia();
	});
    popcornMedia[2].on( "ended", function() {
    	advancePopcornMedia();
	});
    

	
    popcornMedia[2].cue( 6.5, function() {
    	Tweener(ssScale, {planetScale:.00001}, 1000);
    	Tweener(ssScale, {sunScale:.000001}, 1000);
    	Tweener(ssScale, {s:.00001}, 1000);
	});
    
    popcornMedia[2].cue( 11, function() {
    	Tweener(ssScale, {s:.000001}, 1000);
	});
    popcornMedia[2].cue( 12, function() {
    	Tweener(ssScale, {sunScale:.00001}, 1000);
    	Tweener(ssScale, {planetScale:.001}, 1000);
    	Tweener(ssScale, {s:.000001}, 1000);
	});
   
    popcornMedia[3].cue( 2, function() {
       	camTweener( { x: 0, y: 800, z: 0 }, { x: 0, y: 0, z: -20 }, 3000 );
	});
    popcornMedia[3].cue( 6, function() {
		$("#speedSlider").slider('value',.23);
	});

	popcornMedia[3].cue( 10, function() {
		miles = true;
		showDistance = true;
		scene.add(ruler);
	});
    popcornMedia[3].on( "ended", function() {
    	advancePopcornMedia();
	});
	popcornMedia[4].cue( 1, function() {
		showDistance = false;
		scene.remove(ruler);
	});
    popcornMedia[4].on( "ended", function() {
    	advancePopcornMedia();
	});
    popcornMedia[5].on( "ended", function() {
		
		camTweener( { x: 0, y: 100, z: 500 }, { x: 0, y: 0, z: -20 }, 1500 );
		setTimeout(function(){advancePopcornMedia()},2000);

		//erase 3d drawings if necessary
		clear3DDrawings();
	});
    
    popcornMedia[6].cue( .1, function() {
		$("#helpbuttonwrapper").animate({opacity: 1.0}, 200, function() {
        	$("#helpbuttonwrapper").css('pointer-events', 'auto');
    	});
	});
	popcornMedia[6].cue( .5, function() {
		$("#replaybuttonwrapper").animate({opacity: 1.0}, 200, function() {
        	$("#replaybuttonwrapper").css('pointer-events', 'auto');
    	});
	});

    popcornMedia[6].cue( 1.0, function() {
    	$("#threedcontrols").animate({opacity: 1.0}, 200, function() {
        	$("#threedcontrols").css('pointer-events', 'auto');
    	});
	});

    //setup vars to walk through mouse 3D lesson
    var cancelCallToAction=false;
    var listenToMouseMovements=false;
    var listenToMouseWheel=false;
    var userLessonNumber=0;
    var userMouseAction=[false,false,false,false];
    var mousePosX, mousePosY;
    var callToActionTimeout = new Array();

    popcornMedia[6].on( "ended", function() {
    	//the click/drag test
        listenToMouseMovements=true;
        userMouseAction[userLessonNumber]=true;
        cancelCallToAction=false;
        callToActionTimeout[userLessonNumber] = setTimeout(function(){callToActionUser()},10000);
	});
    popcornMedia[9].on( "ended", function() {
        //the scroll mouse test
        listenToMouseWheel=true;
        userMouseAction[userLessonNumber]=true;
        cancelCallToAction=false;
        callToActionTimeout[userLessonNumber] = setTimeout(function(){callToActionUser()},10000);
	});
    popcornMedia[11].on( "ended", function() {
        //the planet click test (user to click planet earth)
        userMouseAction[userLessonNumber]=true;
        cancelCallToAction=false;
        callToActionTimeout[userLessonNumber] = setTimeout(function(){callToActionUser()},10000);
        
        //temp: just call this until we get needed function from Ryan.
        //setTimeout(function(){advanceUser()},5000);
	});
    popcornMedia[14].on( "ended", function() {
        //the button click test (user to click mars button)
        //userMouseAction[userLessonNumber]=true;
        cancelCallToAction=false;
        callToActionTimeout[userLessonNumber] = setTimeout(function(){callToActionUser()},10000);
	});
    
    popcornMedia[23].cue( 8, function() {
    	$("#solarsystembadge").animate({opacity: 1.0}, 200, function() {
        	$("#solarsystembadge").css('pointer-events', 'auto');
        });
	});
    
    
    popcornMedia[24].cue( 32, function() {
		var jumpToDate = new Date(2036,0,1).Date2Julian();
		timer.JD = jumpToDate;
		$("#speedSlider").slider('value',.01);
		
        $("#selectmissionrocket").animate({opacity: 1.0}, 1000, function() {
        	$("#selectmissionrocket").css('pointer-events', 'auto');
    	});
        $("#launchcontrols").animate({opacity: 0.0}, 1000, function() {
        	$("#launchcontrols").css('pointer-events', 'none');
    	});
	});

    
    popcornMedia[28].cue( 2, function() {
    	//if this audio plays, that means we're ready to launch.
    	//disable test controls
		/*
        $("#runbutton").animate({opacity: 0.0}, 200, function() {
        	$("#runbutton").css('pointer-events', 'none');
    	});
    	$("#rocketbutton").animate({opacity: 0.0}, 200, function() {
        	$("#rocketbutton").css('pointer-events', 'none');
    	});
    	$("#landingdatepicker").css('pointer-events', 'none');
    	$("#launchdatepicker").css('pointer-events', 'none');
    	*/
    	//show launch control
        $("#commitlaunchbutton").animate({opacity: 1.0}, 200, function() {
        	$("#commitlaunchbutton").css('pointer-events', 'auto');
    	});
    	
	});
    
    
    $(document).on('mouseup', function(e) {
        if(!listenToMouseMovements) return;
        //console.log("got me a mouseup: " + userMouseAction[userLessonNumber]);
        if(userMouseAction[userLessonNumber]) {
        	//get event
        	if (!e) var e = window.event;
        	var clickedElement = (e.target || e.srcElement);
        	//check to make sure that we're clicking the 3d canvas object (the only one)
        	if(clickedElement!="[object HTMLCanvasElement]") return;
        	//check to see if the user moved the mouse.
        	var newMousePosX, newMousePosY;
        	
        	if (e.pageX || e.pageY) 	{
        		newMousePosX = e.pageX;
        		newMousePosY = e.pageY;
        	}
        	else if (e.clientX || e.clientY) 	{
        		newMousePosX = e.clientX + document.body.scrollLeft
        			+ document.documentElement.scrollLeft;
        		newMousePosY = e.clientY + document.body.scrollTop
        			+ document.documentElement.scrollTop;
        	}

        	//console.log("x: " + newMousePosX + "   y: " + newMousePosY);
        	if(mousePosX!=newMousePosX || mousePosY!=newMousePosY ) {
        		advanceUser();
        	} else {
    			jumpPopcornMedia(8);
        	}
        }
    });
    
    $(document).on('mousedown', function(e) {
		//planet clicking
    	if(projector) {
        	var vector = new THREE.Vector3( mouse.x, mouse.y, 1 );
        	projector.unprojectVector( vector, camera );

        	var raycaster = new THREE.Raycaster( camera.position, vector.sub( camera.position ).normalize() );
        	intersects = raycaster.intersectObjects( solarSystem.children );

        	if ( intersects.length > 0 ) {

        		// if ( CLICKED != intersects[ 0 ].object ) {

        			CLICKED = intersects[ 0 ].object;

        			if( clickMove ){
        				var posCLICKED = new THREE.Vector3();
        				posCLICKED.getPositionFromMatrix( CLICKED.matrixWorld );

        				var zScale = 250;
        				lookAtCLICKED = { x: posCLICKED.x + 50, y: posCLICKED.y + 50, z: posCLICKED.z + zScale };

        				var camCLICKED = new camPosition( lookAtCLICKED, posCLICKED, 1000 );
        				camCLICKED.tween();

        				console.log( CLICKED.name + " x: " + posCLICKED.x + " y: " + posCLICKED.y + " z: " + posCLICKED.z );

    					console.log("userLessonNumber: " + userLessonNumber);
    					console.log("userMouseAction[2]: " + userMouseAction[2]);
        				
        				if(CLICKED.name=="Earth" && userMouseAction[2]) {
        					console.log("planet earth clicked, time to move on to next lesson");
        					advanceUser();
        				} else if(CLICKED.name!="Earth" && userMouseAction[2] && userLessonNumber==2) {
							//no audio, do nothing
							jumpPopcornMedia(12);
        				}
        			}
        			
        		// }
        	} 
    	}
    	
    	//lesson listening
    	if(!listenToMouseMovements) return;
    	cancelCallToAction=true;
    	
    	//record mouse down possition
    	if (!e) var e = window.event;
    	//check to make sure that we're clicking the 3d canvas object (the only one)
    	var clickedElement = (e.target || e.srcElement);
    	if(clickedElement!="[object HTMLCanvasElement]") return;
    	
    	if (e.pageX || e.pageY) 	{
    		mousePosX = e.pageX;
    		mousePosY = e.pageY;
    	}
    	else if (e.clientX || e.clientY) 	{
    		mousePosX = e.clientX + document.body.scrollLeft
    			+ document.documentElement.scrollLeft;
    		mousePosY = e.clientY + document.body.scrollTop
    			+ document.documentElement.scrollTop;
    	}
    	
    	
    	
    });
  
	//Firefox has no implemented $(document).on('mousewheel', function) so we call mousywheely(e) for XBrowser support
    var mousewheelevt=(/Firefox/i.test(navigator.userAgent))? "DOMMouseScroll" : "mousewheel" //FF doesn't recognize mousewheel as of FF3.x
    
   	if (document.attachEvent) //if IE (and Opera depending on user setting)
   	    document.attachEvent("on"+mousewheelevt, mousywheely)
   	else if (document.addEventListener) //WC3 browsers
   	    document.addEventListener(mousewheelevt, mousywheely, false)
    	
    function mousywheely(e){
    	if(!listenToMouseWheel) return;
    	var evt=window.event || e //equalize event object
        var delta=evt.detail? evt.detail*(-120) : evt.wheelDelta //check for detail first so Opera uses that instead of wheelDelta
        console.log("mousewheel delta: " + delta);
        if(delta>0 || delta<0) { //the user zoomed in
        	listenToMouseWheel=false;
        	setTimeout(function(){advanceUser()},1000);
        }
    }
    
    var advanceUser = function () {
    	console.log("advancing user from: " + userLessonNumber);
		listenToMouseMovements=false;
		cancelCallToAction=false;
		clearTimeout(callToActionTimeout[userLessonNumber]);
		
		switch(userLessonNumber)
    	{
    	case 0:
			jumpPopcornMedia(9);
    	  break;
    	case 1:
			jumpPopcornMedia(11);
    	  break;
    	case 2:
			jumpPopcornMedia(14);
    	  break;
    	case 3:
			jumpPopcornMedia(17);
	    	break;
    	case 4:
			jumpPopcornMedia(20);
	    	break;
    	case 5:
			jumpPopcornMedia(23);
	    	break;
    	  break;
    	default:
    	  //no default audio
    	}
		
    	userLessonNumber++; //update to next lesson
		
    }
    
    var replayUser = function () {
		
    	resetMouseMovementTrackingLession();
		
		camTweener( { x: 0, y: 100, z: 500 }, { x: 0, y: 0, z: -20 }, 1500 );
		
		jumpPopcornMedia(6);
		
    }
    
    var resetMouseMovementTrackingLession = function () {
        clearTimeout(callToActionTimeout[userLessonNumber]);
    	
    	cancelCallToAction=true;
        listenToMouseMovements=false;
        listenToMouseWheel=false;
        userLessonNumber=0;
        for(var i=0;i<userMouseAction.length;i++) {
        	userMouseAction[i]=false;
        }
    }
    
    var callToActionUser = function () {
    	console.log("call to action: ", cancelCallToAction);
    	if(cancelCallToAction) return;
    	
    	switch(userLessonNumber)
    	{
    	case 0:
			jumpPopcornMedia(7);
    	  break;
    	case 1:
			jumpPopcornMedia(10);
    	  break;
    	case 2:
			jumpPopcornMedia(12);
    	  break;
    	case 3:
			jumpPopcornMedia(15);
	    	break;
    	case 4:
			jumpPopcornMedia(18);
	    	break;
    	case 5:
			jumpPopcornMedia(21);
    	  break;
    	default:
    	  //no default audio
    	}
    }

    //user has to select mars button
    var checkForFourthCameraLesson = function () {
    	if(!userMouseAction[userLessonNumber] && userLessonNumber==3) {
    		jumpPopcornMedia(16);
    	}
    }
    
    var finishFourthCameraLesson = function () {
    	if(!userMouseAction[userLessonNumber] && userLessonNumber==3) {
    		clearTimeout(callToActionTimeout[userLessonNumber]);
    		userMouseAction[userLessonNumber]=true;
    		//jumpPopcornMedia(17);
    		setTimeout(function(){advanceUser();},1000);
    		
    		
            $("#launchcontrols").animate({opacity: 1.0}, 200, function() {
            	$("#launchcontrols").css('pointer-events', 'auto');
        	});
    	}
    }
    
    var advancePopcornMedia = function () {
		popcornSequenceNumber++;
    	if(popcornSequenceNumber<popcornMedia.length) {
    		popcornMedia[popcornSequenceNumber].play(0);
    	}
    }
    
    //a way to skip around (needed for Next button and Menu buttons)
    var jumpPopcornMedia = function (sequenceNum, beginningOffset) {
		if(popcornSequenceNumber>=popcornMedia.length)return;
		popcornSequenceNumber=sequenceNum;
		//clear div targets
    	//hideeverything();
		
		//stop all other media
		for(var i=0;i<popcornMedia.length;i++) {
			popcornMedia[i].pause();
		}
		
		//jump to desired media
		if(popcornSequenceNumber==0 && !threedinitialized) {
			basepop.play(0);
		} else {
			if(beginningOffset) {
				popcornMedia[popcornSequenceNumber].play(beginningOffset);
			} else {
				popcornMedia[popcornSequenceNumber].play(0);
			}
		}
		//show pause toggle
		$("#playtoggle").attr("class", "pause");
    }
    
    var clear3DDrawings = function() {

		if(marsOdyssey) {
			solarSystem.remove( marsOdyssey.line );
			marsOdyssey=null;
		}
		
        //initialize mars/earth ruler to off
		showDistance = false;
        scene.remove(ruler);
    	
    }
    
    
	var hideeverything = function() {
		$("#startmenupanel").animate({opacity: 0.0}, 1, function() { $("#startmenupanel").css('pointer-events', 'none'); });
		$("#menupanel").animate({opacity: 0.0}, 1, function() { $("#menupanel").css('pointer-events', 'none'); });
		
		$("#videocontenttarget").animate({opacity: 0.0}, 1, function() { $("#videocontenttarget").css('pointer-events', 'none'); });
		$("#videointrocontenttarget").animate({opacity: 0.0}, 1, function() { $("#videointrocontenttarget").css('pointer-events', 'none'); });
		
		$("#aboutpopup").animate({opacity: 0.0}, 1, function() { $("#aboutpopup").css('pointer-events', 'none'); });
		$("#helppopup").animate({opacity: 0.0}, 1, function() { $("#helppopup").css('pointer-events', 'none'); });
		$("#helpthreedpopup").animate({opacity: 0.0}, 1, function() { $("#helpthreedpopup").css('pointer-events', 'none'); });
		//$("#browserpopup").animate({opacity: 0.0}, 1, function() { $("#browserpopup").css('pointer-events', 'none'); });
		
		$("#incomingmessage").animate({opacity: 0.0}, 1, function() { $("#incomingmessage").css('pointer-events', 'none'); });
		$("#transmissionmessage").animate({opacity: 0.0}, 1, function() { $("#transmissionmessage").css('pointer-events', 'none'); });
		$("#cmemessage").animate({opacity: 0.0}, 1, function() { $("#cmemessage").css('pointer-events', 'none'); });

		$("#selectmissionrocket").animate({opacity: 0.0}, 1, function() { $("#selectmissionrocket").css('pointer-events', 'none'); });
		$("#launchcontrols").animate({opacity: 0.0}, 1, function() { $("#launchcontrols").css('pointer-events', 'none'); });
		
		$("#nextbuttonwrapper").animate({opacity: 0.0}, 1, function() { $("#nextbuttonwrapper").css('pointer-events', 'none'); });
		$("#helpbuttonwrapper").animate({opacity: 0.0}, 1, function() { $("#helpbuttonwrapper").css('pointer-events', 'none'); });
		$("#replaybuttonwrapper").animate({opacity: 0.0}, 1, function() { $("#replaybuttonwrapper").css('pointer-events', 'none'); });
		

		$("#solarsystembadge").animate({opacity: 0.0}, 1, function() { $("#solarsystembadge").css('pointer-events', 'none'); });
		$("#solarsystembadgecomplete").animate({opacity: 0.0}, 1, function() { $("#solarsystembadgecomplete").css('pointer-events', 'none'); });
		

		$("#subtitlepanel").animate({opacity: 0.0}, 1, function() {});
	}
	
	// Add popcorn events here and other functionality
    //SEQ2_VO.image({
    	//start: 0.1, // Our start time in seconds
    	//end: 14, // Our end time in seconds
    	//src: "./images/planetorder.jpg", 
    	//text: "", 
    	//target: "imagecontenttarget", 
		//effect: "applyclass",
    	//applyclass: "stretchcontent"
    //});
    popcornMedia[17].cue( 3, function() {
       	camTweener( { x: 0, y: 1100, z: 0 }, { x: 0, y: 0, z: -20 }, 3000 );
	});
    

    function flipTimelinePic(picID,imgName)
    {
        var pic1 = document.getElementById(picID); 
        if (pic1 == typeof('undefined')) return;
        pic1.src = imgName;
    }
    
    
    //pop the mission complete
    var popBadgeWindow = function() {
    	//first we should check to see if the user email has been stored
    	//if(userBackpackEmail) {}
    	
    	//then pop the appropriate window
    	var winWidth = 750;
    	var winHeight = 600;
    	badgeWindow = popupwindow("./badge-it-gadget-lite/process-badges/missionComplete.html",
    			"New Badge",winWidth, winHeight);
    }
    
    //generic popup window opening function
    var solarsystembadgeuploadbutton = document.getElementById('solarsystembadgeuploadbutton');
    solarsystembadgeuploadbutton.onclick = function() {
    	popBadgeWindow();
    };
    
    function popupwindow(url, title, w, h) {
    	  var left = (screen.width/2)-(w/2);
    	  var top = (screen.height/2)-(h/2);
    	  return window.open(url, title, "titlebar=no,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,copyhistory=no,width="+w+", height="+h+", top="+top+", left="+left);
    }
    
    var selectmissioncontinue = document.getElementById('selectmissioncontinuebutton');
    selectmissioncontinue.style.cursor = 'pointer';
    selectmissioncontinue.onclick = function() {
    	$("#selectmissionrocket").animate({opacity: 0.0}, 200, function() {
        	$("#selectmissionrocket").css('pointer-events', 'none');

            $("#launchcontrols").animate({opacity: 1.0}, 200, function() {
            	$("#launchcontrols").css('pointer-events', 'auto');
                $("#launchdiv").animate({opacity: 1.0}, 200, function() {
                	$("#launchdiv").css('pointer-events', 'auto');
            	});
        	});
            jumpPopcornMedia(26);
        });
    };

    var solarsystembadgeskipbutton = document.getElementById('solarsystembadgeskipbutton');
    solarsystembadgeskipbutton.onclick = function() {
    	$("#solarsystembadge").animate({opacity: 0.0}, 200, function() {
        	$("#solarsystembadge").css('pointer-events', 'none');
        });
    	
    	setTimeout(function(){jumpPopcornMedia(24)},2000);
    };


    var solarsystembadgecompletereplaybutton = document.getElementById('solarsystembadgecompletereplaybutton');
    solarsystembadgecompletereplaybutton.onclick = function() {
    	//this will take you back to the 3D navigation lesson.
    	$("#navigation").click();
    };
    

    var solarsystembadgecompletecontinuebutton = document.getElementById('solarsystembadgecompletecontinuebutton');
    solarsystembadgecompletecontinuebutton.onclick = function() {
    	$("#solarsystembadgecomplete").animate({opacity: 0.0}, 200, function() {
        	$("#solarsystembadgecomplete").css('pointer-events', 'none');
        });
    	$("#solarsystembadgeskipbutton").click();
    };
    
    
    
    var aboutpopupclose = document.getElementById('aboutpopupclose');
    aboutpopupclose.style.cursor = 'pointer';
    aboutpopupclose.onclick = function() {
    	closeAllSubMenus();
    };
    
    var helppopupclose = document.getElementById('helppopupclose');
    helppopupclose.style.cursor = 'pointer';
    helppopupclose.onclick = function() {
    	closeAllSubMenus();
    };
    
    var helpthreedpopupclose = document.getElementById('helpthreedclose');
    helpthreedclose.style.cursor = 'pointer';
    helpthreedclose.onclick = function() {
    	closeAllSubMenus();
    };
    
    var browserpopupclose = document.getElementById('browserpopupclose');
    browserpopupclose.style.cursor = 'pointer';
    browserpopupclose.onclick = function() {
    	closeAllSubMenus();
    };
    
    var cmemessageclose = document.getElementById('ignorecmebutton');
    cmemessageclose.onclick = function() {
    	closeAllSubMenus();
    };

    
    var closeAllSubMenus = function() {
		console.log("closeAllSubMenus");
    	$("#aboutpopup").animate({opacity: 0.0}, 200, function() {$("#aboutpopup").css('pointer-events', 'none');});
    	$("#helppopup").animate({opacity: 0.0}, 200, function() {$("#helppopup").css('pointer-events', 'none');});
    	$("#helpthreedpopup").animate({opacity: 0.0}, 200, function() {$("#helpthreedpopup").css('pointer-events', 'none');});
    	$("#browserpopup").animate({opacity: 0.0}, 200, function() {$("#browserpopup").css('pointer-events', 'none');});
    	$("#incomingmessage").animate({opacity: 0.0}, 200, function() {$("#incomingmessage").css('pointer-events', 'none');});
    	$("#cmemessage").animate({opacity: 0.0}, 200, function() {$("#cmemessage").css('pointer-events', 'none');});
		$("#transmissionmessage").animate({opacity: 0.0}, 1, function() { $("#transmissionmessage").css('pointer-events', 'none'); });
		
    }
    
    var rocketbutton = document.getElementById('rocketbutton');
    rocketbutton.style.cursor = 'pointer';
    rocketbutton.onclick = function() {
    	$("#launchcontrols").animate({opacity: 0.0}, 200, function() {
        	$("#launchcontrols").css('pointer-events', 'none');
        	$("#selectmissionrocket").animate({opacity: 1.0}, 200, function() {
            	$("#selectmissionrocket").css('pointer-events', 'auto');
            });
        });
    };
    
    //selectmissionrocket div
    var rocketChoice = 0;
    var rocket1div = document.getElementById('rocket1div');
    rocket1div.style.cursor = 'pointer';
    rocket1div.onclick = function() {
   		//$("#rocket1div").css('outline', '4px solid rgba(200,200,200,1.0');
   		//document.getElementById('rocket1div').style.outline = '1px solid rgba(200,200,200,1.0';
   		document.getElementById("rocket1").src="./images/rocket_falcon_heavy_s.png";
   		document.getElementById("rocket2").src="./images/rocket_delta_iv_heavy_n.png";
   		document.getElementById("rocket3").src="./images/rocket_nasa_sls_n.png";
   		rocketChoice=0;
   		document.getElementById("rocketselect").src="./images/icon_rocket_falcon_heavy.png";
   		document.getElementById("rocketbuttontext").innerHTML="Falcon Heavy";
    };
    var rocket2div = document.getElementById('rocket2div');
    rocket2div.style.cursor = 'pointer';
    rocket2div.onclick = function() {
   		document.getElementById('rocket2div').style.outline = '1px solid rgba(200,200,200,1.0';
   		document.getElementById("rocket1").src="./images/rocket_falcon_heavy_n.png";
   		document.getElementById("rocket2").src="./images/rocket_delta_iv_heavy_s.png";
   		document.getElementById("rocket3").src="./images/rocket_nasa_sls_n.png";
   		rocketChoice=1;
   		document.getElementById("rocketselect").src="./images/icon_rocket_delta_iv_heavy.png";
   		document.getElementById("rocketbuttontext").innerHTML="Delta IV Heavy";
    };
    var rocket3div = document.getElementById('rocket3div');
    rocket3div.style.cursor = 'pointer';
    rocket3div.onclick = function() {
   		document.getElementById('rocket3div').style.outline = '1px solid rgba(200,200,200,1.0';
   		document.getElementById("rocket1").src="./images/rocket_falcon_heavy_n.png";
   		document.getElementById("rocket2").src="./images/rocket_delta_iv_heavy_n.png";
   		document.getElementById("rocket3").src="./images/rocket_nasa_sls_s.png";
   		rocketChoice=2;
   		document.getElementById("rocketselect").src="./images/icon_rocket_nasa_sls.png";
   		document.getElementById("rocketbuttontext").innerHTML="Nasa<br>SLS";
   		
    };
    
    
    $("#rocket1").hover(function() {
    	$("#rocket1details").animate({opacity: 1.0}, 200, function() {
        	$("#rocket1details").css('pointer-events', 'auto');
        });
    }, function() {
    	$("#rocket1details").animate({opacity: 0.0}, 200, function() {
        	$("#rocket1details").css('pointer-events', 'none');
        });
    });
    
    $("#rocket2").hover(function() {
    	$("#rocket2details").animate({opacity: 1.0}, 200, function() {
        	$("#rocket2details").css('pointer-events', 'auto');
        });
    }, function() {
    	$("#rocket2details").animate({opacity: 0.0}, 200, function() {
        	$("#rocket2details").css('pointer-events', 'none');
        });
    });
    
    $("#rocket3").hover(function() {
    	$("#rocket3details").animate({opacity: 1.0}, 200, function() {
        	$("#rocket3details").css('pointer-events', 'auto');
        });
    }, function() {
    	$("#rocket3details").animate({opacity: 0.0}, 200, function() {
        	$("#rocket3details").css('pointer-events', 'none');
        });
    });
   

	$('#checkboxrocket1').prop('checked', true);
    
    
    
    $(document).ready(function() {
    	//jQuery style button handling... may change this to avoid jQuery CSS injection.
    	
        $('#playtoggle').bind("click", function() {
          if ($(this).attr("class") == "play") {
             $(this).attr("class", "pause");
 			popcornMedia[popcornSequenceNumber].play();
 			//basepop.play();
 			$("#speedSlider").slider('value',previousSliderVal);
          } else {
             $(this).attr("class", "play");
 			popcornMedia[popcornSequenceNumber].pause();
 			//basepop.pause();
 			previousSliderVal = savedSliderVal;
 			$("#speedSlider").slider('value',0);
          }
        });
        
        $("#slide2").click(function() {
        	popcornMedia[1].play(7);
        });
        
        $("#slide3").click(function() {
        	popcornMedia[1].play(19);
        });
        
        $("#slide4").click(function() {
        	popcornMedia[1].play(39);
        });
        
        
        $( "#slider" ).slider( { 
			animate: true,
			range: "min",
			value: 50,
			min: 10,
			max: 100,
			step: 1,

		});

		$( "#replaybutton" )
			.button()
			.click(function( event ) {
			replayUser();
		    cancelCallToAction=true;
		    //callToActionTimeout[userLessonNumber] = setTimeout(function(){callToActionUser()},10000);

		});

		$( "#threedhome" )
			.button()
			.click(function( event ) {

		       	//camTweener( { x: 100, y: 400, z: 250 }, { x: 0, y: 0, z: -20 }, 1500 );
		       	camTweener( { x: -400, y: 400, z: 500 }, { x: 0, y: 0, z: -20 }, 3000 );

				checkForFourthCameraLesson();
		       	/*
				camNextPosition	= {
						x: -100, 
						y: 400, 
						z: -250 
					};

					camNextTarget = {
						x: 0,
						y: 0,
						z: 0
					};

					TWEEN.removeAll();
					camTweener( camNextPosition, camNextTarget, 1500 );
					checkForFourthCameraLesson();
					*/
		});	

		$( "#cam2" )
			.button()
			.click(function( event ) {

				camNextPosition	= {
					x: 0, 
					y: 1000, 
					z: 5000 
				};

				camNextTarget = {
					x: 0,
					y: 0,
					z: 0
				};

				//TWEEN.removeAll();
				camTweener( { x: 0, y: 1100, z: 0 }, { x: 0, y: 0, z: -20 }, 1500 );
				//checkForFourthCameraLesson();
		});

		$( "#threedearth" )
			.button()
			.click(function( event ) {


				camNextTarget = {
					x: 0,
					y: 50,
					z: 500
				};

				//not yet sure how to set this up
				camTweener( { x: 50, y: 50, z: 250 }, ss[3].position, 1500 );
				//TWEEN.removeAll();
				//camTweener( camEarth, camNextTarget, 1500 );
				checkForFourthCameraLesson();
				
		});

		$( "#threedmars" )
			.button()
			.click(function( event ) {

				camNextTarget	= {
					x: 0, 
					y: 50, 
					z: 500 
				};
				//not yet sure how to set this up
				//camMars = new camPosition( { x: 75, y: 50, z: 300 }, ss[4].position, 1500 );
				
				camTweener( { x: 75, y: 50, z: 300 }, ss[4].position, 1500 );
				//TWEEN.removeAll();
				//camTweener( camMars, camNextTarget, 1500 );
				finishFourthCameraLesson();
		});
		
		var savedSliderVal;
		var previousSliderVal;
		$( "#speedSlider" ).slider( {
			animate: true,
			range: "min",
			value: .23,
			min: -3,
			max: 3,
			step: .010,
			change: function() {
				var newSliderVal = $( "#speedSlider" ).slider( "option", "value" );
				console.log("newSliderVal: " + newSliderVal);
				console.log("userLessonNumber: " + userLessonNumber);
				if(userLessonNumber==4) {
					if(newSliderVal>0) {
						advanceUser();
					} else {
						jumpPopcornMedia(19);
					}
				} else if(userLessonNumber==5) {
					if(newSliderVal<0) {
						advanceUser();
					} else {
						jumpPopcornMedia(22);
					}
				}
				savedSliderVal = newSliderVal;
				Tweener(timer, {multiplier:savedSliderVal}, 1000);
			}
		});

		$( "#menubutton" )
			.button()
			.click(function( event ) {
				if($('#menupanel').css('opacity') != 0) {
	            	$("#menupanel").animate({opacity: 0.0}, 200, function() {
	                	$("#menupanel").css('pointer-events', 'none');
	            	});
	        	} else {
	        		$("#menupanel").animate({opacity: 1.0}, 200, function() {
	                	$("#menupanel").css('pointer-events', 'auto');
	            	});
	        	}
		});
		
		$( "#nextbutton" )
			.button()
			.click(function( event ) {
				if(popcornSequenceNumber<5) {
					jumpToThreeDNavigation();
				} else if(popcornSequenceNumber<17) {
					jumpToChallenge();
				}
		});
		
		$( "#ignorebutton" )
			.button()
			.click(function( event ) {
				closeAllSubMenus();
		});
		
		$( "#answerbutton" )
			.button()
			.click(function( event ) {
				jumpToChallenge();
		});
		
		var jumpToIntroduction = function() {
			//hide everything
			hideeverything();
			//shift 3d model
			initializethreed();
			//clear 3d lines
			clear3DDrawings();
			//show stuff needed
			//reset mouse tracking lesson
			resetMouseMovementTrackingLession();
			//remove the ruler
			showDistance = false;
			scene.remove(ruler);
			$("#playbuttonwrapper").animate({opacity: 1.0}, 200, function() {
            	$("#playbuttonwrapper").css('pointer-events', 'auto');
        	});
			
			camTweener( { x: 0, y: 100, z: 500 }, { x: 0, y: 0, z: 0 }, 1500 );


			var jumpToDate = new Date(2010,11,1).Date2Julian();
			timer.JD = jumpToDate;
			$("#speedSlider").slider('value',.01);
			
			jumpPopcornMedia(0);
		}
		
		var jumpToThreeDNavigation = function() {
			//hide everything
			hideeverything();
	    	$("#backgroundtarget").animate({opacity: 0.0}, 100, function() {
	           	$("#backgroundtarget").css('pointer-events', 'none');
	       	});
	    	//initialize 3d if you need to
			initializethreed();
			//clear 3d lines
			clear3DDrawings();
			//reset mouse tracking lesson
			resetMouseMovementTrackingLession();
			//remove the ruler
			showDistance = false;
			scene.remove(ruler);
			
			setTimeout(function(){
				//shift 3d model
				camTweener( { x: 0, y: 100, z: 500 }, { x: 0, y: 0, z: -20 }, 1500 );

		    	$("#backgroundtarget").animate({opacity: 0.0}, 100, function() {
		           	$("#backgroundtarget").css('pointer-events', 'none');
		       	});
		    	
				$("#nextbuttonwrapper").animate({opacity: 1.0}, 200, function() {
		        	$("#nextbuttonwrapper").css('pointer-events', 'auto');
		    	});

				$("#playbuttonwrapper").animate({opacity: 1.0}, 200, function() {
	            	$("#playbuttonwrapper").css('pointer-events', 'auto');
	        	});
			},1000);
			jumpPopcornMedia(6);
		}
		
		var jumpToChallenge = function () {
			//hide everything
			hideeverything();
	    	$("#backgroundtarget").animate({opacity: 0.0}, 100, function() {
	           	$("#backgroundtarget").css('pointer-events', 'none');
	       	});
	    	//initialize 3d if you need to
			initializethreed();
			//clear 3d lines
			clear3DDrawings();
			//reset mouse tracking lesson
			resetMouseMovementTrackingLession();
			//remove the ruler
			showDistance = false;
			scene.remove(ruler);
			//show stuff needed
			setTimeout(function(){
				//shift 3d model
				camTweener( { x: 0, y: 1100, z: 0 }, { x: 0, y: 0, z: 0 }, 3000 );
				$("#selectmissionrocket").animate({opacity: 1.0}, 200, function() {
	            	$("#selectmissionrocket").css('pointer-events', 'auto');
	        	});
		        $("#launchcontrols").animate({opacity: 0.0}, 1000, function() {
		        	$("#launchcontrols").css('pointer-events', 'none');
		    	});
				$("#threedcontrols").animate({opacity: 1.0}, 200, function() {
	            	$("#threedcontrols").css('pointer-events', 'auto');
	        	});
				$("#playbuttonwrapper").animate({opacity: 1.0}, 200, function() {
	            	$("#playbuttonwrapper").css('pointer-events', 'auto');
	        	});
				
			},2000);
			
			var jumpToDate = new Date(2036,0,1).Date2Julian();
			timer.JD = jumpToDate;
			$("#speedSlider").slider('value',.01);
			
			jumpPopcornMedia(24,6);
		}
		$( "#threedhelpbutton" )
			.button()
			.click(function( event ) {
				$("#helpthreedpopup").animate({opacity: 1.0}, 200, function() {
                	$("#helpthreedpopup").css('pointer-events', 'auto');
            	});
		});
		
		$( "#introduction" )
			.button()
			.click(function( event ) {
				jumpToIntroduction();
		});
		
		$( "#navigation" )
			.button()
			.click(function( event ) {
				jumpToThreeDNavigation();
		});
		
		$( "#challenge" )
			.button()
			.click(function( event ) {
				jumpToChallenge();
		});
		
		$( "#about" )
			.button()
			.click(function( event ) {
				console.log("about clicked");
				$("#aboutpopup").animate({opacity: 1.0}, 200, function() {
                	$("#aboutpopup").css('pointer-events', 'auto');
            	});
		});
		
		$( "#help" )
			.button()
			.click(function( event ) {
				$("#helppopup").animate({opacity: 1.0}, 200, function() {
                	$("#helppopup").css('pointer-events', 'auto');
            	});
		});
		
		$( "#beginbutton" )
			.button()
			.click(function( event ) {
				basepop.play( 0 );
				$("#startmenupanel").animate({opacity: 0.0}, 200, function() {
                	$("#startmenupanel").css('pointer-events', 'none');
                	//$("#videocontenttarget").animate({opacity: 1.0}, 200, function() {
                    //	$("#videocontenttarget").css('pointer-events', 'auto');
                	//});
            	});
				$("#playbuttonwrapper").animate({opacity: 1.0}, 200, function() {
                	$("#playbuttonwrapper").css('pointer-events', 'auto');
            	});
		});
		

		var launchRewindDate; //date to start launch draw sequence, to see initial draw.
		var launchDate;
		var landingDate;
		var rocketDeltas = new Array(22.3, 21.1, 25.2);
		
		$( "#runbutton" )
			.button()
			.click(function( event ) {
				if(!launchDate || !landingDate) {
					console.log("need both dates to compare");
				} else if (landingDate<launchDate) {
					console.log("You can't land before you launch");
				} else if (landingDate>launchDate) {
					//erase line if necessary
					clear3DDrawings();
					
	    			var jumpToDate = new Date(launchRewindDate).Date2Julian();
	    			timer.JD = jumpToDate;
					
					var departure_time = new Time( dateToTime(launchDate) );
					var arrival_time = new Time( dateToTime(landingDate) );
					
			    	
			    	var aDate = new Number(timer.JD).Julian2Date();

			    	var jd = new Number(departure_time.jd_tt()).Julian2Date();
			    	
			    	marsOdyssey = null;
			    	marsOdyssey = new MarsOdyssey();
					marsOdyssey.init( departure_time, arrival_time, function () {
					    console.log("heard the done drawing callback");
					    playTrajectoryAudio();
					});
					
					console.log("DeltaV index: " + marsOdyssey.totalDeltaV);

					$("#speedSlider").slider('value',.05);
				}
		});
		
		$( "#commitlaunchbutton" )
		.button()
		.click(function( event ) {
			if(!launchDate || !landingDate) {
				console.log("need both dates to compare");
			} else if (landingDate<launchDate) {
				console.log("You can't land before you launch");
			} else if (landingDate>launchDate) {
				//erase line if necessary

				$("#launchcontrols").animate({opacity: 0.0}, 200, function() {
                	$("#launchcontrols").css('pointer-events', 'none');
            	});

				clear3DDrawings();
				
    			var jumpToDate = new Date(launchRewindDate).Date2Julian();
    			timer.JD = jumpToDate;
				
				var departure_time = new Time( dateToTime(launchDate) );
				var arrival_time = new Time( dateToTime(landingDate) );
				
		    	
		    	var aDate = new Number(timer.JD).Julian2Date();

		    	var jd = new Number(departure_time.jd_tt()).Julian2Date();
		    	
		    	marsOdyssey = null;
		    	marsOdyssey = new MarsOdyssey();
				marsOdyssey.init( departure_time, arrival_time, function () {
				    console.log("heard the done drawing callback");
				    //move cam to mars for effect.
					camTweener( { x: 75, y: 50, z: 300 }, ss[4].position, 1500 );
				    
				});
				
				console.log("DeltaV index: " + marsOdyssey.totalDeltaV);

				$("#speedSlider").slider('value',.05);
			}
		});
		
		var playTrajectoryAudio = function() {
			console.log("rocketChoice: " + rocketChoice);
			var deltaDif;
			switch(rocketChoice)
	    	{
	    	case 0:
	    		//check to see if deltaV is under minimum for this rocket
	    		deltaDif = rocketDeltas[rocketChoice] - marsOdyssey.totalDeltaV;
				console.log("deltaDif: " + deltaDif);
				
				if(deltaDif>=0) {
					jumpPopcornMedia(28); //landed
				} else if(deltaDif>=-4.8) {
					jumpPopcornMedia(29); //bad
				} else if(deltaDif>=-6.3) {
					jumpPopcornMedia(30); //worse
				} else if(deltaDif>=-7.0) {
					jumpPopcornMedia(31); //even worse
				} else {
					jumpPopcornMedia(32); //just aweful
				}
	    	  break;
	    	case 1:
	    		deltaDif = rocketDeltas[rocketChoice] - marsOdyssey.totalDeltaV;
				console.log("deltaDif: " + deltaDif);
				
				if(deltaDif>=0) {
					jumpPopcornMedia(28); //landed
				} else if(deltaDif>=-4.8) {
					jumpPopcornMedia(29); //bad
				} else if(deltaDif>=-6.3) {
					jumpPopcornMedia(30); //worse
				} else if(deltaDif>=-7.0) {
					jumpPopcornMedia(31); //even worse
				} else {
					jumpPopcornMedia(32); //just aweful
				}
	    	  break;
	    	case 2:
	    		deltaDif = rocketDeltas[rocketChoice] - marsOdyssey.totalDeltaV;
				console.log("deltaDif: " + deltaDif);
				
				if(deltaDif>=0) {
					jumpPopcornMedia(28); //landed
				} else if(deltaDif>=-4.8) {
					jumpPopcornMedia(29); //bad
				} else if(deltaDif>=-6.3) {
					jumpPopcornMedia(30); //worse
				} else if(deltaDif>=-7.0) {
					jumpPopcornMedia(31); //even worse
				} else {
					jumpPopcornMedia(32); //just aweful
				}
	    	  break;
	    	default:
	    		jumpPopcornMedia(31); //just aweful
		    	break;
	    	}
		}
		
		//we've got simple date formatting needs, so this will be sufficient for our project.
		var dateFormatter = function(aDate) {
			var mm = aDate.getMonth() + 1;
			if(mm<10)mm = "0" + mm;
		    var dd = aDate.getDate() + 1;
			if(dd<10)dd = "0" + dd;
		    var yyyy = aDate.getFullYear();
		    var formattedDate = mm + '/' + dd + '/' + yyyy;
		    return formattedDate;
		};
		
		//change a date to a time object (helps for Time initializer)
		var dateToTime = function(aDate) {
			return aLaunchTime = {
					Yr: aDate.getFullYear(),
					Mon: aDate.getMonth()+1,
					D: aDate.getDate(),
					Hr: 1,
					Mn: 1,
					S: 1
					};
		};
		
		$(function() {
		    $( "#launchdatepicker" ).datepicker({
		      changeMonth: true,
		      changeYear: true,
		      minDate: new Date(2036, 0, 1),
		      maxDate: new Date(2080, 0, 1),
		      onSelect: function(dateText, inst) { 
		    	  
	    			launchDate = new Date(Date.parse(dateText));
	    			launchRewindDate = new Date(Date.parse(dateText));
	    			launchRewindDate.setDate(launchRewindDate.getDate()-5);
	    			if(timer) {
	    				$("#speedSlider").slider('value',0);
		    			var jumpToDate = new Date(Date.parse(dateText)).Date2Julian();
		    			timer.JD = jumpToDate;
	    			}
	    			clear3DDrawings();
	    			//console.log("jumpToDate: " +  dateFormatter(jumpToDate));
	    		}
		    });
		});
		$(function() {
		    $( "#landingdatepicker" ).datepicker({
		      changeMonth: true,
		      changeYear: true,
		      minDate: new Date(2036, 0, 1),
		      maxDate: new Date(2080, 0, 1),
		      onSelect: function(dateText, inst) { 
	    			landingDate = new Date(Date.parse(dateText));
	    			if(timer) {
		    			$("#speedSlider").slider('value',0);
		    			var jumpToDate = new Date(Date.parse(dateText)).Date2Julian();
		    			timer.JD = jumpToDate;
	    			}
	    			clear3DDrawings();
	    			//console.log("jumpToDate: " +  dateFormatter(jumpToDate));
	    		}
		    });
		});
		
		//this timer queries the timer object to figure out what the date is 
		//and then sets the datepicker element every 100 ms.
		setInterval(function() { 
			if(timer) {
				var aDate = new Number(timer.JD).Julian2Date();
				document.getElementById( "orbitdate" ).value = dateFormatter(aDate);
			}
		}, 100);
		
      });
    
    
  //from main.js
  if ( ! Detector.webgl ) Detector.addGetWebGLMessage();

	$( '#loadtext' ).show();
	setLoadMessage("Loading the Solar System");

	loader.options.convertUpAxis = true;
	loader.load( './models/galaxy.dae', function ( collada ) {

		dae = collada.scene;
		dae.scale.x = dae.scale.y = dae.scale.z = 60000;
		dae.updateMatrix();

	} );

	loadShaders( shaderList, function (e) {
		shaderList = e;
		postShadersLoaded();
	});

	var postShadersLoaded = function () {
		console.log("v:0.3");
	        //init();
	        //animate();
			$("#loadtext").hide();
    };
      
}, false);

</script>
	</head>
	<body>
		
		<!-- <div id="loaderdiv" style="z-index:20;background-color:#FFFFFF;width:100px;height:100px;opacity:1.0;"></div> -->
		
		<div id="startmenupanel" class="startmenupanel">
			<h1>Mission to Mars</h1>
			<br>
			<div class="textstyle1">
			In this simulation of sending spacecraft to Mars you will use a 3D model of the solar system to learn
			about the science behind the Curiosity rover.
			</div>
			<br>
			<button id="beginbutton" class="beginbutton">LAUNCH</button>
			<br>
			<br>
			<br>
			<div class="textstyle2">
			This project is a collaboration between the U.S. Department of Energy, the Mozilla Foundation, and MX.</div>
			<br>
			<img src="./images/tri_logo.png" style="align: center;">
			<br>
		</div>
		
		<div id="topbar" class="topbar">
		
			<div id="topbarleft" class="topbarleft">
				<div id="headerpanel" class="headerpanel"></div>
			</div>
			<div id="topbarmiddle" class="topbarmiddle">
				<div id="loaderdiv" style="z-index:10;opacity:1.0;pointer-events:auto; width:100%">
					<div id="loaderpanel" class="loadercontenttarget" style="z-index:11;">
						<font style="color:#3a84a6;">Loading the Solar System</font>
						<div id="canvastarget" style="position:absolute;left:-130px;top:-22px"></div>
					</div>
				</div>
				<div id="playbuttonwrapper" class="playbuttonwrapper" style="opacity:0.0;pointer-events:none">
					<div id="playtoggle" class="pause"></div>
				</div>
			</div>
			
			<div id="topbarright" class="topbarright">
			
				<button id="menubutton" class="menubutton">MENU</button>
				<div id="menupanel" class="menupanel">
					<button id="introduction" class="menupanelbutton">introduction</button>
					<br>
					<button id="navigation" class="menupanelbutton">3d navigation</button>
					<br>
					<button id="challenge" class="menupanelbutton">Slayton's Isle</button>
					<br>
					<button id="about" class="menupanelbutton">about</button>
					<br>
					<button id="help" class="menupanelbutton">help</button>
				</div>
			</div>
		</div>	
		<!-- main content area for video, images, 3D, etc... -->
		<div id="contenttarget" class="contenttarget">
		</div>
		<div id="backgroundtarget" class="backgroundtarget">
		</div>
		
		<div id="imagecontenttarget" class="imagecontenttarget">
		</div>
		
		<div id="videointrocontenttarget" class="videointrocontenttarget">
			<video height="100%" width="100%" id="videointro" style="background: #000;">
         		<source src="http://www.mx-mx.com/lab/moku/video/moku_unit1_intro_BL.mp4" type="video/mp4">
         		<source src="http://www.mx-mx.com/lab/moku/video/moku_unit1_intro.webmhd.webm" type="video/webm">
         		Please upgrade your browser to view video
       		</video>
       		<div id="subtitlepanel" class="subtitlepanel"></div>
		</div>
		
		<div id="videocontenttarget" class="videocontenttarget">
			<video height="100%" width="100%" id="video" style="background: #000;">
         		<source src="http://www.mx-mx.com/lab/moku/video/SEQ1_OCVO_v05_rev.mp4" type="video/mp4">
         		<source src="http://www.mx-mx.com/lab/moku/video/SEQ1_OCVO_v05_rev.webmhd.webm" type="video/webm">
         		Please upgrade your browser to view video
       		</video>
       		<div id="subtitlepanel" class="subtitlepanel"></div>
		</div>
		
		<div id="bottombar" class="bottombar">
			<div id="bottombarleft" class="bottombarleft">
				<div id="helpbuttonwrapper" class="helpbuttonwrapper" style="opacity: 0.0;pointer-events:none">
					<button id="threedhelpbutton" class="squarebluebutton">HELP</button>
				</div>
				<div id="replaybuttonwrapper" class="replaybuttonwrapper" style="opacity: 0.0;pointer-events:none">
					<button id="replaybutton" class="squarebluebutton">REPLAY</button>
				</div>
			</div>
			<div id="bottombarmiddle" class="bottombarmiddle" style="vertical-align: bottom;align:center">
				<div id="threedcontrols" class="threedcontrols">
					<button id="threedhome" class="squarebluebutton">Home</button>
					<button id="cam2" class="squarebluebutton">Above</button>
					<button id="threedearth" class="squarebluebutton">Earth</button>
					<button id="threedmars" class="squarebluebutton">Mars</button>
				</div>
			</div>
			
			<div id="bottombarright" class="bottombarright">
			
				<div id="nextbuttonwrapper" class="nextbuttonwrapper" style="opacity: 0.0;pointer-events:none">
					<button id="nextbutton" class="nextbutton">NEXT</button>
				</div>
			</div>
		</div>
		
		<div style="display:none">
			<span id="label_template" class="label">
				<span class="name">
				</span>
			</span>
		</div>
		<div id="loadtext" style="z-index: 6;"></div>
		
		<div id="solarsystembadge" class="modalmask">
			<div id="backpacklogindiv" class="badgecontenttarget">
				<h1>Mission Complete!</h1>
				<h1>Badge Award!</h1>
				<br>
				Upload your Badge
				<br><br>
				<div style="text-align: center;width:100%">
					<table style="position: absolute; width: 80%;margin:0;padding:0; float:middle;left:15%" >
						<tr >
							<td align="left" valign="top">
								<br>
								<font style="font-weight:300;">
								The Solar System Badge awarded for 3D simulation mastery.
								<br><br>
								 - panning
								<br>
								 - zooming
								<br>
								 - planet selection
								<br>
								 - camera jumps
								<br>
								 - time slider
								 </font>
							
							</td>
							<td align="right" valign="top"><img src="./badge-it-gadget-lite/digital-badges/images/badge_3D.png"> </td>
							
						</tr>
					</table>
				</div>
					
				<br><br><br><br><br><br><br><br><br><br><br><br>
					<div style="float:middle;">
						<button id="solarsystembadgeskipbutton" class="squarebluebutton">Skip</button>
						<button id="solarsystembadgeuploadbutton" type="submit" class="squarebluebutton">Upload</button>
					</div>
			</div>
		</div>
		
		<div id="solarsystembadgecomplete" class="modalmask">
			<div id="backpacklogindiv" class="badgecontenttarget">
				<h1>Mission Complete!</h1>
				<h1>Badge Award!</h1>
				<br>
				Thanks for playing
				<br><br>
				<div style="text-align: center;width:100%">
					<table style="position: absolute; width: 80%;margin:0;padding:0; float:middle;left:15%" >
						<tr >
							<td align="left" valign="top">
								<br>
								<font style="font-weight:300;">
								Congradulations and thanks. 
								 </font>
							
							</td>
							<td align="right" valign="top"><img src="./badge-it-gadget-lite/digital-badges/images/badge_3D.png"> </td>
							
						</tr>
					</table>
				</div>
					
				<br><br><br><br><br><br><br><br><br><br><br><br>
					<div style="float:middle;">
						<button id="solarsystembadgecompletereplaybutton" class="squarebluebutton">Replay</button>
						<button id="solarsystembadgecompletecontinuebutton" type="submit" class="squarebluebutton">Continue</button>
					</div>
			</div>
		</div>
		
		<div id="aboutpopup" class="popupdiv">
			<div id="aboutpopupclose" class="closebutton"><p>&#10006;</p></div>
			<h1>About</h1>
			<p>A 3D web experience built in conjuction with MX, the Deparment of Energy and Mozilla.  
			We have combined <a href="http://popcornjs.org/" target="_new">Popcorn</a> with a 3D experience to all on a Mars journey.
			</p>
		</div>
		<div id="helppopup" class="popupdiv">
			<div id="helppopupclose" class="closebutton"><p>&#10006;</p></div>
			<h1>Help</h1>
			<p>The help page</p>
		</div>
		<div id="helpthreedpopup" class="popupdiv">
			<div id="helpthreedclose" class="closebutton"><p>&#10006;</p></div>
			<h1>Help</h1>
			<p>The 3D help page</p>
		</div>
		<div id="browserpopup" class="popupdiv">
			<div id="browserpopupclose" class="closebutton"><p>&#10006;</p></div>
			<h1>Browser</h1>
			<p>The browser page</p>
		</div>
		
		<div id="incomingmessage" class="capcommessagediv">
			<table style="width: 100%;margin:2;padding:0;" >
				<tr >
					<td width="50px" rowspan="2" align="left" valign="middle"><img src="./images/icon_satellite.png" style="width:45px;height:45px;"></td>
					
					<td align="left">...Incoming Transmission</td>
				</tr>
				<tr>
					<td align="left">
						<button id="answerbutton" class="squarebluebutton">Answer</button>
						<button id="ignorebutton" class="squarebluebutton">Ignore</button>
					</td>
				</tr>
			</table>
		</div>
		
		<div id="transmissionmessage" class="capcommessagediv">
			<table style="width: 100%;margin:2;padding:0;" >
				<tr >
					<td width="50px" rowspan="2" align="left" valign="middle"><img src="./images/icon_satellite.png" style="width:45px;height:45px;"></td>
					<td align="left">Current Transmission:</td>
				</tr>
				<tr>
					<td align="left" style="font-weight:400;"> Nasa - Capcom </td>
				</tr>
			</table>
		</div>
		
		<div id="cmemessage" class="capcommessagereddiv">
			<table style="width: 100%;margin:2;padding:0;" >
				<tr >
					<td width="50px" rowspan="2" align="left" valign="middle"><img src="./images/cme_icon.png" style="width:45px;height:45px;"></td>
					
					<td align="left">Alert: CME Detected!</td>
				</tr>
				<tr>
					<td align="left">
						<button id="investigatecmebutton" class="roundedredbutton">Investigate</button>
						<button id="ignorecmebutton" class="roundedredbutton">Ignore</button>
					</td>
				</tr>
			</table>
		</div>
		
		<div id="selectmissionrocket" class="selectitemdiv">
			<div style="font-weight:bold;font-size:20px;margin:0px 0px 10px 0px;">Select Mission Rocket</div>
			<div style="display:inline;width:900px;height:500px;">
				<div id="rocket1div" class="selectitemdetaildiv">
					<table style="width: 100%;height: 100%;margin:0;padding:0;">
						<tr>
							<td width="70%" align="left" valign="top">
								Falcon Heavy
								<br><br>
								<font style="font-family: 'Lato', sans-serif;font-size:14px;line-height:16px;font-weight:300;">
								Small. Lightweight. 
								<br> 
								Private! The vanguard of the for-profit rocket!
								<br> <br> 
								Pro: Selling shares now!
								<br> <br> 
								Con: No safety net
								<br> <br> <br>  
								V: 22.3 km/s
								<br> <br>
								Max Fuel: 100,000 LBS
								<br> <br>
								Max Payload: 20,000 LBS
								</font>
							</td>
							<td width="30%" align="center" valign="bottom"><img id="rocket1" src="./images/rocket_falcon_heavy_s.png"></td>
						</tr>
					</table>
				</div>
				<div id="rocket2div" class="selectitemdetaildiv">
					<table style="width: 100%;height: 100%;margin:0;padding:0;">
						<tr>
							<td width="70%" align="left" valign="top">
								Delta IV Heavy
								<br><br>
								<font style="font-family: 'Lato', sans-serif;font-size:14px;line-height:16px;font-weight:300;">
								The premium choice in rockets. Old faithful.
								<br> <br> <br>
								Pro: Stable
								<br> <br> 
								Con: Not exciting
								<br> <br> <br> 
								V: 21.1 km/s
								<br> <br>
								Max Fuel: 100,000 LBS
								<br> <br>
								Max Payload: 20,000 LBS
								</font>
							</td>
							<td width="30%" align="center" valign="bottom"><img id="rocket2" src="./images/rocket_delta_iv_heavy_n.png"></td>
						</tr>
					</table>
				</div>
				<div id="rocket3div" class="selectitemdetaildiv">
					<table style="width: 100%;height: 100%;margin:0;padding:0;">
						<tr>
							<td width="70%" align="left" valign="top">
								NASA SLS
								<br><br>
								<font style="font-family: 'Lato', sans-serif;font-size:14px;line-height:16px;font-weight:300;">
								The big dog. If you gotta send something to space, this is your rocket.
								<br> <br> 
								Pro: Its HUGE!
								<br> <br> 
								Con: It aint cheap..
								<br> <br> <br> 
								V: 25.2 km/s
								<br> <br>
								Max Fuel: 100,000 LBS
								<br> <br>
								Max Payload: 20,000 LBS
								</font>
							</td>
							<td width="30%" align="center" valign="bottom"><img id="rocket3" src="./images/rocket_nasa_sls_n.png"></td>
						</tr>
					</table>
				</div>
			</div>
			
			<div style="font-weight:bold;font-size:30px;">
				<button id="selectmissioncontinuebutton" class="squarebluebutton">Continue</button>
			</div>
		</div>
		
		<div id="launchcontrols" class="launchcontrols">
			
			<div id="datediv" class="datediv" >
				<table style="width:100%;height:100%;margin:0;padding:0;" >
					<tr>
						<td align="center" valign="bottom" height="30px">Orbit Speed</td>
						<td align="center" valign="bottom">Current Date</td>
					</tr>
					<tr>
						<td align="center" valign="middle" height="54px" style="width:140px;">
							<table style="width:100%;height:100%;margin:0;padding:0;" >
								<tr>
									<td align="center" valign="middle">-</td>
									<td align="center" valign="middle" style="width:110px;"><div id="speedSlider" class="speedSlider"></div></td>
									<td align="center" valign="middle">+</td>
								</tr>
							</table>
							
						</td>
						<td align="center" valign="bottom">
							<input type="text" id="orbitdate" class="datepicker" readonly/>
						</td>
					</tr>
				</table>
			</div>
			
			<div id="launchdiv" class="launchdiv" >
				<table style="width:100%;height:100%;margin:0;padding:0;">
					<tr>
						<td align="center" valign="bottom" height="30px">Rocket</td>
						<td align="center" valign="bottom" rowspan="2" style="padding:0px 5px 0px 0px" height="90px">
				 			<img id="rocketselect" src="./images/icon_rocket_falcon_heavy.png" style="padding:0px 0px 0px 0px">
						</td>
						<td align="center" valign="bottom">Launch Date</td>
						<td align="center" valign="bottom">Land Date</td>
						<td align="center" valign="bottom"><font style="color:#fff;">Run</font></td>
						<td align="center" valign="bottom" width="100px">&nbsp;</td>
					</tr>
					<tr>
						<td align="center" valign="bottom">
				 			<button id="rocketbutton" class="playbutton" style="padding:2px 9px">
								<table style="width:60px;height:100%;margin:0;padding:0;">
									<tr>
										<td id="rocketbuttontext">Falcon Heavy</td>
									</tr>
								</table>
							</button>
						</td>
						<td align="center" valign="bottom">
				 			<input type="text" id="launchdatepicker" class="datepicker"/>
						</td>
						<td align="center" valign="bottom">
				 			<input type="text" id="landingdatepicker" class="datepicker"/>
						</td>
						<td align="center" valign="bottom">
				 			<button id="runbutton" class="playbutton" style="padding:0px 0px !important">
								<table style="width:100%;height:100%;margin:0;padding:0;">
									<tr>
										<td><img src="./images/playwhite.png" style="width:90%;height:90%;"></td>
									</tr>
								</table>
							</button>
						</td>
						<td align="right" valign="bottom">
				 			<button id="commitlaunchbutton" class="playbutton" style="padding:2px 9px; opacity:0.0;pointer-events:none;">
								<table style="width:100%;height:100%;margin:0;padding:0;">
									<tr>
										<td>Launch<br>Commit</td>
									</tr>
								</table>
							</button>
						</td>
					</tr>
				</table>
			</div>
		</div>
		
		
		
		<audio id="SEQ2_VO">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ2_VO.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ2_VO.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id="SEQ3_VOpt1">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ3_VOpt1.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ3_VOpt1.oggvorbis.ogg"></source>
			
		</audio>
		
		<audio id="SEQ3_VOpt2">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ3_VOpt2.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ3_VOpt2.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id="SEQ3_VOpt3">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ3_VOpt3.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ3_VOpt3.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id=SEQ_3_CAM_1a>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_1a.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_1a.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id="SEQ_3_CAM_1b">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_1b.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_1b.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id="SEQ_3_CAM_1c">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_1c.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_1c.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id=SEQ_3_CAM_2a>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_2a.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_2a.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id="SEQ_3_CAM_2b">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_2b.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_2b.oggvorbis.ogg"></source>
			
		</audio> 
		
		<audio id=SEQ_3_CAM_3a>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_3a.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_3a.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_3b">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_3b.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_3b.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_3c">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_3c.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_3c.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id=SEQ_3_CAM_4a>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_4a.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_4a.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_4b">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_4b.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_4b.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_4c">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_4c.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_4c.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_4d">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_4d.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_4d.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_5a">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_5_CAM_5a.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_5_CAM_5a.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_5b">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_5b.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_5b.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_5c">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_5c.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_5c.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_5d">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_5d.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_5d.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_5e">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_5e.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_5e.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_3_CAM_5f">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_5f.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_3_CAM_5f.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_CAM_1a">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_5_CAM_1a.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_5_CAM_1a.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_CAM_1b">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_5_CAM_1b.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_5_CAM_1b.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_CAM_1c">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_5_CAM_1c.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_5_CAM_1c.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="SEQ_5_CAM_1d">
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_5_CAM_1d.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/SEQ_5_CAM_1d.oggvorbis.ogg"></source>
		</audio> 
		
		<audio id="ROCKET_SUCCESS">
			<source src="http://www.mx-mx.com/lab/moku/audio/ROCKET_SUCCESS.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/ROCKET_SUCCESS.ogg"></source>
		</audio> 
		
		<audio id="ROCKET_FAIL1">
			<source src="http://www.mx-mx.com/lab/moku/audio/ROCKET_FAIL1.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/ROCKET_FAIL1.ogg"></source>
		</audio> 
		
		<audio id="ROCKET_FAIL2">
			<source src="http://www.mx-mx.com/lab/moku/audio/ROCKET_FAIL2.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/ROCKET_FAIL2.ogg"></source>
		</audio> 
		
		<audio id="ROCKET_FAIL3">
			<source src="http://www.mx-mx.com/lab/moku/audio/ROCKET_FAIL3.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/ROCKET_FAIL3.ogg"></source>
		</audio> 
		
		<audio id="ROCKET_FAIL4">
			<source src="http://www.mx-mx.com/lab/moku/audio/ROCKET_FAIL4.mp3"></source>
			<source src="http://www.mx-mx.com/lab/moku/audio/ROCKET_FAIL4.ogg"></source>
		</audio> 
		
	</body>
</html>
